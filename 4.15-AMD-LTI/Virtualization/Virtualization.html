<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Install and configure OpenShift Virtualization | OpenShift Container Platform 4.15 on HPE DL AMD Gen11 Servers</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="Hewlett Packard Enterprise">
    
    <link rel="preload" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/css/0.styles.5568f17e.css" as="style"><link rel="preload" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/app.17b54db2.js" as="script"><link rel="preload" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/2.b11c95b8.js" as="script"><link rel="preload" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/1.3a6b1407.js" as="script"><link rel="preload" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/11.9955f42d.js" as="script"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/10.fe0504e8.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/12.9fa9c55d.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/13.657a1ce5.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/14.e9d66914.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/15.f9abdbbf.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/16.c9d7617f.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/17.44d3fafe.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/18.7d69d950.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/19.53db1622.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/20.727625f1.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/21.ffab7a62.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/22.4edff5db.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/23.014a5934.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/24.34605eef.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/25.86cef385.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/26.5a4d9622.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/27.f46349fa.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/28.263c47e8.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/29.afa5a2e3.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/3.8ca25f86.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/30.6c52cbb3.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/31.a3ea318d.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/32.e92d0988.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/33.f531c1f9.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/34.3c2ba569.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/35.dd095fbf.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/36.8353d12e.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/37.3aa57a36.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/38.84c4c897.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/39.c7fc1568.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/4.15bc4cf7.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/40.e766b773.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/5.698fce5b.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/6.2185426d.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/7.d637c932.js"><link rel="prefetch" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/vendors~docsearch.56c672f1.js">
    <link rel="stylesheet" href="/hpe-solutions-openshift/4.15-AMD-LTI/assets/css/0.styles.5568f17e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hpe-solutions-openshift/4.15-AMD-LTI/" class="home-link router-link-active"><!----> <span class="site-name">OpenShift Container Platform 4.15 on HPE DL AMD Gen11 Servers</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hpe-solutions-openshift/4.15-AMD-LTI/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/hpe-solutions-openshift/4.15-AMD-LTI/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Red Hat OpenShift Container Platform 4.15 on HPE DL325 &amp; DL385 Gen11 Servers</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Overview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Components</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Deployment</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Storage</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>OpenShift Virtualization</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hpe-solutions-openshift/4.15-AMD-LTI/Virtualization/Virtualization.html" aria-current="page" class="active sidebar-link">Install and configure OpenShift Virtualization</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/4.15-AMD-LTI/Virtualization/Virtualization.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/4.15-AMD-LTI/Virtualization/Virtualization.html#enabling-openshift-virtualization" class="sidebar-link">Enabling OpenShift Virtualization</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/4.15-AMD-LTI/Virtualization/Virtualization.html#installing-openshift-virtualization-operator-from-operatorhub" class="sidebar-link">Installing OpenShift Virtualization Operator from OperatorHub</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/4.15-AMD-LTI/Virtualization/Virtualization.html#network-configuration" class="sidebar-link">Network configuration</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/4.15-AMD-LTI/Virtualization/Virtualization.html#storage-configuration" class="sidebar-link">Storage configuration</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/4.15-AMD-LTI/Virtualization/Virtualization.html#create-a-virtual-machine" class="sidebar-link">Create a virtual machine</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/4.15-AMD-LTI/Virtualization/Virtualization.html#reading-viewing-virtual-machine" class="sidebar-link">Reading/Viewing virtual machine</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/4.15-AMD-LTI/Virtualization/Virtualization.html#updating-a-virtual-machine" class="sidebar-link">Updating a virtual machine</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/4.15-AMD-LTI/Virtualization/Virtualization.html#deleting-a-virtual-machine" class="sidebar-link">Deleting a virtual machine</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/4.15-AMD-LTI/Virtualization/Virtualization.html#hot-plugging-a-vm-disks" class="sidebar-link">Hot-plugging a VM disks</a></li></ul></li><li><a href="/hpe-solutions-openshift/4.15-AMD-LTI/Virtualization/Virt-Live-migration.html" class="sidebar-link">Live migration</a></li><li><a href="/hpe-solutions-openshift/4.15-AMD-LTI/Virtualization/MTV.html" class="sidebar-link">Migration Toolkit for Virtualization</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Additional Features and Functionality</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Resources and Additional Links</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="install-and-configure-openshift-virtualization"><a href="#install-and-configure-openshift-virtualization" class="header-anchor">#</a> Install and configure OpenShift Virtualization</h1> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>RedHat OpenShift Virtualization stands as a cornerstone of Red Hat's OpenShift
Container Platform, seamlessly blending virtual machines and containers to offer
a unified management interface. This integration empowers organizations to efficiently
deploy both modern and traditional applications, encompassing virtual machines,
containers, and serverless functions within a single platform. Built upon the
&quot;container-native virtualization&quot; concept, driven by the KubeVirt project, it
harnesses the RHEL KVM hypervisor to seamlessly merge virtual machines with
Kubernetes and KubeVirt for streamlined management and orchestration. Through
this infrastructure, OpenShift Virtualization enables the coexistence of virtual
machines and containers within a Kubernetes environment, providing a cohesive
solution for workload management.</p> <p>OpenShift Virtualization adds new objects into your OpenShift Container Platform
cluster via Kubernetes custom resources to enable virtualization tasks.
These tasks include:</p> <ul><li><p>Creating and managing Linux and Windows virtual machines</p></li> <li><p>Connecting to virtual machines through a variety of consoles and CLI tools</p></li> <li><p>Importing and cloning existing virtual machines</p></li> <li><p>Managing network interface controllers and storage disks attached to virtual machines</p></li> <li><p>Live migrating virtual machines between nodes</p></li> <li><p>An enhanced web console provides a graphical portal to manage these virtualized resources
alongside the OpenShift Container Platform cluster containers and infrastructure.</p></li> <li><p>OpenShift Virtualization is tested with OpenShift Data Foundation (ODF) and Alletra 6070.</p></li> <li><p>OpenShift Virtualization allows the usage with either the [OVN-Kubernetes] (opens new window)or
the [OpenShiftSDN] (opens new window)default Container Network Interface (CNI) network provider</p></li></ul> <h2 id="enabling-openshift-virtualization"><a href="#enabling-openshift-virtualization" class="header-anchor">#</a> Enabling OpenShift Virtualization</h2> <p><img src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/img/figure-virt1.79092c5d.png" alt=""></p> <p><strong>FIGURE 23</strong> Red Hat OpenShift Virtualization deployment flow</p> <h2 id="installing-openshift-virtualization-operator-from-operatorhub"><a href="#installing-openshift-virtualization-operator-from-operatorhub" class="header-anchor">#</a> Installing OpenShift Virtualization Operator from OperatorHub</h2> <ol><li><p>Log into the OpenShift Container Platform web console and navigate to Operators → OperatorHub</p></li> <li><p>Type OpenShift Virtualization and Select OpenShift Virtualization tile</p></li></ol> <p><img src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/img/figure-virt2.06ec7e59.png" alt=""></p> <p><strong>FIGURE 24</strong> OpenShift Virtualization in OperatorHub</p> <ol start="3"><li>Click and Install the Operator to the &quot;openshift-cnv&quot; namespace</li></ol> <p><img src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/img/figure-virt3.d86f1383.png" alt=""></p> <p><strong>FIGURE 25</strong> Inputs for the OpenShift Virtualization operator</p> <ol start="4"><li>Once OpenShift Virtualization is successfully installed , Create HyperConverged Custom resource</li></ol> <p><img src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/img/figure-virt4.293e8018.png" alt=""></p> <p><img src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/img/figure-virt5.496d8594.png" alt=""></p> <p><strong>FIGURE 26</strong> Creation of HyperConverged in OpenShift Virtualization operator</p> <p>After successful deployment of operator and creation of HyderConverged. Virtualization will be enabled in webconsole.</p> <h2 id="network-configuration"><a href="#network-configuration" class="header-anchor">#</a> Network configuration</h2> <p>You would have internal pod network as default network after successful deployment of OpenShift Virtualization.
For additional network, we would deploy the network operator &quot;NMState Operator&quot; and configure Linux bridge network
for external VM access and live migration.</p> <p>Administrators can also install SR-IOV Operator to manage SR-IOV network devices and MetalLB Operator for
lifecycle management.</p> <h3 id="configuring-a-linux-bridge-network"><a href="#configuring-a-linux-bridge-network" class="header-anchor">#</a> Configuring a Linux bridge Network</h3> <ol><li><p>To install NMState Operator, navigate to Operators → OperatorHub in webconsole</p></li> <li><p>Type NMState, Select Kubernetes NMState Operator tile and Install the Operator</p></li></ol> <p><img src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/img/figure-virt6.a5532073.png" alt=""></p> <p><strong>FIGURE 27</strong> Installation of NMState in OperatorHub</p> <ol start="3"><li>Once the NMState operator is installed, Create a instance for &quot;nmstate&quot;</li></ol> <p><img src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/img/figure-virt7.88dd9ebe.png" alt=""></p> <p><strong>FIGURE 28</strong> Inputs for NMState in operator</p> <h4 id="creating-a-linux-bridge-nncp"><a href="#creating-a-linux-bridge-nncp" class="header-anchor">#</a> Creating a Linux bridge NNCP</h4> <p>Create a NodeNetworkConfigurationPolicy (NNCP) manifest for a Linux bridge network for network interface card(enp1s0)
and apply the created NNCP manifest</p> <div class="language-bash extra-class"><pre class="language-bash"><code>apiVersion: nmstate.io/v1
kind: NodeNetworkConfigurationPolicy
metadata:
  name: br1-policy
spec:
  desiredState:
    interfaces:
      - name: bridge1
        type: linux-bridge
        state: up
        ipv4:
          dhcp: <span class="token boolean">true</span>
          enabled: <span class="token boolean">true</span>
        bridge:
          options:
            stp:
              enabled: <span class="token boolean">false</span>
          port:
             - name: enp1s0           <span class="token comment">#NIC/Bond</span>
</code></pre></div><h4 id="creating-a-linux-bridge-nad"><a href="#creating-a-linux-bridge-nad" class="header-anchor">#</a> Creating a Linux bridge NAD</h4> <ol><li><p>Log in to the OpenShift Container Platform web console and click Networking → NetworkAttachmentDefinitions</p></li> <li><p>Click Create Network Attachment Definition (NAD). And provide the required details</p></li> <li><p>Click the Network Type list and select CNV Linux bridge</p></li> <li><p>Enter the name of the bridge (Previously created NodeNetworkConfigurationPolicy object as interfaces name
ex: bridge1) in the Bridge Name field</p></li> <li><p>Click Create</p></li></ol> <p><img src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/img/figure-virt8.ab2626b7.png" alt=""></p> <p><strong>FIGURE 29</strong> Creation of NAD</p> <h4 id="creating-a-dedicated-network-for-live-migration"><a href="#creating-a-dedicated-network-for-live-migration" class="header-anchor">#</a> Creating a dedicated network for live migration</h4> <ol><li>Administrators have to create additional NAD for creating a dedicated live migration network.
Create a NAD manifest as below</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>apiVersion: <span class="token string">&quot;k8s.cni.cncf.io/v1&quot;</span>
kind: NetworkAttachmentDefinition
metadata:
  name: migration-network 
  namespace: openshift-cnv 
spec:
  config: <span class="token string">'{
    &quot;cniVersion&quot;: &quot;0.3.1&quot;,
    &quot;name&quot;: &quot;migration-bridge&quot;,
    &quot;type&quot;: &quot;macvlan&quot;,
    &quot;master&quot;: &quot;enp1s1&quot;, 
    &quot;mode&quot;: &quot;bridge&quot;,
    &quot;ipam&quot;: {
      &quot;type&quot;: &quot;whereabouts&quot;, 
      &quot;range&quot;: &quot;20.0.0.0/24&quot; 
    }
  }'</span>
</code></pre></div><ol start="2"><li>Goto the custom resource of Hydercoverged that was created during &quot;OpenShift Virtualization&quot; operator deployment
and Specify the created network name for &quot;spec.liveMigrationConfig&quot;</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>apiVersion: hco.kubevirt.io/v1beta1
kind: HyperConverged
metadata:
  name: kubevirt-hyperconverged
spec:
  liveMigrationConfig:
    completionTimeoutPerGiB: <span class="token number">800</span>
    network: migration-network  <span class="token comment">#specify migration network name</span>
    parallelMigrationsPerCluster: <span class="token number">5</span>
    parallelOutboundMigrationsPerNode: <span class="token number">2</span>
    progressTimeout: <span class="token number">150</span>
</code></pre></div><h2 id="storage-configuration"><a href="#storage-configuration" class="header-anchor">#</a> Storage configuration</h2> <p>Configure storage as stated in [Storage options] (../Additional-Features-and-Functionality/Storage.md#Storage options)</p> <h2 id="create-a-virtual-machine"><a href="#create-a-virtual-machine" class="header-anchor">#</a> Create a virtual machine</h2> <p>The web console features an interactive wizard that guides you through General, Networking, Storage, Advanced, and Review steps to
simplify the process of creating virtual machines. All required fields are marked by a *. When the required fields are completed,
you can review and create your virtual machine.</p> <p>Network Interface Cards (NICs) and storage disks can be created and attached to virtual machines after they have been created.</p> <p>Use one of these procedures to create a virtual machine:</p> <ul><li><p>Creating virtual machines from templates</p></li> <li><p>Creating virtual machines from instance types</p></li> <li><p>Creating virtual machines from CLI</p></li></ul> <h3 id="creating-virtual-machines-from-templates"><a href="#creating-virtual-machines-from-templates" class="header-anchor">#</a> Creating virtual machines from templates</h3> <p>You can create virtual machines from templates provided by Red Hat using web console. You can also create customized templates
as per requirements.</p> <ol><li>Log into the OpenShift Container Platform web console and navigate to Virtualization → Catalog → Template Catalog</li></ol> <p><img src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/img/figure-virt9.a4d73d11.png" alt=""></p> <p><strong>FIGURE 30</strong> Templates available by default in Virtualization</p> <ol start="2"><li><p>Apply the filter &quot;Boot source available&quot;.</p></li> <li><p>Click the required template to view the details (for example: fedora)</p></li> <li><p>Click &quot;Quick create VirtualMachine&quot; to create a VM from the template. You can customize the CPU/Memory/Storage as required.</p></li></ol> <p><img src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/img/figure-virt10.e6be55db.png" alt=""></p> <p><strong>FIGURE 31</strong> Sample deployment of fedora VM using templates</p> <h3 id="creating-virtual-machines-from-instance-types"><a href="#creating-virtual-machines-from-instance-types" class="header-anchor">#</a> Creating virtual machines from instance types</h3> <ol><li>Log into the OpenShift Container Platform web console and navigate to Virtualization → Catalog  → Instance Types</li></ol> <p><img src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/img/figure-virt11.8bc6d796.png" alt=""></p> <p><strong>FIGURE 32</strong> Virtual Machine creation from Catalog</p> <ol start="2"><li><p>Select the bootable volumes</p> <ul><li>Images provided by RedHat, these images are available in &quot;openshift-virtualization-os-images&quot; namespace.</li> <li>Click Add Volume. You can either use any of the existing volume where you have the boot images or you can upload images and
create a new volume(PVC) and provide the required parameter.</li></ul> <p><img src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/img/figure-virt12.cfa91e6d.png" alt=""></p> <p><strong>FIGURE 33</strong> Add volumes to import OS images</p></li> <li><p>Click the required boot volume.</p></li> <li><p>Select the required Instance type</p></li></ol> <p><img src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/img/figure-virt13.454141ee.png" alt=""></p> <p><strong>FIGURE 34</strong> Selection of Instance type and boot image</p> <ol start="5"><li>Click &quot;Create VirtualMachine&quot; to create a VM from the instance types.</li></ol> <p>You can Customize and create user Instance type as required by navigating to Virtualization → Instance Types → Create.</p> <h3 id="creating-virtual-machines-from-cli"><a href="#creating-virtual-machines-from-cli" class="header-anchor">#</a> Creating virtual machines from CLI</h3> <ol><li>Create a VirtualMachine manifest required for creating a VM</li></ol> <p>Below is an example manifest for creating fedora VM</p> <div class="language-bash extra-class"><pre class="language-bash"><code>apiVersion: kubevirt.io/v1
kind: VirtualMachine
metadata:
  name: my-vm
spec:
  running: <span class="token boolean">false</span>
  template:
    metadata:
      labels:
        kubevirt.io/domain: my-vm
    spec:
      domain:
        devices:
          disks:
          - disk:
              bus: virtio
            name: containerdisk
          - disk:
              bus: virtio
            name: cloudinitdisk
        resources:
          requests:
            memory: 8Gi
      volumes:
      - name: containerdisk
        containerDisk:
          image: kubevirt/fedora-cloud-registry-disk-demo
      - name: cloudinitdisk
        cloudInitNoCloud:
          userData: <span class="token operator">|</span>
            <span class="token comment">#cloud-config</span>
            password: fedora
            chpasswd: <span class="token punctuation">{</span> expire: False <span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>Apply the created manifest file for virtual machine creation.</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>oc apply <span class="token parameter variable">-f</span> <span class="token operator">&lt;</span> file-name <span class="token operator">&gt;</span>.yaml
</code></pre></div><h2 id="reading-viewing-virtual-machine"><a href="#reading-viewing-virtual-machine" class="header-anchor">#</a> Reading/Viewing virtual machine</h2> <p>You can check the virtual machine status, Metrics , resources utilization (CPU, memory, storage) for overall cluster
by navigate to Virtualization → Overview.</p> <p><img src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/img/figure-virt16.df019a9a.png" alt=""></p> <p><strong>FIGURE 35</strong> Overview Virtual machines in the Cluster</p> <p>and access configuration details of VM's, networks and  storage volumes.</p> <p><img src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/img/figure-virt17.cc2b5c9f.png" alt=""></p> <p><strong>FIGURE 36</strong> Overview of Sample Virtual machines deployed in the RHOCP platform</p> <h2 id="updating-a-virtual-machine"><a href="#updating-a-virtual-machine" class="header-anchor">#</a> Updating a virtual machine</h2> <p>You can update virtual machine configuration using CLI or from the web console.</p> <h3 id="virtual-machine-configuration-using-cli"><a href="#virtual-machine-configuration-using-cli" class="header-anchor">#</a> virtual machine configuration using CLI</h3> <ol><li>Virtual machine configuration can be edit/updated</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>oc edit vm <span class="token operator">&lt;</span> vm-name <span class="token operator">&gt;</span> <span class="token parameter variable">-n</span> <span class="token operator">&lt;</span> namespace <span class="token operator">&gt;</span>
</code></pre></div><ol start="2"><li>Apply the updated configuration</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>oc apply vm <span class="token operator">&lt;</span> vm_name <span class="token operator">&gt;</span> <span class="token parameter variable">-n</span> <span class="token operator">&lt;</span> namespace <span class="token operator">&gt;</span>
</code></pre></div><h3 id="virtual-machine-configuration-using-web-console"><a href="#virtual-machine-configuration-using-web-console" class="header-anchor">#</a> virtual machine configuration using web console</h3> <ol><li><p>Log into the OpenShift Container Platform web console and navigate to Virtualization → VirtualMachines</p></li> <li><p>Select the virtual machine
For example: addition of the disk
navigate to Configuration → Storage → Add disk
<img src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/img/figure-virt14.588e8482.png" alt=""></p> <p><strong>FIGURE 37</strong> Storage disk addition</p> <p>Specify the fields like Source, Size, Storage class as required</p> <p>Click Add
we can add additional networks, secrets, config map to virtual machines.</p></li></ol> <p>Some of the changes are applied once the virtual machine are restarted only. For restarting of any virtual machines
navigate to Virtualization → VirtualMachines
Click the Options menu <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAATCAYAAACp65zuAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAFiUAABYlAUlSJPAAAAE2SURBVDhPY/wPBAxEACYoTRCgmPj02XOG3Xv2M/Dy8TB4ubsycHJyQmWQFL55+5ahpb2b4ffvP2AJGWkphsqyIjAbBOBWv3jxCq4IBJ48fcbw798/KA9JoZKiAgMHBweUx8Cgqa7GwMSE8AKKG1+8fMmwfeceBn5+PrAbkTViBM/r128YuLi5GLi5uKAiEABXCHLPoiUrGE6fPQe2Mjw0iMHGygKsCATgjrh56zZYEQiANK1as54B2TK4Qi40q1hZWbErlJeTZbCGWgWyOjI8GLev8QEUhceOn2TYsn0nAx8vL0NURCiDnKwMVAbJ6oePHjMsXbGa4ePHTwyPnzxlmDxtJlQGAuAKv337BmVBwLdv3xn+/P0L5SEpBEWhsJAQlMfAYGpsxMDCzAzlkeAZhP/xAgYGABivf09+EIdPAAAAAElFTkSuQmCC" alt=""> beside a virtual machine name and select Restart or select the virtual machine → Actions → Restart</p> <h2 id="deleting-a-virtual-machine"><a href="#deleting-a-virtual-machine" class="header-anchor">#</a> Deleting a virtual machine</h2> <p>You can delete a virtual machine by using CLI or from the web console.</p> <h3 id="delete-a-virtual-machine-using-cli"><a href="#delete-a-virtual-machine-using-cli" class="header-anchor">#</a> Delete a virtual machine using CLI</h3> <ol><li>Delete the virtual machine by executing the below command:</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>oc delete vm <span class="token operator">&lt;</span> vm_name <span class="token operator">&gt;</span> <span class="token parameter variable">-n</span> <span class="token operator">&lt;</span> namespace <span class="token operator">&gt;</span>
</code></pre></div><h3 id="delete-a-virtual-machine-using-web-console"><a href="#delete-a-virtual-machine-using-web-console" class="header-anchor">#</a> Delete a virtual machine using web console</h3> <ol><li><p>Log into the OpenShift Container Platform web console and navigate to Virtualization → VirtualMachines</p></li> <li><p>Click the Options menu <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAATCAYAAACp65zuAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAFiUAABYlAUlSJPAAAAE2SURBVDhPY/wPBAxEACYoTRCgmPj02XOG3Xv2M/Dy8TB4ubsycHJyQmWQFL55+5ahpb2b4ffvP2AJGWkphsqyIjAbBOBWv3jxCq4IBJ48fcbw798/KA9JoZKiAgMHBweUx8Cgqa7GwMSE8AKKG1+8fMmwfeceBn5+PrAbkTViBM/r128YuLi5GLi5uKAiEABXCHLPoiUrGE6fPQe2Mjw0iMHGygKsCATgjrh56zZYEQiANK1as54B2TK4Qi40q1hZWbErlJeTZbCGWgWyOjI8GLev8QEUhceOn2TYsn0nAx8vL0NURCiDnKwMVAbJ6oePHjMsXbGa4ePHTwyPnzxlmDxtJlQGAuAKv337BmVBwLdv3xn+/P0L5SEpBEWhsJAQlMfAYGpsxMDCzAzlkeAZhP/xAgYGABivf09+EIdPAAAAAElFTkSuQmCC" alt=""> beside a virtual machine name and select Delete or Select the virtual machine → Actions → Delete</p></li></ol> <p><img src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/img/figure-virt26.7ce848cf.png" alt=""></p> <h2 id="hot-plugging-a-vm-disks"><a href="#hot-plugging-a-vm-disks" class="header-anchor">#</a> Hot-plugging a VM disks</h2> <p>You can add or remove virtual disks without stopping your virtual machine (VM). However, only data volumes and persistent volume claims (PVCs) can be hot-plugged and hot-unplugged; container disks cannot. A hot-plugged disk stays attached to the VM even after a reboot, and you must detach it to remove it from the VM.</p> <h4 id="adding-a-disk-using-web-console"><a href="#adding-a-disk-using-web-console" class="header-anchor">#</a> Adding a disk using web console</h4> <ol><li><p>Log into the OpenShift Container Platform web console and navigate to Virtualization → VirtualMachines</p></li> <li><p>Select any running virtul machine and navigate to Configuration → Storage → Add disk</p> <p><img src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/img/figure-virt14.588e8482.png" alt=""></p></li> <li><p>Provide the details for the disk to be added and Save.</p></li></ol> <h3 id="adding-disk-using-cli"><a href="#adding-disk-using-cli" class="header-anchor">#</a> Adding disk using CLI</h3> <p>You can hot plug and hot unplug a disk while a virtual machine (VM) is running by using the command line.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>virtctl addvolume <span class="token operator">&lt;</span>virtual-machine<span class="token operator">|</span>virtual-machine-instance<span class="token operator">&gt;</span> --volume-name<span class="token operator">=</span><span class="token operator">&lt;</span>datavolume<span class="token operator">|</span>PVC<span class="token operator">&gt;</span> <span class="token punctuation">[</span>--persist<span class="token punctuation">]</span> <span class="token punctuation">[</span>--serial<span class="token operator">=</span><span class="token operator">&lt;</span>label-name<span class="token operator">&gt;</span><span class="token punctuation">]</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/hpe-solutions-openshift/4.15-AMD-LTI/Storage/Storage.html" class="prev">
        Storage Options
      </a></span> <span class="next"><a href="/hpe-solutions-openshift/4.15-AMD-LTI/Virtualization/Virt-Live-migration.html">
        Live migration
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/app.17b54db2.js" defer></script><script src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/2.b11c95b8.js" defer></script><script src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/1.3a6b1407.js" defer></script><script src="/hpe-solutions-openshift/4.15-AMD-LTI/assets/js/11.9955f42d.js" defer></script>
  </body>
</html>
