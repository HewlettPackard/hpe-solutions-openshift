<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Validating OpenShift Container Platform deployment | OpenShift Container Platform 4.6 on Synergy</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Hewlett Packard Enterprise">
    
    <link rel="preload" href="/hpe-solutions-openshift/46-synergy/assets/css/0.styles.55697aca.css" as="style"><link rel="preload" href="/hpe-solutions-openshift/46-synergy/assets/js/app.85d70ec5.js" as="script"><link rel="preload" href="/hpe-solutions-openshift/46-synergy/assets/js/2.fa142977.js" as="script"><link rel="preload" href="/hpe-solutions-openshift/46-synergy/assets/js/28.9f8648b2.js" as="script"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/10.08281fa0.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/11.62169700.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/12.a384883b.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/13.14b1c483.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/14.e2ed2b94.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/15.6b7b2986.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/16.2812ef60.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/17.1e86af0b.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/18.1b39e9d9.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/19.73feff90.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/20.c807ba2f.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/21.ea4d33a2.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/22.be8f0d0d.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/23.7bab011f.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/24.c8c1d21d.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/25.60976ff9.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/26.31b8fa12.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/27.479e0913.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/29.36b22707.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/3.21f3bfd2.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/30.b6d944bc.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/31.eac5b504.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/32.f5577221.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/33.b81dadd0.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/34.1418d906.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/35.df4061e1.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/36.ae0cc03f.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/37.29980f90.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/4.4a1835ae.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/5.5a3beac7.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/6.eee306da.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/7.2bd79bc4.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/8.49e62253.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/9.4b7c9b75.js">
    <link rel="stylesheet" href="/hpe-solutions-openshift/46-synergy/assets/css/0.styles.55697aca.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hpe-solutions-openshift/46-synergy/" class="home-link router-link-active"><!----> <span class="site-name">OpenShift Container Platform 4.6 on Synergy</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hpe-solutions-openshift/46-synergy/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/hpe-solutions-openshift/46-synergy/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Red Hat OpenShift Container Platform 4.6 on HPE Synergy</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Overview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Components</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Deployment</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Additional Features and Functionality</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Storage.html" class="sidebar-link">Storage Option</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/IPI-Installation.html" class="sidebar-link">IPI deployment of OCP on Bare Metal</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Air-gap-Installation.html" class="sidebar-link">Red Hat OpenShift Container Platform installation in the restricted network environment</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/OpenShift-operators.html" class="sidebar-link">OpenShift operators</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Integration-with-Prometheus.html" class="sidebar-link">Integration of HPE OneView with Prometheus</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Sysdig-Secure.html" class="sidebar-link">Securing Red Hat OpenShift Container Platform using Sysdig Secure and Sysdig Monitor</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Physical-worker-node-labeling.html" class="sidebar-link">Physical worker node labeling in Red Hat OpenShift cluster</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Advanced-Cluster-Management.html" class="sidebar-link">Red Hat Advanced Cluster Management for Kubernetes</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Install-and-Configure-Velero.html" class="sidebar-link">Install and Configure Velero</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Ceph-Storage-Setup-ExternalMode.html" class="sidebar-link">Red Hat Ceph Storage 4 Setup in External mode with OCS Integration</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Openshift-Virtualization.html" class="sidebar-link">OpenShift Virtualization</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Validating-OCP-Deployment.html" aria-current="page" class="active sidebar-link">Validating OpenShift Container Platform deployment</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Validating-OCP-Deployment.html#deploying-mongodb-application" class="sidebar-link">Deploying MongoDB application</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Validating-OCP-Deployment.html#verifying-mongodb-pod-deployment" class="sidebar-link">Verifying MongoDB pod deployment</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Resosurces and Additional Links</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="validating-openshift-container-platform-deployment"><a href="#validating-openshift-container-platform-deployment" class="header-anchor">#</a> Validating OpenShift Container Platform deployment</h1> <p>After the cluster is up and running with OpenShift Local Storage
Operator, the cluster configuration is validated by deploying a MongoDB
pod with persistent volume and Yahoo Cloud Service Benchmarking (YCSB).
This section covers the steps to validate the OpenShift Container
Platform deployment.</p> <div class="custom-block warning"><p class="custom-block-title">PREREQUISITES</p> <ul><li><p>OCP 4.6 cluster must be installed.</p></li> <li><p>Use local storage or OCS to claim persistent volume (PV).</p></li> <li><p>MongoDB instance will only support local file system storage or OCS
file system.</p></li></ul> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Block storage is not supported.</p></div></div> <h2 id="deploying-mongodb-application"><a href="#deploying-mongodb-application" class="header-anchor">#</a> Deploying MongoDB application</h2> <ol><li><p>Login to the installer VM as a non-root user.</p></li> <li><p>Use the following command to download the Red Hat scripts specific
to the MongoDB application at
<a href="https://github.com/red-hat-storage/SAWORF" target="_blank" rel="noopener noreferrer">https://github.com/red-hat-storage/SAWORF<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token function">sudo</span> <span class="token function">git</span> clone <span class="token operator">&lt;</span>https://github.com/red-hat-storage/SAWORF.git<span class="token operator">&gt;</span>  
</code></pre></div></li> <li><p>From within the red-hat-storage repository, navigate to the folder
SAWORF/OCS3/MongoDB/blog2.</p></li> <li><p>Update the <em>create_and_load.sh</em> script with <strong>local storage</strong>, <strong>OCS
,</strong> <strong>Nimble storage,</strong> and <strong>3PAR storage</strong> in place of
<strong>glusterfs</strong> content. Example is as follows.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token assign-left variable">mongodb_ip</span><span class="token operator">=</span><span class="token punctuation">$(</span>oc get svc -n <span class="token variable">${PROJECT_NAME}</span> <span class="token operator">|</span> <span class="token function">grep</span> -v **local storage** <span class="token operator">|</span> <span class="token function">grep</span> mongodb <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$3</span>}'</span>
</code></pre></div></li> <li><p>Create MongoDB and YCSB pods and load the sample data.</p></li> <li><p>Update the following command with appropriate values for the command
line parameters and execute the command to create the MongoDB and
YCSB pods and also to load the sample data.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ./create_and_load_mongodb <span class="token variable">$PROJECT_NAME</span> <span class="token variable">$OCP_TEMPLATE</span> <span class="token variable">$MONGODB_MEMORY_LIMIT</span> <span class="token variable">$PV_SIZE</span> <span class="token variable">$MONGODB_VERSION</span> <span class="token variable">$YCSB_WORKLOAD</span> <span class="token variable">$YCSB_DISTRIBUTION</span> <span class="token variable">$YCSB_RECORDCOUNT</span> <span class="token variable">$YCSB_OPERATIONCOUNT</span> <span class="token variable">$YCSB_THREADS</span> <span class="token variable">$LOG_DIR</span>
</code></pre></div><p>Example command is shown as follows.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ./create_and_load_mongodb dbtest mongodb-persistent 4Gi 10Gi <span class="token number">3.6</span> workloadb uniform <span class="token number">4000</span> <span class="token number">4000</span> <span class="token number">8</span> root /mnt/data/
</code></pre></div><p>The output is as follows.</p> <div class="language- extra-class"><pre class="language-text"><code>&gt; Deploying template &quot;openshift/mongodb-persistent&quot; to project dbtest

 MongoDB

---------

&gt; MongoDB database service, with persistent storage. For more information about using this template, including OpenShift considerations, see documentation in the upstream repository: https://github.com/sclorg/mongodb-container.


NOTE: Scaling to more than one replica is not supported. You must have persistent volume available in your cluster to use this template.

The following service(s) have been created in your project: mongodb.

Username: redhat

Password: redhat

Database Name: redhatdb

Connection URL: mongodb://redhat:redhat@mongodb/redhatdb

For more information about using this template, including OpenShift considerations, see documentation in the upstream repository: https://github.com/sclorg/mongodb-container.

With parameters:

    * Memory Limit=4Gi

    * Namespace=openshift

     * Database Service Name=mongodb

     * MongoDB Connection Username=redhat

     * MongoDB Connection Password=redhat

     * MongoDB Database Name=redhatdb

     * MongoDB Admin Password=redhat

     * Volume Capacity=10Gi

     * Version of MongoDB Image=3.6

&gt; Creating resources ...

     secret &quot;mongodb&quot; created

     service &quot;mongodb&quot; created

     error: persistentvolumeclaims &quot;mongodb&quot; already exists

     deploymentconfig.apps.openshift.io &quot;mongodb&quot; created

&gt; Failed

 pod/ycsb-pod created

</code></pre></div></li> <li><p>Execute the following command to run the check_db_size script.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ./check_db_size <span class="token variable">$PROJECT_NAME</span>
</code></pre></div><p>The output is as follows.</p> <div class="language- extra-class"><pre class="language-text"><code>

 MongoDB shell version v3.6.12

 connecting to: mongodb://172.x.x.x:27017/redhatdb?gssapiServiceName=mongodb

 Implicit session: session {&quot;id&quot; : UUID(&quot;c0a76ddc-ea0b-4fc-88fd-045d0f98b2&quot;) }

 MongoDB server version: 3.6.3

 {

               &quot;db&quot; : &quot;redhatdb&quot;,

               &quot;collections&quot; : 1,

               &quot;views&quot; : 0,

               &quot;objects&quot; : 4000,

               &quot;avgObjSize&quot; : 1167.877,

               &quot;dataSize&quot; : 0.004350680857896805,

               &quot;storageSize&quot; : 0.00446319580078125,

               &quot;numExtents&quot; : 0,

               &quot;indexes&quot; : 1,

               &quot;indexSize&quot; : 0.0001068115234375,

               &quot;fsUsedSize&quot; : 1.0311393737792969,

               &quot;fsTotalSize&quot; : 99.951171875,

               &quot;ok&quot; : 1

 }

</code></pre></div></li></ol> <h2 id="verifying-mongodb-pod-deployment"><a href="#verifying-mongodb-pod-deployment" class="header-anchor">#</a> Verifying MongoDB pod deployment</h2> <ol><li>Execute the following command to verify the persistent volume
associated with MongoDB pods.</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> oc get <span class="token function">pv</span><span class="token operator">|</span><span class="token function">grep</span> mongodb
</code></pre></div><ol start="2"><li>The output is as follows.</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> local-pv-e7f10f65 100Gi RWO Delete Bound dbtest/mongodb local-sc 26h
</code></pre></div><ol start="3"><li>Execute the following command to verify the persistent volume claim
(PVC) associated with MongoDB pods.</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> oc get pvc 
</code></pre></div><ol start="4"><li>The output is as follows.</li></ol> <div class="language- extra-class"><pre class="language-text"><code>&gt; local-pv-e7f10f65 100Gi RWO Delete Bound dbtest/mongodb local-sc 26h
</code></pre></div><ol start="5"><li>Execute the following command to ensure MongoDB and YCSB pods are up
and running.</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> oc get pod
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>    The output is as follows.


        NAME               READY   STATUS      RESTARTS   AGE

        mongodb-1-deploy   0/1     Completed   0          3m40s

        mongodb-1-skbwq    1/1     Running     0          3m36s

        ycsb-pod           1/1     Running     0          3m41s
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>For more information about deploying MongoDB application along with
YCSB, refer to the Red Hat documentation at
<a href="https://www.redhat.com/en/blog/multitenant-deployment-mongodb-using-openshift-container-storage-and-using-ycsb-test-performance" target="_blank" rel="noopener noreferrer">https://www.redhat.com/en/blog/multitenant-deployment-mongodb-using-openshift-container-storage-and-using-ycsb-test-performance<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Openshift-Virtualization.html" class="prev">
        OpenShift Virtualization
      </a></span> <span class="next"><a href="/hpe-solutions-openshift/46-synergy/Resosurces-and-additional-links/Resources.html">
        Resosurces and additional links
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/hpe-solutions-openshift/46-synergy/assets/js/app.85d70ec5.js" defer></script><script src="/hpe-solutions-openshift/46-synergy/assets/js/2.fa142977.js" defer></script><script src="/hpe-solutions-openshift/46-synergy/assets/js/28.9f8648b2.js" defer></script>
  </body>
</html>
