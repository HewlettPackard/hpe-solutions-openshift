<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Physical worker node labeling in Red Hat OpenShift cluster | OpenShift Container Platform 4.4 on Synergy</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Hewlett Packard Enterprise">
    
    <link rel="preload" href="/hpe-solutions-openshift/46-synergy/assets/css/0.styles.bfdf2f8a.css" as="style"><link rel="preload" href="/hpe-solutions-openshift/46-synergy/assets/js/app.8d09024b.js" as="script"><link rel="preload" href="/hpe-solutions-openshift/46-synergy/assets/js/2.117ef8fd.js" as="script"><link rel="preload" href="/hpe-solutions-openshift/46-synergy/assets/js/6.b3a62cb0.js" as="script"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/10.f2647a7a.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/11.eb22f408.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/12.c2b1bda3.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/13.b2721807.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/14.fbb5bfdd.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/15.076cb55f.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/16.086f907f.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/17.5044d63c.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/18.0138d6da.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/19.577c768d.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/20.5dab068a.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/21.ea4d33a2.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/22.23d6a92d.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/23.329f64c2.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/24.bad0d82d.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/25.2a05a77a.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/26.05687ea8.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/27.5f97f9ba.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/28.9f8648b2.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/29.ffe26d0e.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/3.643f6564.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/30.b6d944bc.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/31.b0b75d1f.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/32.4d1ff1fb.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/33.da67f8dd.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/34.78fab925.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/35.5e384204.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/36.53dec668.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/37.e773d372.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/4.7110e26d.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/5.8d6b47a1.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/7.a921eaba.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/8.8b92de32.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/9.7e00b22b.js">
    <link rel="stylesheet" href="/hpe-solutions-openshift/46-synergy/assets/css/0.styles.bfdf2f8a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hpe-solutions-openshift/46-synergy/" class="home-link router-link-active"><!----> <span class="site-name">OpenShift Container Platform 4.4 on Synergy</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hpe-solutions-openshift/46-synergy/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/hpe-solutions-openshift/46-synergy/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Red Hat OpenShift Container Platform 4 on HPE Synergy</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Overview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Components</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Deployment</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Additional Features and Functionality</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Storage.html" class="sidebar-link">Storage</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/IPI-Installation.html" class="sidebar-link">IPI deployment of OCP on Bare Metal</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Air-gap-Installation.html" class="sidebar-link">Red Hat OpenShift Container Platform installation in the restricted network environment</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/OpenShift-operators.html" class="sidebar-link">OpenShift operators</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Integration-with-Prometheus.html" class="sidebar-link">Integration of HPE OneView with Prometheus</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Sysdig-Secure.html" class="sidebar-link">Securing Red Hat OpenShift Container Platform using Sysdig Secure and Sysdig Monitor</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Physical-worker-node-labeling.html" aria-current="page" class="active sidebar-link">Physical worker node labeling in Red Hat OpenShift cluster</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Physical-worker-node-labeling.html#description" class="sidebar-link">Description</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Physical-worker-node-labeling.html#software-requirements" class="sidebar-link">Software requirements</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Physical-worker-node-labeling.html#input-files" class="sidebar-link">Input files</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Physical-worker-node-labeling.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Physical-worker-node-labeling.html#deploying-hpe-oneview-syslog-pod-on-an-existing-pod-with-red-hat-openshift-container-platform" class="sidebar-link">Deploying HPE OneView Syslog pod on an existing pod with Red Hat OpenShift Container Platform</a></li></ul></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Advanced-Cluster-Management.html" class="sidebar-link">Red Hat Advanced Cluster Management for Kubernetes</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Install-and-Configure-Velero.html" class="sidebar-link">Install and Configure Velero</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Ceph-Storage-Setup-ExternalMode.html" class="sidebar-link">Red Hat Ceph Storage 4 Setup in External mode with OCS Integration</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Openshift-Virtualization.html" class="sidebar-link">OpenShift Virtualization</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Validating-OCP-Deployment.html" class="sidebar-link">Validating OpenShift Container Platform deployment</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Resosurces and Additional Links</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="physical-worker-node-labeling-in-red-hat-openshift-cluster"><a href="#physical-worker-node-labeling-in-red-hat-openshift-cluster" class="header-anchor">#</a> Physical worker node labeling in Red Hat OpenShift cluster</h1> <h2 id="description"><a href="#description" class="header-anchor">#</a> Description</h2> <ul><li><p>This section describes the scripts to automate the process of
retrieving the hardware properties from physical worker nodes of the
Red Hat OpenShift cluster and using the Red Hat OpenShift Node
Labeling capability to label the physical worker node with the
retrieved properties. These node labels along with Red Hat OpenShift
node selector capability can be used by the user for defining the
pod deployment configuration in order to ensure pod is running on
the physical node with desired hardware properties.</p></li> <li><p><strong>Nodes can be labelled for the following properties:</strong></p> <ol><li><strong>Overall Health Status of the node</strong> - If current status health
status of following components &quot;BIOS, Fans, Temperature Sensors,
Battery, Processor, Memory, Network and Storage&quot; of the HPE
Synergy compute is ok, physical node health status is considered
&quot;Ok&quot; else &quot;Degraded&quot;</li> <li><strong>Overall Security Status of the node</strong> - If the current status
of the following BIOS security configuration (which are
important for the compute security) is as listed &quot;secure boot
status: enabled, asset tag: locked, UEFI Shell Script
Verification: enabled, UEFI Shell Startup: disabled, Processor
AES: enabled&quot; then the overall security status of the physical
node is considered &quot;Ok&quot; else &quot;degraded&quot;.</li> <li><strong>Custom labeling</strong> - User defined labels (key, value) is
assigned to desired physical worker node.</li></ol></li></ul> <div class="custom-block warning"><p class="custom-block-title">PREREQUISITES</p> <ul><li><p>Ansible engine with Ansible 2.9.x and Python 3.6.x</p></li> <li><p>Red Hat OpenShift 4.x is up and running.</p></li> <li><p>The RedHat OpenShift cluster must have physical worker node to use
the &quot;Node labeling&quot; functionality.</p></li> <li><p>The playbook under this repository needs to be run from Ansible
Installer Machine with the Python virtual environment as non-root
user.</p></li></ul></div> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Refer to <a href="/hpe-solutions-openshift/46-synergy/Solution-Deployment/Preparing-execution-environment.html#non-root-user-access">Non-root user access</a>section of this
deployment guide to know more about the non-root user details.</p></div> <ul><li><p>Python module &quot;proliantutils&quot; is installed on the OpenShift
Installer Machine.</p></li> <li><p>&quot;proliantutils&quot; is a set of utility libraries for interfacing and managing various components (like iLO) for HPE ProLiant Servers.</p> <ul><li>Use the following command to install proliantutils.</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span>   pip <span class="token function">install</span> <span class="token assign-left variable">ansible</span><span class="token operator">==</span><span class="token number">2.9</span>.0
</code></pre></div><ul><li>Verify the version of proliantutils.</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> pip freeze <span class="token operator">|</span> <span class="token function">grep</span> proliantutils
</code></pre></div><ul><li>Output</li></ul> <div class="language- extra-class"><pre class="language-text"><code>proliantutils==2.9.2
</code></pre></div></li> <li><p>Install the &quot;sushy&quot; python library. In case &quot;sushy&quot; module is
already installed, please ensure its version is 3.0.0.</p> <ul><li>Use the following command to install sushy module.</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> pip <span class="token function">install</span> <span class="token assign-left variable">sushy</span><span class="token operator">==</span><span class="token number">3.0</span>.0
</code></pre></div><ul><li>Verify the version of proliantutils.</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> pip freeze <span class="token operator">|</span> <span class="token function">grep</span> sushy
</code></pre></div><ul><li>Output:</li></ul> <div class="language- extra-class"><pre class="language-text"><code>sushy==3.0.0
</code></pre></div></li></ul> <h2 id="software-requirements"><a href="#software-requirements" class="header-anchor">#</a> Software requirements</h2> <table><thead><tr><th>Software</th> <th>Version</th></tr></thead> <tbody><tr><td>HPE OneView</td> <td>5</td></tr></tbody></table> <h2 id="input-files"><a href="#input-files" class="header-anchor">#</a> Input files</h2> <ul><li>Playbook for RedHat OpenShift Container Platform Physical Worker
Node labeling are available under
$BASE_DIR/platform/physical-physical-workerlabeling/</li></ul> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>BASE_DIR is defined and set in <a href="/hpe-solutions-openshift/46-synergy/Solution-Deployment/Preparing-execution-environment.html#installer-machine">installer machine</a>
section in deployment guide.</p></div> <ul><li><p>It is mandatory to update all the input files (hosts, secrets.yml,
sysdig-agent-configmap.yaml) with appropriate values before running
the playbook available in this repository.</p></li> <li><p><strong>Input file name</strong>: hosts.json</p> <ol><li>This file is an inventory of host details.</li> <li>This file contains sensitive information like iLO IP and
credentials, Worker IP and labels. So, data inside this file
is encrypted.</li> <li>To edit this vault file, use the following command and
provide the default &quot;ansible vault&quot; password.<div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> ansible-vault edit hosts.json
</code></pre></div></li> <li>For each of the physical worker node that is part of RedHat
OpenShift cluster, the user needs to provide the following
information:<div class="language- extra-class"><pre class="language-text"><code>&quot;host_fqdn&quot;: &quot;replace_with_physical_worker_node1_fqdn&quot;,
&quot;ilo_ip&quot;: &quot;replace_with_ilo_ip_of_physical_worker_node1&quot;,
&quot;username&quot;: &quot;replace_with_ilo_username&quot;,
&quot;password&quot;: &quot;replace_with_ilo_password&quot;,
&quot;custom_label_required&quot;: &quot;replace_with_No_or_Yes&quot;,
&quot;label_name&quot;: &quot;replace_with_desired_label_key&quot;,
&quot;label_val&quot;: &quot;replace_with_desired_label_value&quot;
</code></pre></div></li></ol></li></ul> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Information inside hosts.json is available in a nested JSON
format, which means user can add any number of physical worker
node by creating the sections as &quot;server 1, server 2, server 3,
...server N&quot; and can also add any number of &quot;custom labels&quot; as
&quot;label 1, label 2, label 3 to label N&quot;. Refer to &quot;hosts.json&quot; to
understand this nested JSON structure. &quot;N&quot; represent the Nth
number server.</p></div> <ul><li><p><strong>Input file name</strong>: config.json</p> <ul><li>Provide the path information about &quot;kubeconfig&quot; and &quot;oc&quot;
command.
<ul><li><strong>kubeconfig_path:</strong> The value of this key is the path
of kubeconfig and this path is used by &quot;oc&quot; command at
runtime.</li> <li><strong>oc_command_path:</strong> The value of this key is the oc
command path and this path is used to run the &quot;oc&quot;
command.</li></ul> <div class="language- extra-class"><pre class="language-text"><code>&quot;kubeconfig_path&quot;: &quot;replace_with_path_of_ocp_kubeconfig&quot;,
&quot;oc_command_path&quot;: &quot;replace_with_path_of_ocp_installation_dir&quot;
</code></pre></div></li></ul></li> <li><h4 id="steps-to-run-the-node-labeling-automation-scripts"><a href="#steps-to-run-the-node-labeling-automation-scripts" class="header-anchor">#</a> Steps to run the Node Labeling automation scripts</h4> <ul><li>Execute the following commands from the Ansible installer VM in
the python virtual environment as a non-root user.</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">cd</span> <span class="token variable">$BASE_DIR</span>/platform/physical-workerlabelling/
<span class="token operator">&gt;</span> python physical_node_labeling.py
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>BASE_DIR is defined and set in <a href="/hpe-solutions-openshift/46-synergy/Solution-Deployment/Preparing-execution-environment.html#installer-machine">installer
machine</a>
section of deployment guide.</p></div> <ul><li><p>Next, the user will be prompted to enter the Ansible vault
password or key. This credential is the default &quot;Ansible vault&quot;
password.</p></li> <li><p>$ Enter key for encrypted variables:</p></li> <li><p>Output of above command will prompt following options</p> <div class="language- extra-class"><pre class="language-text"><code>1: Get the physical worker node details that user wishes to configure.
2: Get current health status of the physical worker node
3: Get security parameters of the physical worker node
4: Label the physical worker with health status
5: Label the physical worker with security status
6: Custom labels
7: Display current labels on the node
8: Quit
$Enter the choice number:
​```

</code></pre></div></li> <li><p>Next, the user will be prompted to enter the Ansible vault
password or key. This credential is the default &quot;Ansible vault&quot;
password.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> Enter key <span class="token keyword">for</span> encrypted variables:
</code></pre></div></li> <li><p>If user selects option 1, then they will see all the information
available within the hosts.json file</p></li> <li><p>If user selects option 2, then aggregated health status of the
physical worker nodes will be shown to the user as:</p> <div class="language- extra-class"><pre class="language-text"><code>{'worker1.newocs.twentynet.local': 'OK', 'worker2.newocs.twentynet.local': 'OK'}
</code></pre></div></li> <li><p>If user selects option 3, then this playbook will show the
aggregated security status of the physical worker node as:</p> <div class="language- extra-class"><pre class="language-text"><code>{'worker1.newocs.twentynet.local': 'OK', 'worker2.newocs.twentynet.local': 'Degraded'}
</code></pre></div></li> <li><p>If user selects option 4, then the physical worker node will be
labelled with its respective &quot;aggregated health status&quot; as given
by option 2:</p> <div class="language- extra-class"><pre class="language-text"><code>worker1.newocs.twentynet.local
NAME                             STATUS   ROLES    AGE   VERSION   LABELS
worker1.newocs.twentynet.local   Ready    worker   64d   v1.17.1   app=sysdig-agent,beta.kubernetes.io/arch=amd64,betkubernetes.io/os=linux,health=OK,kubernetes.io/arch=amd64,kubernetes.io/hostname=worker1.newocs.twentynet.locakubernetes.io/os=linux,node-role.kubernetes.io/worker=,node.openshift.io/os_id=rhcos
Verified - Label  health=OK is added to the node worker1.newocs.twentynet.local

worker2.newocs.twentynet.local
NAME                             STATUS   ROLES    AGE   VERSION   LABELS
worker2.newocs.twentynet.local   Ready    worker   64d   v1.17.1   app=sysdig-agent,beta.kubernetes.io/arch=amd64,betkubernetes.io/os=linux,health=OK,kubernetes.io/arch=amd64,kubernetes.io/hostname=worker2.newocs.twentynet.local,kuberneteio/os=linux,node-role.kubernetes.io/worker=,node.openshift.io/os_id=rhcoreplace_with_desired_label_key=replace_with_desired_label_value,security=Degraded
Verified - Label  health=OK is added to the node worker2.newocs.twentynet.local
</code></pre></div></li> <li><p>If user selects option 5, then the physical worker node will be
labelled with its respective &quot;aggregated security status&quot; as
given by option 3:</p> <div class="language- extra-class"><pre class="language-text"><code>NAME                             STATUS   ROLES    AGE   VERSION   LABELS
worker1.newocs.twentynet.local   Ready    worker   64d   v1.17.1   app=sysdig-agent,beta.kubernetes.io/arch=amd64,betakubernetes.io/os=linux,health=OK,kubernetes.io/arch=amd64,kubernetes.io/hostname=worker1.newocs.twentynet.local,kubernetesio/os=linux,node-role.kubernetes.io/worker=,node.openshift.io/os_id=rhcos,security=OK
Verified - Label  security=OK is added to the node worker1.newocs.twentynet.local

NAME                             STATUS   ROLES    AGE   VERSION   LABELS
worker2.newocs.twentynet.local   Ready    worker   64d   v1.17.1   app=sysdig-agent,beta.kubernetes.io/arch=amd64,betakubernetes.io/os=linux,health=OK,kubernetes.io/arch=amd64,kubernetes.io/hostname=worker2.newocs.twentynet.local,kubernetesio/os=linux,node-role.kubernetes.io/worker=,node.openshift.io/os_id=rhcosreplace_with_desired_label_key=replace_with_desired_label_value,security=Degraded
Verified - Label  security=Degraded is added to the node    worker2.newocs.twentynet.local
</code></pre></div></li> <li><p>If user selects option 6, then the physical worker node will be
labelled with the custom labels defined by user in the
hosts.json file</p></li></ul></li></ul> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Custom labels will be applied on if user has selected &quot;yes&quot; or &quot;no&quot; in the json file for &quot;custom_labels.</p> <ul><li><p>&quot;If user selects option 7, then all the labels like security,
health and custom labels along with default labels for each of
the physical worker node will be shown.</p></li> <li><p>If user selects option 8, Node labeling utility will exit.</p></li></ul></div> <h2 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h2> <p>This document contains details of integration of HPE OneView with
Prometheus operator on an existing Red Hat OpenShift Container Platform
4.6.</p> <h3 id="hpe-oneview-syslog-library"><a href="#hpe-oneview-syslog-library" class="header-anchor">#</a> HPE OneView Syslog library</h3> <p>The HPE OneView syslog generator repo helps in getting the alerts of HPE
OneView alerts into a syslog. This is a python- based solution and uses
HPE OneView APIs (REST and Message queues (SCMB)) to get the alerts and
stats that converts into syslog. This syslog can be forwarded and
consumed by log- readable monitoring solutions in Prometheus.</p> <p>The library is a config driver, which allows user to filter the alerts
based on severity and hardware resources.</p> <p>Primarily, this library generates syslog for the following:</p> <ul><li>Events generated from HPE OneView.</li> <li>Interconnect statistics (Port transmit/Receive/Speed/Model).</li> <li>Enclosure statistics (Temperature/Power).</li> <li>Server statistics (Temperature/Power/CPU frequency/CPU utilization).</li> <li>Remote support ticket information.</li></ul> <h3 id="prerequisites-for-syslog-library"><a href="#prerequisites-for-syslog-library" class="header-anchor">#</a> Prerequisites for Syslog library</h3> <ul><li>Availability of the latest OpenShift Container Platform 4.6 cluster.</li> <li>Creation of host path &quot;/mnt/oneview-syslog-lib&quot; in all worker nodes.</li> <li>Install helm chat in OpenShift.</li></ul> <h2 id="deploying-hpe-oneview-syslog-pod-on-an-existing-pod-with-red-hat-openshift-container-platform"><a href="#deploying-hpe-oneview-syslog-pod-on-an-existing-pod-with-red-hat-openshift-container-platform" class="header-anchor">#</a> Deploying HPE OneView Syslog pod on an existing pod with Red Hat OpenShift Container Platform</h2> <ul><li><p>Download HPE OneView syslog packages from the following GitHub link.
<a href="https://github.hpe.com/GSE/ov-prometheus-grafana/tree/master/oneview_syslog_lib" target="_blank" rel="noopener noreferrer">https://github.hpe.com/GSE/ov-prometheus-grafana/tree/master/oneview_syslog_lib<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>Use the following base64 command to generate an encoded password for
HPE OneView.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">printf</span> <span class="token string">'%s'</span> Password' <span class="token operator">|</span> base64
</code></pre></div></li> <li><p>Update HPE OneView IP address, username and the encoded password in
&quot;/<strong>oneview_syslog_lib /config.json</strong>&quot; and update the same details
in
&quot;/<strong>oneview_syslog_lib/helm/log-generator/templates/config-map.yaml</strong>&quot;.
This is done in accordance with the needs of the customer.</p></li></ul> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Use step 4 and step 5 to create your own Docker images.</p></div> <ul><li><p>Build your own docker image using Docker file as shown and push images to your Docker Hub.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">cd</span> to oneview_syslog_lib

<span class="token operator">&gt;</span> docker build -t <span class="token operator">&lt;</span>org<span class="token operator">&gt;</span>/oneview-syslog-lib:<span class="token operator">&lt;</span>tag<span class="token operator">&gt;</span>.

<span class="token operator">&gt;</span> <span class="token builtin class-name">cd</span> to grok_exporter

<span class="token operator">&gt;</span> docker build -t <span class="token operator">&lt;</span>org name<span class="token operator">&gt;</span>/grok-exporter:<span class="token operator">&lt;</span>tag<span class="token operator">&gt;</span>.

</code></pre></div></li> <li><p>Update both HPE OneView-syslog-lib and grok-exporter docker images
on deployment.yaml in container section.</p> <div class="language- extra-class"><pre class="language-text"><code>containers:

  - name: oneview-syslog-lib

    image: &quot;John/oneview-syslog-lib:v10.0&quot;

containers:

  - name: oneview-grok-exporter

    image: &quot;John/grok-exporter:v2.0&quot;
</code></pre></div></li> <li><p>From OpenShift CLI, login to <strong>default</strong> project.</p></li> <li><p>Create Persistent volume (PV) and Persistent Volume Claim (PVC) and
verify whether both of them are bounded properly.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> oc create -f ov-syslog-pv.yaml

<span class="token operator">&gt;</span> oc create -f ov-syslog-pvc.yaml
</code></pre></div></li> <li><p>Navigate to oneview_syslog_lib and run the following commands.</p></li> <li><p>helm install helm/log-generator</p></li> <li><p>Verify the status of HPE OneView-syslog-lib pod. Below snapshot
shows the output after the helm install HPE OneView-syslog-lib pod
status.
<img src="data:image/png;base64,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" alt=""></p> <p><strong>Figure 109.</strong> HPE OneView-syslog-lib pod output</p></li></ul> <h3 id="installation-of-prometheus-operator-on-an-existing-red-hat-openshift-container-platform"><a href="#installation-of-prometheus-operator-on-an-existing-red-hat-openshift-container-platform" class="header-anchor">#</a> Installation of Prometheus operator on an existing Red Hat OpenShift Container Platform</h3> <ol><li><p>Logon to the Red Hat OpenShift Container Platform web console.</p></li> <li><p>Click <strong>Operators</strong>→ <strong>OperatorHub</strong>.</p></li> <li><p>Search for <strong>Prometheus Operator</strong> from the list of operators and
click it.</p></li> <li><p>On the Prometheus Operator page, click install.</p></li> <li><p>On the Create Operator Subscription page, select namespace as
<strong>default</strong> in Installation Mode, Update Channel and Approval
Strategy options. Below snapshot shows the output of Prometheus
operator install process.</p> <p><img src="/hpe-solutions-openshift/46-synergy/assets/img/Figure110.daffb774.png" alt=""> <strong>Figure 110</strong> Prometheus Operator
install process</p></li> <li><p>Click <strong>Subscribe</strong>. The Installed Operators page is displayed with
the status of the operator. Below snapshot shows the output of
Prometheus operator status.
<img src="/hpe-solutions-openshift/46-synergy/assets/img/Figure111.d7ed7d24.png" alt=""></p> <p><strong>Figure 111.</strong> Prometheus Operator install status</p></li></ol> <h3 id="integration-of-oneview-syslog-pod-with-prometheus-on-an-existing-red-hat-openshift-container-platform"><a href="#integration-of-oneview-syslog-pod-with-prometheus-on-an-existing-red-hat-openshift-container-platform" class="header-anchor">#</a> Integration of OneView syslog pod with Prometheus on an existing Red Hat OpenShift Container Platform</h3> <ol><li><p>Click Operators → Installed Operators from the left pane of the
OpenShift Web Console to view the installed operators.</p></li> <li><p>On the Installed Operator page, select <strong>Prometheus Operator</strong> from
the Project drop-down list to switch to the <strong>default</strong> project.</p></li> <li><p>Click <strong>Prometheus Operator</strong>.</p></li> <li><p>On the Prometheus Operator page, scroll right and go to Prometheus.
Click <strong>Create Prometheus</strong>. Below snapshot shows the output for
Prometheus service.</p> <p><img src="/hpe-solutions-openshift/46-synergy/assets/img/Figure112.9c50e893.png" alt=""></p> <p><strong>Figure 112.</strong> Prometheus service</p></li> <li><p>After clicking <strong>Create Prometheus</strong>, YAML file will be displayed.
Click <strong>Create</strong>. Below snapshot shows the output for Prometheus
service YAML.</p> <p><img src="/hpe-solutions-openshift/46-synergy/assets/img/Figure113.830c6cfe.png" alt=""></p> <p><strong>Figure 113.</strong>. Prometheus service YAML</p></li> <li><p>On the <strong>Prometheus Operator</strong> page, scroll right and go to Service
Monitor. Click <strong>Create Service Monitor</strong>. Below snapshot shows the
output of Create Service Monitor.</p> <p><img src="/hpe-solutions-openshift/46-synergy/assets/img/Figure114.4f59501e.png" alt=""></p> <p><strong>Figure 114</strong>. Create Service Monitor</p></li> <li><p>After clicking <strong>Create Service Monitor</strong>, YAML file will be
displayed and then change the required values in matchLabels section
as <strong>app: log-generator</strong> , <strong>port: http</strong>, and <strong>interval: 10s</strong>.</p> <p>Below snapshot shows the output for Create Service Monitor YAML.
<img src="/hpe-solutions-openshift/46-synergy/assets/img/Figure115.ef1b5245.png" alt=""></p> <p><strong>Figure 115.</strong>. Service Monitor YAML</p></li> <li><p>On the console page, navigate to <strong>Networking</strong> option. Click
<strong>Routes</strong> option to open the Create Route page for <strong>Prometheus</strong>.
Enter details for <strong>Name</strong> and <strong>Services</strong>. Select the Prometheus
operator. Select the <strong>Target Port</strong> as 9090. Click <strong>Create</strong> to
generate the Prometheus URL.</p> <p>Below snapshot shows the output for Create Prometheus operator URL.
<img src="/hpe-solutions-openshift/46-synergy/assets/img/Figure116.3e23a797.png" alt=""><br> <strong>Figure 116</strong>. Create Prometheus operator URL</p></li> <li><p>On the Routes page, navigate to Location. Click Prometheus URL to
open Prometheus dashboard.</p> <p>Below snapshot shows the output for Click Prometheus URL to open
Prometheus dashboard .
<img src="/hpe-solutions-openshift/46-synergy/assets/img/Figure117.7f6e1b5d.png" alt=""> <strong>Figure 117.</strong> Link for Prometheus operator URL dashboard</p> <p>Below snapshot shows the output of window Prometheus operator
dashboard .
<img src="/hpe-solutions-openshift/46-synergy/assets/img/Figure118.29f601e4.png" alt=""> <strong>Figure 118</strong> Prometheus operator dashboard status</p></li></ol> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Time difference between the browser and the server is expressed in
seconds. Prometheus relies on accurate time and time drift might cause
unexpected query results.</p></div> <ol start="10"><li><p>On the Prometheus dashboard, select ov_all_critical_messages from
the drop-down list and click <strong>Execute</strong>. Below figure shows the
output of checking HP OV(OneView) events in Prometheus operator
dashboard.
Below snapshot HPE OneView events in Prometheus operator dashboard
<img src="/hpe-solutions-openshift/46-synergy/assets/img/Figure119.96393284.png" alt=""></p></li> <li><p>Click the Graph option to see the graphical view. Below figure shows
the output of HPE OneView events in graphical view on Prometheus
operator dashboard.
<img src="/hpe-solutions-openshift/46-synergy/assets/img/Figure120.06c6bfa3.png" alt=""></p> <p><strong>Figure 120.</strong> HPE OneView events in graphical view on Prometheus
operator dashboard</p></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Sysdig-Secure.html" class="prev">
        Securing Red Hat OpenShift Container Platform using Sysdig Secure and Sysdig Monitor
      </a></span> <span class="next"><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Advanced-Cluster-Management.html">
        Red Hat Advanced Cluster Management for Kubernetes
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/hpe-solutions-openshift/46-synergy/assets/js/app.8d09024b.js" defer></script><script src="/hpe-solutions-openshift/46-synergy/assets/js/2.117ef8fd.js" defer></script><script src="/hpe-solutions-openshift/46-synergy/assets/js/6.b3a62cb0.js" defer></script>
  </body>
</html>
