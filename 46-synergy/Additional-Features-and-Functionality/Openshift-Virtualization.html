<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OpenShift Virtualization | OpenShift Container Platform 4.4 on Synergy</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Hewlett Packard Enterprise">
    
    <link rel="preload" href="/hpe-solutions-openshift/46-synergy/assets/css/0.styles.bfdf2f8a.css" as="style"><link rel="preload" href="/hpe-solutions-openshift/46-synergy/assets/js/app.8d09024b.js" as="script"><link rel="preload" href="/hpe-solutions-openshift/46-synergy/assets/js/2.117ef8fd.js" as="script"><link rel="preload" href="/hpe-solutions-openshift/46-synergy/assets/js/12.c2b1bda3.js" as="script"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/10.f2647a7a.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/11.eb22f408.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/13.b2721807.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/14.fbb5bfdd.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/15.076cb55f.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/16.086f907f.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/17.5044d63c.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/18.0138d6da.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/19.577c768d.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/20.5dab068a.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/21.ea4d33a2.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/22.23d6a92d.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/23.329f64c2.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/24.bad0d82d.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/25.2a05a77a.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/26.05687ea8.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/27.5f97f9ba.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/28.9f8648b2.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/29.ffe26d0e.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/3.643f6564.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/30.b6d944bc.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/31.b0b75d1f.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/32.4d1ff1fb.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/33.da67f8dd.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/34.78fab925.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/35.5e384204.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/36.53dec668.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/37.e773d372.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/4.7110e26d.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/5.8d6b47a1.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/6.b3a62cb0.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/7.a921eaba.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/8.8b92de32.js"><link rel="prefetch" href="/hpe-solutions-openshift/46-synergy/assets/js/9.7e00b22b.js">
    <link rel="stylesheet" href="/hpe-solutions-openshift/46-synergy/assets/css/0.styles.bfdf2f8a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hpe-solutions-openshift/46-synergy/" class="home-link router-link-active"><!----> <span class="site-name">OpenShift Container Platform 4.4 on Synergy</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hpe-solutions-openshift/46-synergy/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/hpe-solutions-openshift/46-synergy/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Red Hat OpenShift Container Platform 4 on HPE Synergy</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Overview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Components</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Deployment</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Additional Features and Functionality</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Storage.html" class="sidebar-link">Storage</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/IPI-Installation.html" class="sidebar-link">IPI deployment of OCP on Bare Metal</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Air-gap-Installation.html" class="sidebar-link">Red Hat OpenShift Container Platform installation in the restricted network environment</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/OpenShift-operators.html" class="sidebar-link">OpenShift operators</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Integration-with-Prometheus.html" class="sidebar-link">Integration of HPE OneView with Prometheus</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Sysdig-Secure.html" class="sidebar-link">Securing Red Hat OpenShift Container Platform using Sysdig Secure and Sysdig Monitor</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Physical-worker-node-labeling.html" class="sidebar-link">Physical worker node labeling in Red Hat OpenShift cluster</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Advanced-Cluster-Management.html" class="sidebar-link">Red Hat Advanced Cluster Management for Kubernetes</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Install-and-Configure-Velero.html" class="sidebar-link">Install and Configure Velero</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Ceph-Storage-Setup-ExternalMode.html" class="sidebar-link">Red Hat Ceph Storage 4 Setup in External mode with OCS Integration</a></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Openshift-Virtualization.html" aria-current="page" class="active sidebar-link">OpenShift Virtualization</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Openshift-Virtualization.html#enabling-openshift-virtualization" class="sidebar-link">Enabling OpenShift Virtualization</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Openshift-Virtualization.html#prerequisites" class="sidebar-link">Prerequisites</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Openshift-Virtualization.html#installing-openshift-virtualization-using-the-web-console" class="sidebar-link">Installing OpenShift Virtualization using the web console</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Openshift-Virtualization.html#deploying-openshift-virtualization" class="sidebar-link">Deploying OpenShift Virtualization</a></li></ul></li><li><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Validating-OCP-Deployment.html" class="sidebar-link">Validating OpenShift Container Platform deployment</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Resosurces and Additional Links</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="openshift-virtualization"><a href="#openshift-virtualization" class="header-anchor">#</a> OpenShift Virtualization</h1> <p>The new paradigm shift in application development is moving to
containers, and increasingly serverless as well, however existing
investment in applications that run as virtual machines in many
organizations poses management challenges. Many of the existing virtual
machines (VMs) provide vital services to new and existing containerized
applications at times are not good candidates for containerization.
OpenShift Virtualization also referred to as container-native
virtualization lets developers bring virtual machines (VMs) into
containerized workflows by running a virtual machine within a container
where they can develop, manage, and deploy virtual machines side-by-side
with containers and serverless all in one platform. This is a built-in
feature of OpenShift Container Platform, OpenShift Virtualization
combines two technologies of virtualization and containerization into a
single management platform so organizations take advantage of the
simplicity and speed of containers and Kubernetes while still benefiting
from the applications and services that have been architected for
virtual machines.</p> <p><img src="/hpe-solutions-openshift/46-synergy/assets/img/Figure156.b34a08ad.png" alt=""></p> <p><strong>Figure 156.</strong> OpenShift virtualization overview layout</p> <p>OpenShift Virtualization adds new objects into your OpenShift Container
Platform cluster via Kubernetes custom resources to enable
virtualization tasks. These tasks include:</p> <ul><li><p>Creating and managing Linux and Windows virtual machines</p></li> <li><p>Connecting to virtual machines through a variety of consoles and CLI
tools</p></li> <li><p>Importing and cloning existing virtual machines</p></li> <li><p>Managing network interface controllers and storage disks attached to
virtual machines</p></li> <li><p>Live migrating virtual machines between nodes</p></li> <li><p>An enhanced web console provides a graphical portal to manage these
virtualized resources alongside the OpenShift Container Platform
cluster containers and infrastructure.</p></li> <li><p>OpenShift Virtualization is tested with OpenShift Container Storage
(OCS) and designed to use with OCS features for the best experience.</p></li> <li><p>OpenShift Virtualization allows the usage with either the
<a href="https://docs.openshift.com/container-platform/4.6/networking/ovn_kubernetes_network_provider/about-ovn-kubernetes.html#about-ovn-kubernetes" target="_blank" rel="noopener noreferrer">OVN-Kubernetes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
or the
<a href="https://docs.openshift.com/container-platform/4.6/networking/openshift_sdn/about-openshift-sdn.html#about-openshift-sdn" target="_blank" rel="noopener noreferrer">OpenShiftSDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
default Container Network Interface (CNI) network provider.</p></li></ul> <h2 id="enabling-openshift-virtualization"><a href="#enabling-openshift-virtualization" class="header-anchor">#</a> Enabling OpenShift Virtualization</h2> <p><img src="/hpe-solutions-openshift/46-synergy/assets/img/Figure157.dbfaf152.png" alt=""></p> <p><strong>Figure 157.</strong> OpenShift Virtualization setup overview</p> <p>OpenShift Virtualization adds the ability to easily create and manage
traditional virtual machines inside of OpenShift alongside standard
container workloads. Its deep integration into the OpenShift UI makes
the first steps very easy and intuitive.</p> <h2 id="prerequisites"><a href="#prerequisites" class="header-anchor">#</a> Prerequisites</h2> <ol><li><p>OpenShift Container Platform 4.6 must be successfully deployed, and
console should be accessible.</p></li> <li><p>Install <strong>OpenShift Container Storage</strong> on your cluster.</p></li> <li><p>Create network interface configuration on worker nodes: To Access VM
from your datacentre, you need to create bridge network on worker
nodes and attach it to NetworkAttachmentDefinition.</p></li> <li><p>Create any Webserver: To create VM we need source images in this
format <strong>.iso,.img, .qcow2 or raw.</strong> So, we upload images in
webserver.</p></li></ol> <h2 id="installing-openshift-virtualization-using-the-web-console"><a href="#installing-openshift-virtualization-using-the-web-console" class="header-anchor">#</a> Installing OpenShift Virtualization using the web console</h2> <p>Install OpenShift Virtualization to add virtualization functionality to
your OpenShift Container Platform cluster.</p> <p>You can use the OpenShift Container Platform 4.6 <a href="https://docs.openshift.com/container-platform/4.6/web_console/web-console.html#web-console-overview_web-console" target="_blank" rel="noopener noreferrer">web
console<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
to subscribe to and deploy the OpenShift Virtualization Operators.</p> <p>OpenShift Virtualization 2.4 is supported for use on OpenShift Container
Platform 4.6 clusters</p> <h3 id="subscribing-to-the-openshift-virtualization-catalog"><a href="#subscribing-to-the-openshift-virtualization-catalog" class="header-anchor">#</a> Subscribing to the OpenShift Virtualization catalog</h3> <p>Before you install OpenShift Virtualization, subscribe to the
<strong>OpenShift Virtualization</strong> catalog from the OpenShift Container
Platform web console. Subscribing gives the openshift-cnv namespace
access to the OpenShift Virtualization Operators.</p> <h3 id="procedure"><a href="#procedure" class="header-anchor">#</a> Procedure</h3> <ol><li><p>Open a browser window and log in to the OpenShift Container Platform
web console.</p></li> <li><p>Navigate to the <strong>Operators → OperatorHub</strong> page.</p></li> <li><p>Search for <strong>OpenShift Virtualization</strong> and then select it.</p></li> <li><p>Click <strong>Install.</strong></p></li> <li><p>On the <strong>Install Operator</strong> page:</p> <ul><li>For <strong>Installed Namespace,</strong> ensure that the <strong>Operator
recommended namespace</strong> option is selected. This installs the
Operator in the mandatory openshift-cnv namespace.</li></ul> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Attempting to install the OpenShift Virtualization Operator in a
namespace other than openshift-cnv causes the installation to fail.</p></div> <ul><li><p>Select <strong>2.4</strong> from the list of available <strong>Update Channel</strong>
options.</p></li> <li><p>For <strong>Approval Strategy</strong>, select <strong>Automatic ,</strong> which is the
default value selected. OpenShift Virtualization automatically
updates when a new z-stream release is available.</p></li></ul></li> <li><p>Click <strong>Install</strong> to make the Operator available to the
openshift-cnv namespace.</p></li></ol> <p>On the <strong>Installed Operators</strong> screen, the <strong>Status</strong> displays
<strong>Succeeded</strong> when OpenShift Virtualization finishes installation.</p> <p><img src="/hpe-solutions-openshift/46-synergy/assets/img/Figure158.d03dd2fa.png" alt=""></p> <h2 id="deploying-openshift-virtualization"><a href="#deploying-openshift-virtualization" class="header-anchor">#</a> Deploying OpenShift Virtualization</h2> <p>After subscribing to the <strong>OpenShift Virtualization</strong> catalog, create
the <strong>OpenShift Virtualization Operator Deployment</strong> custom resource to
deploy OpenShift Virtualization.</p> <h3 id="prerequisites-2"><a href="#prerequisites-2" class="header-anchor">#</a> Prerequisites</h3> <ul><li>Subscribe to the <strong>OpenShift Virtualization</strong> catalog in the
openshift-cnv namespace.</li></ul> <h3 id="procedure-2"><a href="#procedure-2" class="header-anchor">#</a> Procedure</h3> <ol><li><p>Navigate to the <strong>Operators → Installed Operators</strong> page.</p></li> <li><p>Click <strong>OpenShift Virtualization.</strong></p></li> <li><p>Click the <strong>OpenShift Virtualization Operator Deployment</strong> tab and
click <strong>Create HyperConverged Cluster.</strong></p></li> <li><p>Click <strong>Create</strong> to launch OpenShift Virtualization.</p></li></ol> <p><img src="/hpe-solutions-openshift/46-synergy/assets/img/Figure159.6dc83f9f.png" alt=""></p> <ol start="5"><li>Navigate to the <strong>Workloads → Pods</strong> page and monitor the
OpenShift Virtualization Pods until they are all <strong>Running.</strong> After
all the Pods display the <strong>Running</strong> state, you can access OpenShift
Virtualization.</li></ol> <h3 id="create-network-interface-configuration-on-worker-nodes"><a href="#create-network-interface-configuration-on-worker-nodes" class="header-anchor">#</a> Create network interface configuration on worker nodes</h3> <p>Apply NodeNetworkConfigurationPolicy to create the node network
configuration. This includes addition or removal of interfaces from the
node.</p> <h4 id="adding-an-interface-on-nodes"><a href="#adding-an-interface-on-nodes" class="header-anchor">#</a> Adding an interface on nodes</h4> <p>Add an interface on nodes in the cluster by applying a
NodeNetworkConfigurationPolicy manifest.</p> <h4 id="procedure-to-add-interface"><a href="#procedure-to-add-interface" class="header-anchor">#</a> Procedure to add interface</h4> <ol><li>Create the NodeNetworkConfigurationPolicy manifest. The following
example configures a Linux bridge on all worker nodes:</li></ol> <p>Create <strong>br1-ens3f0-policy-worker.yaml</strong> file is depicted as
follows.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> nmstate.io/v1alpha1

<span class="token key atrule">kind</span><span class="token punctuation">:</span> NodeNetworkConfigurationPolicy

<span class="token key atrule">metadata</span><span class="token punctuation">:</span>

  <span class="token key atrule">name</span><span class="token punctuation">:</span> &lt;br1<span class="token punctuation">-</span>eth1<span class="token punctuation">-</span>policy<span class="token punctuation">&gt;</span> <span class="token comment">#Name of the Policy.</span>

<span class="token key atrule">spec</span><span class="token punctuation">:</span>

  <span class="token key atrule">nodeSelector</span><span class="token punctuation">:</span>

    <span class="token key atrule">node-role.kubernetes.io/worker</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span> <span class="token comment">#If you do not include the nodeSelector, the Policy applies to all nodes in the cluster.</span>

  <span class="token key atrule">desiredState</span><span class="token punctuation">:</span>

    <span class="token key atrule">interfaces</span><span class="token punctuation">:</span>

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> br1

        <span class="token key atrule">description</span><span class="token punctuation">:</span> Linux bridge with ens3f0 as a port

        <span class="token key atrule">type</span><span class="token punctuation">:</span> linux<span class="token punctuation">-</span>bridge

        <span class="token key atrule">state</span><span class="token punctuation">:</span> up

        <span class="token key atrule">ipv4</span><span class="token punctuation">:</span>

          <span class="token key atrule">dhcp</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>

          <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>

        <span class="token key atrule">bridge</span><span class="token punctuation">:</span>

          <span class="token key atrule">options</span><span class="token punctuation">:</span>

            <span class="token key atrule">stp</span><span class="token punctuation">:</span>

              <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>

        <span class="token key atrule">port</span><span class="token punctuation">:</span>

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> ens3f0 <span class="token comment"># worker nodes interface</span>
</code></pre></div><ol start="2"><li>Use the following command to Create the Policy <strong>br1-ens3f0-policy-worker.yaml</strong>:</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> oc create -f br1-ens3f0-policy-worker.yaml
</code></pre></div><ol start="3"><li>After a policy is applied to the worker nodes, the status is
<strong>SuccessfullyConfigured</strong>. To verify this, use the nncp and nnce
commands. Execution of these commands lists all the policies and their
status.</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> oc get nncp

<span class="token operator">&gt;</span> oc get nnce
</code></pre></div><p><img src="/hpe-solutions-openshift/46-synergy/assets/img/Figure160.00c2d43e.png" alt=""></p> <h4 id="creating-a-networkattachmentdefinition"><a href="#creating-a-networkattachmentdefinition" class="header-anchor">#</a> Creating a NetworkAttachmentDefinition</h4> <p>Container-native virtualization provide layer-2 networking capabilities
that you to connect virtual machines to multiple network. You can import
virtual machines with existing workloads that depends on access to
multiple interface.</p> <h4 id="creating-a-linux-bridge-networkattachmentdefinition-in-the-web-console"><a href="#creating-a-linux-bridge-networkattachmentdefinition-in-the-web-console" class="header-anchor">#</a> Creating a Linux bridge NetworkAttachmentDefinition in the web console</h4> <p>The NetworkAttachmentDefinition is a custom resource that exposes
layer-2 devices to a specific namespace in your container-native
virtualization cluster.</p> <p>Network administrators can create NetworkAttachmentDefinitions to
provide existing layer-2 networking to Pods and virtual machines.</p> <div class="custom-block warning"><p class="custom-block-title">PREREQUISITES</p> <ul><li><p>Container-native virtualization 2.2 or above installed on your
cluster.</p></li> <li><p>A Linux bridge must be configured and attached to the correct
Network Interface Card (NIC) on every worker node.</p></li></ul></div> <h4 id="procedure-3"><a href="#procedure-3" class="header-anchor">#</a> Procedure</h4> <ol><li><p>In the web console, click Networking <strong>→</strong> Network Attachment
Definitions**.**</p></li> <li><p>Click <strong>Create Network Attachment Definition</strong>.</p></li> <li><p>Enter a unique <strong>Name</strong> and optional <strong>Description.</strong></p></li> <li><p>Click the <strong>Network Type</strong> list and select <strong>CNV Linux bridge.</strong></p></li> <li><p>Enter the name of the bridge (Previously created
<strong>NodeNetworkConfigurationPolicy</strong> object as interfaces name ex:
<strong>br1</strong>) in the <strong>Bridge Name</strong> field.</p></li> <li><p>Click <strong>Create.</strong></p></li></ol> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>If the resource has VLAN IDs configured, enter the ID numbers in the
<strong>VLAN Tag Number</strong> field. This step optional.</p></div> <h3 id="creating-virtual-machines"><a href="#creating-virtual-machines" class="header-anchor">#</a> Creating virtual machines</h3> <p>Use one of these procedures to create a virtual machine:</p> <ul><li><p>Running the virtual machine wizard</p></li> <li><p>Pasting a pre-configured YAML file with the virtual machine wizard</p></li> <li><p>Using the CLI</p></li> <li><p><a href="https://docs.openshift.com/container-platform/4.6/virt/virtual_machines/importing_vms/virt-importing-vmware-vm.html#virt-importing-vmware-vm" target="_blank" rel="noopener noreferrer">Importing a VMware virtual machine or template with the virtual
machine
wizard<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul> <div class="custom-block tip"><p class="custom-block-title">NOTE</p> <p>Do not create virtual machines in openshift-* namespaces. Instead,
create a new namespace or use an existing namespace without the
openshift prefix.</p></div> <h3 id="running-the-virtual-machine-wizard-to-create-a-virtual-machine"><a href="#running-the-virtual-machine-wizard-to-create-a-virtual-machine" class="header-anchor">#</a> Running the virtual machine wizard to create a virtual machine</h3> <p>The web console features an interactive wizard that guides you through
<strong>General</strong>, <strong>Networking</strong>, <strong>Storage</strong>, <strong>Advanced</strong>, and <strong>Review</strong>
steps to simplify the process of creating virtual machines. All required
fields are marked by a *. When the required fields are completed, you
can review and create your virtual machine.</p> <p>Network Interface Cards (NICs) and storage disks can be created and
attached to virtual machines after they have been created.</p> <h4 id="bootable-disk"><a href="#bootable-disk" class="header-anchor">#</a> Bootable Disk</h4> <p>If either URL or Container are selected as the <strong>Source</strong> in the
<strong>General</strong> tab, a rootdisk disk is created and attached to the virtual
machine as the <strong>Bootable Disk.</strong> You can modify the rootdisk but you
cannot remove it.</p> <p>A <strong>Bootable Disk</strong> is not required for virtual machines provisioned
from a <strong>PXE</strong> source if there are no disks attached to the virtual
machine. If one or more disks are attached to the virtual machine, you
must select one as the <strong>Bootable Disk.</strong></p> <div class="custom-block warning"><p class="custom-block-title">PREREQUISITES</p> <p>When you create your virtual machine using the wizard, your virtual
machine's storage medium must support Read-Write-Many (RWX) PVCs.</p></div> <h4 id="procedure-4"><a href="#procedure-4" class="header-anchor">#</a> Procedure</h4> <ol><li><p>Click <strong>Workloads</strong> → <strong>Virtualization</strong> from the side menu.</p></li> <li><p>Click the <strong>Virtual Machines</strong> tab.</p></li> <li><p>Click <strong>Create Virtual Machine</strong> and select <strong>New with Wizard.</strong></p></li> <li><p>Fill in all required fields in the <strong>General</strong> tab.</p> <ul><li><p>Provide VM name.</p></li> <li><p>Select Operating system.</p></li> <li><p>Select Source of image and click any of these options PXE, URL,
Container and Disk.</p></li> <li><p>Select flavour as per requirement.</p></li> <li><p>Select Workload Profile like desktop, server and high
performance.</p></li></ul></li></ol> <p><img src="/hpe-solutions-openshift/46-synergy/assets/img/Figure161.5ece6663.png" alt=""></p> <ol start="5"><li><p>Click <strong>Next</strong> to progress to the <strong>Networking</strong> step. A nic0 NIC is
attached by default using pod network.To access virtual machine from
your datacentre, remove default pod network and assign previously
created bridge network to virtual machine.</p> <ul><li><p>(Optional) Click <strong>Add Network Interface</strong> to create additional
NICs.</p></li> <li><p>(Optional) You can remove any or all NICs by clicking the
Options menu and selecting <strong>Delete.</strong> A virtual machine does
not need a NIC attached to be created. NICs can be created after
the virtual machine has been created.</p></li></ul></li> <li><p>Click <strong>Next</strong> to progress to the <strong>Storage</strong> screen.</p> <ul><li><p>(Optional) Click <strong>Add Disk</strong> to create additional disks. These
disks can be removed by clicking the Options menu and selecting
<strong>Delete.</strong></p></li> <li><p>(Optional) Click the Options menu to edit the disk and save your
changes.</p></li></ul></li> <li><p>Click <strong>Review and Create.</strong> The <strong>Results</strong> screen displays the
JSON configuration file for the virtual machine.</p></li></ol> <p>The virtual machine is listed in the <strong>Virtual Machines</strong> tab.</p> <p><img src="/hpe-solutions-openshift/46-synergy/assets/img/Figure162.4c64a0db.png" alt=""></p> <h3 id="pasting-in-a-pre-configured-yaml-file-to-create-a-virtual-machine"><a href="#pasting-in-a-pre-configured-yaml-file-to-create-a-virtual-machine" class="header-anchor">#</a> Pasting in a pre-configured YAML file to create a virtual machine</h3> <p>Create a virtual machine by writing or pasting a YAML configuration
file. A valid example virtual machine configuration is provided by
default whenever you open the YAML edit screen.</p> <p>If your YAML configuration is invalid when you click <strong>Create</strong>, an
error message indicates the parameter in which the error occurs. Only
one error is shown at a time.</p> <p>Navigating away from the YAML screen while editing cancels any changes
to the configuration you have made.</p> <h4 id="procedure-5"><a href="#procedure-5" class="header-anchor">#</a> Procedure</h4> <ol><li><p>Click <strong>Workloads → Virtualization</strong> from the side menu.</p></li> <li><p>Click the <strong>Virtual Machines</strong> tab.</p></li> <li><p>Click <strong>Create Virtual Machine</strong> and select <strong>New from YAML.</strong></p></li> <li><p>Write or paste your virtual machine configuration in the editable
window.</p> <ul><li>Alternatively, use the example virtual machine provided by
default in the YAML screen.</li></ul></li> <li><p>(Optional) Click <strong>Download</strong> to download the YAML configuration
file in its present state.</p></li> <li><p>Click <strong>Create</strong> to create the virtual machine.</p></li></ol> <p>The virtual machine is listed in the <strong>Virtual Machines</strong> tab.</p> <h3 id="using-the-cli-to-create-a-virtual-machine"><a href="#using-the-cli-to-create-a-virtual-machine" class="header-anchor">#</a> Using the CLI to create a virtual machine</h3> <h4 id="procedure-6"><a href="#procedure-6" class="header-anchor">#</a> Procedure</h4> <p>The spec object of the VirtualMachine configuration file references the
virtual machine settings, such as the number of cores and the amount of
memory, the disk type, and the volumes to use.</p> <ol><li><p>Attach the virtual machine disk to the virtual machine by
referencing the relevant PVC claimName as a volume.</p></li> <li><p>To create a virtual machine with the OpenShift Container Platform
client, run this command:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> oc create --f <span class="token operator">&lt;</span>vm.yaml<span class="token operator">&gt;</span>
</code></pre></div></li> <li><p>Since virtual machines are created in a <strong>Stopped</strong> state, run a
virtual machine instance by starting it.</p></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Ceph-Storage-Setup-ExternalMode.html" class="prev">
        Red Hat Ceph Storage 4 Setup in External mode with OCS Integration
      </a></span> <span class="next"><a href="/hpe-solutions-openshift/46-synergy/Additional-Features-and-Functionality/Validating-OCP-Deployment.html">
        Validating OpenShift Container Platform deployment
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/hpe-solutions-openshift/46-synergy/assets/js/app.8d09024b.js" defer></script><script src="/hpe-solutions-openshift/46-synergy/assets/js/2.117ef8fd.js" defer></script><script src="/hpe-solutions-openshift/46-synergy/assets/js/12.c2b1bda3.js" defer></script>
  </body>
</html>
