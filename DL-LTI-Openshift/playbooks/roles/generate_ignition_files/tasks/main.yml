---
  - name: Delete existing dist folder
    file:
      path: "{{ dest_base_path }}/playbooks/roles/generate_ignition_files/ignitions"
      state: absent

  - name: Create Ignition directory
    file:
      path: "{{ dest_base_path }}/playbooks/roles/generate_ignition_files/ignitions"
      state: directory

  - name: install-config file
    ansible.builtin.template:
      src: install-config.conf.j2
      dest: "{{ dest_base_path }}/playbooks/roles/generate_ignition_files/ignitions/install-config.yaml"

  - name: create manifests files
    command: "{{ dest_base_path }}/playbooks/roles/download_ocp_packages/library/openshift_components/openshift-install create manifests --dir={{ dest_base_path }}/playbooks/roles/generate_ignition_files/ignitions"

  - name: create ignition files
    command: "{{ dest_base_path }}/playbooks/roles/download_ocp_packages/library/openshift_components/openshift-install create ignition-configs  --dir={{ dest_base_path }}/playbooks/roles/generate_ignition_files/ignitions"
