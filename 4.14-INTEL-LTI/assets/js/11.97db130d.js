(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{297:function(e,t,s){e.exports=s.p+"assets/img/figure4.080352b0.png"},298:function(e,t,s){e.exports=s.p+"assets/img/f13.da860108.png"},299:function(e,t,s){e.exports=s.p+"assets/img/figure14.d9cc4d61.png"},300:function(e,t,s){e.exports=s.p+"assets/img/f15.959aa058.png"},301:function(e,t,s){e.exports=s.p+"assets/img/f16.a0dd3edf.png"},302:function(e,t,s){e.exports=s.p+"assets/img/f17.d9b68538.png"},303:function(e,t,s){e.exports=s.p+"assets/img/f18.036479ee.png"},304:function(e,t,s){e.exports=s.p+"assets/img/f19.aac7868f.png"},305:function(e,t,s){e.exports=s.p+"assets/img/f20.0698d36d.png"},306:function(e,t,s){e.exports=s.p+"assets/img/f21.0cbd6ea6.png"},307:function(e,t,s){e.exports=s.p+"assets/img/f22.12e184bd.png"},308:function(e,t,s){e.exports=s.p+"assets/img/figure50.608fd383.png"},309:function(e,t,s){e.exports=s.p+"assets/img/figure51.15f0902e.png"},310:function(e,t,s){e.exports=s.p+"assets/img/figure52.edabae41.png"},311:function(e,t,s){e.exports=s.p+"assets/img/figure53.83c41d7b.png"},312:function(e,t,s){e.exports=s.p+"assets/img/figure54.9aa7463b.png"},313:function(e,t,s){e.exports=s.p+"assets/img/figure55.6c2f2dfe.png"},336:function(e,t,s){"use strict";s.r(t);var a=s(14),r=Object(a.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"storage-options"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#storage-options"}},[e._v("#")]),e._v(" Storage Options")]),e._v(" "),t("h2",{attrs:{id:"alletra-nimble-storage"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#alletra-nimble-storage"}},[e._v("#")]),e._v(" Alletra/Nimble Storage")]),e._v(" "),t("h3",{attrs:{id:"hpe-csi-driver-architecture"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hpe-csi-driver-architecture"}},[e._v("#")]),e._v(" HPE CSI Driver Architecture")]),e._v(" "),t("p",[e._v("A diagramatic representation of the HPE CSI driver architecture is illustrated in the figure 10.")]),e._v(" "),t("p",[t("img",{attrs:{src:s(297),alt:""}})]),e._v(" "),t("p",[t("strong",[e._v("Figure 10")]),e._v(": CSI Driver Architecture")]),e._v(" "),t("p",[e._v("The OpenShift Container Platform 4.14 cluster comprises the master and worker nodes (physical and virtual) with CoreOS deployed as the operating system. The iSCSI interface configured on the host nodes establishes the connection with the HPE Alletra array to the cluster. Upon successful deployment of HPE CSI Driver, the CSI controller, CSI Driver, and 3PAR CSP  and Nimble CSP gets deployed which communicates with the HPE Alletra array via REST APIs. The associated features on Storage Class such as CSI Provisioner, CSI Attacher, and others are configured on the Storage Class.")]),e._v(" "),t("h3",{attrs:{id:"deploying-hpe-csi-driver-for-hpe-alletra-storage-on-rhocp-4-14"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deploying-hpe-csi-driver-for-hpe-alletra-storage-on-rhocp-4-14"}},[e._v("#")]),e._v(" Deploying HPE CSI Driver for HPE Alletra storage on RHOCP 4.14")]),e._v(" "),t("p",[e._v("This section describes how to deploy HPE CSI Driver for HPE Alletra storage on an existing RHOCP 4.14.")]),e._v(" "),t("p",[t("strong",[e._v("Prerequisites:")])]),e._v(" "),t("p",[e._v("Before configuring the HPE CSI Driver, the following prerequisites must be met:")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("RHOCP 4.14 must be successfully deployed, and console should be accessible.")])]),e._v(" "),t("li",[t("p",[e._v("iSCSI interface must be configured on the HPE Alletra Storage array. For more information, see the "),t("a",{attrs:{href:"https://hpe.sharepoint.com/:f:/r/sites/msteams_ca9c1f/Shared%20Documents/Storage/Alletra/6K%20%26%205K/MRA_Alletra6K_Release?csf=1&web=1&e=i211EA",target:"_blank",rel:"noopener noreferrer"}},[e._v("Infrastructure Master Reference Architecture based on HPE Alletra 6000"),t("OutboundLink")],1),e._v(".")])]),e._v(" "),t("li",[t("p",[e._v("Additional iSCSI network interfaces must be configured on physical worker nodes.()")])]),e._v(" "),t("li",[t("p",[e._v("Deploy scc.yaml file to enable Security Context Constraints (SCC).")])])]),e._v(" "),t("p",[t("strong",[e._v("Configuring iSCSI interface on worker nodes")])]),e._v(" "),t("p",[e._v("The RHOCP 4.14 cluster comprises the master and physical worker nodes with RHEL 8.8 deployed as the operating system. The iSCSI interface is configured on the host nodes to establish the connection with the HPE Alletra array to the cluster. Apart from the host nodes, additional iSCSI interface needs to be configured on all the worker (physical and virtual) nodes for establishing the connection between the RHOCP cluster and HPE Alletra arrays.")]),e._v(" "),t("p",[e._v("To configure iSCSI interface on physical RHEL worker nodes:")]),e._v(" "),t("ul",[t("li",[e._v("Configure iSCSI A connection as a storage interface and iSCSI B connection as an additional storage for redundancy")])]),e._v(" "),t("p",[e._v("For example, the iSCSI_A and iSCSI_B interface connection is configured on worker1 node, as shown in Figure 11.")]),e._v(" "),t("p",[t("img",{attrs:{src:s(298),alt:""}})]),e._v(" "),t("p",[t("strong",[e._v("FIGURE 11")]),e._v(" iSCSI_A and iSCSI_B interface connection")]),e._v(" "),t("p",[t("strong",[e._v("Creating namespace")])]),e._v(" "),t("p",[e._v("To create a namespace, in this case, hpe-csi:")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Open Red Hat OpenShift Container Platform Console on a supported web browser.")])]),e._v(" "),t("li",[t("p",[e._v("Click Administration â†’ Namespaces on the left pane.")])]),e._v(" "),t("li",[t("p",[e._v("Click Create Namespaces.")])]),e._v(" "),t("li",[t("p",[e._v("On the Create Namespace dialog box, enter hpe-csi.")])]),e._v(" "),t("li",[t("p",[e._v("Click Create.")])])]),e._v(" "),t("p",[t("strong",[e._v("Deploying Security Context Constraints (SCC)")])]),e._v(" "),t("p",[e._v("The HPE CSI Driver needs to run in the privileged mode to get access to the host ports, host network, and to mount the host path volume. Before deploying HPE CSI Driver operator on RHOCP cluster, deploy SCC to allow HPE CSI Driver to run with these privileges.")]),e._v(" "),t("p",[t("strong",[e._v("Prerequisites:")])]),e._v(" "),t("ul",[t("li",[e._v("Ensure that you can access the scc.yaml file from the following GitHub link:")])]),e._v(" "),t("p",[t("a",{attrs:{href:"https://raw.githubusercontent.com/hpe-storage/co-deployments/master/operators/hpe-csi-operator/deploy/scc.yaml",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://raw.githubusercontent.com/hpe-storage/co-deployments/master/operators/hpe-csi-operator/deploy/scc.yaml"),t("OutboundLink")],1)]),e._v(" "),t("p",[e._v("To deploy SCC:")]),e._v(" "),t("ol",[t("li",[e._v("On the installer VM, download scc.yaml file from the "),t("a",{attrs:{href:"https://raw.githubusercontent.com/hpe-storage/co-deployments/master/operators/hpe-csi-operator/deploy/scc.yaml",target:"_blank",rel:"noopener noreferrer"}},[e._v("GitHub"),t("OutboundLink")],1),e._v(" link using the following command:")])]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-sL")]),e._v(" https://raw.githubusercontent.com/hpe-storage/co-deployments/master/operators/hpe-csi-operator/deploy/scc.yaml "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" hpe-csi-scc.yaml\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[t("p",[e._v("Edit relevant parameters such as project name or namespace in the hpe-csi-scc.yaml file.")])]),e._v(" "),t("li",[t("p",[e._v("Change my-hpe-csi-operator to the name of the project (in this case, hpe-csi) where the CSI Operator is being deployed using the following command:")])])]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("$ oc new-project hpe-csi --display-name"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"HPE CSI Driver for Kubernetes"')]),e._v("\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" -i"),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("''")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-e")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'s/my-hpe-csi-driver-operator/hpe-csi/g'")]),e._v(" hpe-csi-scc.yaml\n")])])]),t("ol",{attrs:{start:"4"}},[t("li",[e._v("Save the file.")])]),e._v(" "),t("p",[e._v("The following figure illustrates the parameter that needs to be edited (project name) where the HPE CSI Driver operator is deployed:")]),e._v(" "),t("p",[t("img",{attrs:{src:s(299),alt:""}})]),e._v(" "),t("p",[t("strong",[e._v("FIGURE 12:")]),e._v(" Editing hpe-cs-scc.yaml file")]),e._v(" "),t("ol",{attrs:{start:"5"}},[t("li",[e._v("Deploy SCC using the following command and check the output:")])]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("$ oc create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-f")]),e._v(" hpe-csi-scc.yaml\n")])])]),t("p",[e._v("The following output is displayed:")]),e._v(" "),t("p",[e._v("securitycontextconstraints.security.openshift.io/hpe-csi-scc created")]),e._v(" "),t("p",[t("strong",[e._v("Installing and configuring HPE CSI Driver")])]),e._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),t("p",[e._v("HPE CSI Driver version 2.4 is used for deploying HPE Alletra Storage on the RHOCP 4.14.")])]),e._v(" "),t("p",[t("strong",[e._v("Prerequisites:")])]),e._v(" "),t("p",[e._v("Before installing the HPE CSI Driver from the Red Hat OpenShift Container Platform Console:")]),e._v(" "),t("ul",[t("li",[e._v("Create a namespace for HPE CSI Driver")]),e._v(" "),t("li",[e._v("Deploy SCC for the created namespace")])]),e._v(" "),t("p",[t("strong",[e._v("Installing HPE CSI Driver Operator using Red Hat OperatorHub")])]),e._v(" "),t("p",[e._v("To install HPE CSI Driver Operator from the Red Hat OperatorHub:")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Log in to the Red Hat OpenShift Container Platform Console.")])]),e._v(" "),t("li",[t("p",[e._v("Navigate to Operators â†’ OperatorHub.")])]),e._v(" "),t("li",[t("p",[e._v("Search for HPE CSI Driver Operator from the list of operators and click HPE CSI Driver Operator.")])]),e._v(" "),t("li",[t("p",[e._v("On the HPE CSI Operator for Kubernetes page, click Install.")])])]),e._v(" "),t("p",[t("img",{attrs:{src:s(300),alt:""}})]),e._v(" "),t("p",[t("strong",[e._v("FIGURE 13:")]),e._v(" HPE CSI Driver Operator search")]),e._v(" "),t("ol",{attrs:{start:"5"}},[t("li",[t("p",[e._v("On the Create Operator Subscription page, select the appropriate options:")]),e._v(" "),t("ol",[t("li",[t("p",[e._v('Select "A specific namespace on the cluster" in the Installation Mode option.')])]),e._v(" "),t("li",[t("p",[e._v("Select the appropriate namespace (in this case, hpe-csi) in the Installed Namespace option.")])]),e._v(" "),t("li",[t("p",[e._v('Select "stable" in the Update Channel option.')])]),e._v(" "),t("li",[t("p",[e._v('Select "Automatic" in the Approval Strategy option.')])])]),e._v(" "),t("p",[t("img",{attrs:{src:s(301),alt:""}})]),e._v(" "),t("p",[t("strong",[e._v("FIGURE 14:")]),e._v(" Create Operator Subscription")]),e._v(" "),t("ol",{attrs:{start:"5"}},[t("li",[e._v("Click Install.")])])]),e._v(" "),t("li",[t("p",[e._v("The Installed Operators page is displayed with the status of the operator.")])])]),e._v(" "),t("p",[t("img",{attrs:{src:s(302),alt:""}})]),e._v(" "),t("p",[t("strong",[e._v("FIGURE 15:")]),e._v(" Installed Operators")]),e._v(" "),t("p",[t("strong",[e._v("Creating HPE CSI Driver")])]),e._v(" "),t("p",[e._v("The HPE CSI Driver is a multi-vendor and multi-backend driver where each implementation has a Container Storage Provider (CSP). The HPE CSI Driver for Kubernetes uses CSP to perform data management operations on storage resources such as searching for a logical unit number (lun) and so on. The HPE CSI Driver allows any vendor or project to develop its own CSP using theâ€¯"),t("a",{attrs:{href:"https://developer.hpe.com/api/hpe-nimble-csp/",target:"_blank",rel:"noopener noreferrer"}},[e._v("CSP specification"),t("OutboundLink")],1),e._v(". It enables the third parties to integrate their storage solution into Kubernetes and takes care of all the intricacies.")]),e._v(" "),t("p",[e._v("To create the HPE CSI Driver:")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Log in to the Red Hat OpenShift Container Platform Console.")])]),e._v(" "),t("li",[t("p",[e._v("Navigate to â€¯Operatorsâ€¯â†’â€¯Installed Operatorsâ€¯on the left pane to view the installed operators.")])]),e._v(" "),t("li",[t("p",[e._v("On the Installed Operators page, selectâ€¯HPECSIDriver from theâ€¯Projectâ€¯drop-down list to switch to theâ€¯hpe-csiâ€¯project.")])]),e._v(" "),t("li",[t("p",[e._v("On theâ€¯hpe-csiâ€¯project, select HPECSIDriver tab.")])]),e._v(" "),t("li",[t("p",[e._v("Click Create HPECSIDriver.")])]),e._v(" "),t("li",[t("p",[e._v("Click Create.")])])]),e._v(" "),t("p",[t("img",{attrs:{src:s(303),alt:""}})]),e._v(" "),t("p",[t("strong",[e._v("FIGURE 16:")]),e._v(" HPE CSI Driver creation")]),e._v(" "),t("p",[t("strong",[e._v("Verifying HPECSIDriver configuration")])]),e._v(" "),t("p",[e._v("After the HPECSIDriver is deployed, the deployment pods such as hpe-csi-controller, hpe-csi-driver, primera3par-csp, and Nimble-csp are displayed on the Pods page.")]),e._v(" "),t("p",[t("img",{attrs:{src:s(304),alt:""}})]),e._v(" "),t("p",[t("strong",[e._v("FIGURE 17:")]),e._v(" Deployment pods for HPECSIDriver")]),e._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),t("p",[e._v("The Nimble Storage CSP also supports HPE Alletra 6000.")])]),e._v(" "),t("p",[e._v("To verify the HPE CSI node information:")]),e._v(" "),t("ol",[t("li",[e._v("On the installer VM, check HPENodeInfo and network status of worker nodes with the following commands.")])]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("$ oc get HPENodeInfo\n\n$ oc get HPENodeInfo/"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("workernode fqdn"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-o")]),e._v(" yaml\n")])])]),t("p",[e._v("The following output is displayed:")]),e._v(" "),t("p",[t("img",{attrs:{src:s(305),alt:""}})]),e._v(" "),t("p",[t("strong",[e._v("FIGURE 18:")]),e._v(" HPENodeInfo on the cluster")]),e._v(" "),t("p",[t("strong",[e._v("Creating HPE Alletra StorageClass")])]),e._v(" "),t("p",[e._v("After HPE CSI Driver is deployed, two additional objects, Secret and StorageClass, must be created to initiate the provisioning of persistent storage.")]),e._v(" "),t("p",[t("strong",[e._v("Creating Alletra Secret")])]),e._v(" "),t("p",[e._v("To create a new Secret via CLI that will be used with HPE Alletra:")]),e._v(" "),t("ol",[t("li",[e._v("Add the name,â€¯Namespace, backend username, backend password and the backend IP address in the Alletra-secret.yaml file and save it to be used by the CSP.")])]),e._v(" "),t("p",[e._v("The following details are provided in the Alletra-secret.yaml file:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("apiVersion: v1\n\nkind: Secret\n\nmetadata:\n\n  name: alletra-secret\n\n  namespace: hpe-csi\n\nstringData:\n\n  serviceName: alletra-csp-svc\n\n  servicePort: "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"8080"')]),e._v("\n\n  backend: alletramgmtip      "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# update alletramgmt ip")]),e._v("\n\n  username: admin\n\n  password: admin\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[e._v("Create the Alletra-secret.yaml file with the following command:")])]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("$ oc create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-f")]),e._v(" Alletra-secret.yaml\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[e._v('The following output displays the status of the alletra-secret with the "hpe-csi"â€¯namespace.')])]),e._v(" "),t("p",[t("img",{attrs:{src:s(306),alt:""}})]),e._v(" "),t("p",[t("strong",[e._v("FIGURE 19:")]),e._v(" HPE Alletra Secret status")]),e._v(" "),t("p",[t("strong",[e._v("Creating StorageClass with HPE Alletra Secret")])]),e._v(" "),t("p",[e._v("This section describes how to create a new StorageClass using the existing Alletra-secret and the necessary StorageClass parameters.")]),e._v(" "),t("p",[e._v("To create a new StorageClass using the Alletra-secret:")]),e._v(" "),t("ol",[t("li",[e._v("Edit the following parameters in the Alletra-storageclass.yaml file:")])]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("apiVersion: storage.k8s.io/v1\n\nkind: StorageClass\n\nmetadata:\n\n  annotations:\n\n    storageclass.kubernetes.io/is-default-class: "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"true"')]),e._v("\n\n  name: Alletra-storageclass\n\nprovisioner: csi.hpe.com\n\nparameters:\n\n  csi.storage.k8s.io/fstype: xfs\n\n  csi.storage.k8s.io/controller-expand-secret-name: alletra-secret\n\n  csi.storage.k8s.io/controller-expand-secret-namespace: hpe-csi\n\n  csi.storage.k8s.io/controller-publish-secret-name: alletra-secret\n\n  csi.storage.k8s.io/controller-publish-secret-namespace: hpe-csi\n\n  csi.storage.k8s.io/node-publish-secret-name: alletra-secret\n\n  csi.storage.k8s.io/node-publish-secret-namespace: hpe-csi\n\n  csi.storage.k8s.io/node-stage-secret-name: alletra-secret\n\n  csi.storage.k8s.io/node-stage-secret-namespace: hpe-csi\n\n  csi.storage.k8s.io/provisioner-secret-name: alletra-secret\n\n  csi.storage.k8s.io/provisioner-secret-namespace: hpe-csi\n\n  description: "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Volume created by the HPE CSI Driver for Kubernetes"')]),e._v("\n\nreclaimPolicy: Delete\n\nallowVolumeExpansion: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),e._v("\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[e._v("Create the Alletra-storageclass.yml file with the following command:")])]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("$ oc create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-f")]),e._v(" Alletra-storageclass.yml\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[e._v("Verify the name of the storage class (in this case, Alletra-storageclass).")])]),e._v(" "),t("p",[t("img",{attrs:{src:s(307),alt:""}})]),e._v(" "),t("p",[t("strong",[e._v("FIGURE 20:")]),e._v(" HPE Alletra StorageClass status")]),e._v(" "),t("h2",{attrs:{id:"deploying-openshift-data-foundation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deploying-openshift-data-foundation"}},[e._v("#")]),e._v(" Deploying Openshift Data Foundation")]),e._v(" "),t("p",[e._v("This section covers deploying OpenShift Data Foundation 4.14 on existing Red Hat OpenShift Container Platform 4.14 worker nodes.")]),e._v(" "),t("p",[e._v("The OpenShift Data Foundation operator installation will be using Local Storage operator which will use file system storage of 10GB for monitoring purpose and block storage of 500GB/2TB for OSD (Object Storage Daemon) volumes. These OSD are useful for configuring any application on top of OCP cluster using ODF configuration.")]),e._v(" "),t("p",[t("img",{attrs:{src:s(308),alt:""}})]),e._v(" "),t("p",[t("strong",[e._v("Figure 21.")]),e._v(" Logical storage Layout in Solution")]),e._v(" "),t("p",[e._v("The below operators are required to create ODF cluster and deployed through automation fashion.")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Local Storage Operator")])]),e._v(" "),t("li",[t("p",[e._v("OpenShift Data Foundation Operator")])])]),e._v(" "),t("h3",{attrs:{id:"flow-diagram"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#flow-diagram"}},[e._v("#")]),e._v(" Flow Diagram")]),e._v(" "),t("p",[t("img",{attrs:{src:s(309),alt:""}})]),e._v(" "),t("p",[t("strong",[e._v("Figure 22")]),e._v(". Deploying OpenShift Container Storage Solution Flow Diagram")]),e._v(" "),t("h3",{attrs:{id:"configuration-requirements"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#configuration-requirements"}},[e._v("#")]),e._v(" Configuration requirements")]),e._v(" "),t("p",[e._v("The below table shows about all required worker node configuration.")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[t("strong",[e._v("Server Role")])]),e._v(" "),t("th",[t("strong",[e._v("CPU")])]),e._v(" "),t("th",[t("strong",[e._v("RAM")])]),e._v(" "),t("th",[t("strong",[e._v("HardDisk1")])]),e._v(" "),t("th",[t("strong",[e._v("HardDisk2")])]),e._v(" "),t("th",[t("strong",[e._v("HardDisk3")])])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("Worker")]),e._v(" "),t("td",[e._v("16")]),e._v(" "),t("td",[e._v("64")]),e._v(" "),t("td",[e._v("120 GB")]),e._v(" "),t("td",[e._v("10 GB")]),e._v(" "),t("td",[e._v("500 GB/2 TB")])])])]),e._v(" "),t("h3",{attrs:{id:"pre-requisites"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pre-requisites"}},[e._v("#")]),e._v(" Pre-requisites")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Red Hat OpenShift Container Platform 4.14 cluster console is required with the login credentials.")])]),e._v(" "),t("li",[t("p",[e._v("Availability of any local storage from any storage (i.e Nimble,Alletra,Local Storage) in OpenShift Container Platform.")])]),e._v(" "),t("li",[t("p",[e._v('ODF installation on OCP 4.14 cluster requires a minimum of 3 worker nodes but ODF should have exact 3 worker nodes which use two more hard disks with 10GB for mon POD (3 in total using always a PVC) + 500GB (or more than 500GB) volume (a PVC using the default "'),t("strong",[e._v("thin")]),e._v('" storage class) for the OSD volumes. It also requires 16 CPUs and 64GB RAM for each node and worker node hard disk configuration as shown in above figure.')])])]),e._v(" "),t("h3",{attrs:{id:"scripts-for-deploying-odf-cluster"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#scripts-for-deploying-odf-cluster"}},[e._v("#")]),e._v(" Scripts for deploying ODF cluster")]),e._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),t("p",[e._v("BASE_DIR - is a base directory path for all automated scripts directories are in place and path is\n"),t("strong",[e._v("/opt/hpe-solutions-openshift/DL-LTI-Openshift/")])])]),e._v(" "),t("p",[e._v("This section provides details on the scripts developed to automate the installation of ODF operator on the OCP cluster. The scripts used to deploy ODF can be found in the installer VM at "),t("em",[e._v("$BASE_DIR/odf_installation")]),e._v(".")]),e._v(" "),t("ol",[t("li",[t("p",[t("strong",[e._v("install_odf_operator.py")]),e._v(" - main python script which installs Local Storage operator, OpenShift Container Storage operators, creates file system & block storage and also creates SCs, PVs, PVCs.")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("config.py")]),e._v(" - This python script is used to convert user input values into program variables for usage by the install_odf_operator.py script.")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("userinput.json")]),e._v(" - The userinput.json file needs to be modified as per user configuration and requirements for installing and scaling ODF cluster.")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("create_local_storage_operator.yaml")]),e._v(" -- Creates Local Storage operator's Namespace, installs Local Storage operator.")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("auto_discover_devices.yaml")]),e._v(" -â€“ Creates the LocalVolumeDiscovery resource using this file.")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("localvolumeset.yaml")]),e._v(" -â€“ Creates the LocalVolumeSets")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("odf_operator.yaml")]),e._v(" -- This playbook creates OpenShift Container Storage Namespace and OpenShift Data Foundation Operator.")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("storagecluster.yaml")]),e._v(" -â€“ This playbook creates storage classes, PVCs (Persistent Volume Claim), pods to bring up the ODF cluster.")])])]),e._v(" "),t("h3",{attrs:{id:"installing-openshift-container-storage-on-openshift-container-platform"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#installing-openshift-container-storage-on-openshift-container-platform"}},[e._v("#")]),e._v(" Installing OpenShift Container Storage on OpenShift Container Platform")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Login to the installer machine as non-root user and browse to python virtual environment as per DG.")])]),e._v(" "),t("li",[t("p",[e._v("Update the "),t("em",[e._v("userinput.json")]),e._v(" file is found at "),t("em",[e._v("$BASE_DIR/odf_installation")]),e._v(" with the following setup configuration details:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("OPENSHIFT_DOMAIN: "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"<OpenShift Server sub domain fqdn (api.domain.base_domain)>"')]),e._v(",\n\nOPENSHIFT_PORT: "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"<OpenShift Server port number (OpenShift Container Platform runs on port 6443 by default)>"')]),e._v(",\n\nLOCAL_STORAGE_VERSION"),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('": "')]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("OCP_cluster_version"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('",\n\nOPENSHIFT_CONTAINER_STORAGE_VERSION"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('""')]),e._v(",\n\nOPENSHIFT_CLIENT_PATH: "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"<Provide oc absolute path ending with / OR leave empty in case oc is available under /usr/local/bin>"')]),e._v(",\n\n"),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"OPENSHIFT_CONTAINER_PLATFORM_WORKER_NODES"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("Provide OCP worker nodes fqdn list "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"sworker1.fqdn"')]),e._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"sworker2.fqdn"')]),e._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"sworker3.fqdn"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(",\n\n"),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"OPENSHIFT_USERNAME"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('""')]),e._v(",\n\n"),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"OPENSHIFT_PASSWORD"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('""')]),e._v(",\n\n"),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"DISK_NUMBER"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('""')]),e._v("\n")])])])]),e._v(" "),t("li",[t("p",[e._v("Execute the following command to deploy ODF cluster.")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$BASE_DIR")]),e._v("/odf_installation\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" python "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-W")]),e._v(" ignore install_odf_operator.py\n")])])]),t("p",[e._v("The output of the above command as shown below:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" python "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-W")]),e._v(" ignore install_odf_operator.py\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("Enter key "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" encrypted variables:\n\nLogging into your OpenShift Cluster\n\nSuccessfully logged into the OpenShift Cluster\n\nWaiting "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(" minutes to "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Local Storage'")]),e._v(" operator to be available on OCP web console"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Local Storage'")]),e._v(" operator is created"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!")]),e._v("\n\nWaiting "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v(" minutes to OCS operator to be available on OCP web console"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'OpenShift Container Storage'")]),e._v(" operator is created"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!")]),e._v("\n\nINFO:\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" Run the below "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("command")]),e._v(" to list all PODs and PVCs of OCS cluster.\n\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'oc get pod,pvc -n openshift-storage'")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" Wait "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'pod/ocs-operator-xxxx'")]),e._v(" pod to be up and running.\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" Log into OCP web GUI and check Persistant Stoarge "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("in")]),e._v(" dashboard.\n\n$\n")])])])])]),e._v(" "),t("h3",{attrs:{id:"validation-of-the-openshift-data-foundation-cluster"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#validation-of-the-openshift-data-foundation-cluster"}},[e._v("#")]),e._v(" Validation of the OpenShift Data Foundation cluster")]),e._v(" "),t("p",[e._v("The required operators will be created after the execution of the script and they will be reflected in the OpenShift console. This section outlines the steps to verify the operators created through script and are reflected in the GUI:")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Login to the "),t("strong",[e._v("OpenShift Container Platform")]),e._v(" web console as the user with administrative privileges.")])]),e._v(" "),t("li",[t("p",[e._v("Navigate to "),t("strong",[e._v("Operators -> Project (local-storage)")]),e._v(" -> "),t("strong",[e._v("Installed")]),e._v(" "),t("strong",[e._v("Operators")]),e._v(" select your project name.")])]),e._v(" "),t("li",[t("p",[e._v("The Openshift data foundation operator will be available in the OpenShift web console as shown in below Figure.")]),e._v(" "),t("p",[t("img",{attrs:{src:s(310),alt:""}})])]),e._v(" "),t("li",[t("p",[e._v("Navigate to "),t("strong",[e._v("Operators")]),e._v(" -> "),t("strong",[e._v("Installed")]),e._v(" "),t("strong",[e._v("Operators")]),e._v(" select your project name openshift-storage for OpenShift Container Storage operator.")])]),e._v(" "),t("li",[t("p",[e._v("The OpenShift Container Storage operator will be available on the OpenShift Container Platform web console as shown in below Figure.")]),e._v(" "),t("p",[t("img",{attrs:{src:s(311),alt:""}})])]),e._v(" "),t("li",[t("p",[e._v("SCs of OpenShift Data Foundation operator on CLI as shown in below.")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" oc get sc\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("NAME                          PROVISIONER                             RECLAIMPOLICY   VOLUMEBINDINGMODE      ALLOWVOLUMEEXPANSION   AGE\nlocal-sc                      kubernetes.io/no-provisioner            Delete          WaitForFirstConsumer   "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("                  45h\nlocalblock-sc                 kubernetes.io/no-provisioner            Delete          WaitForFirstConsumer   "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("                  45h\nodf-storagecluster-ceph-rbd   openshift-storage.rbd.csi.ceph.com      Delete          Immediate              "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("                  45h\nodf-storagecluster-cephfs     openshift-storage.cephfs.csi.ceph.com   Delete          Immediate              "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("                  45h\nopenshift-storage.noobaa.io   openshift-storage.noobaa.io/obc         Delete          Immediate              "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("                  45h\n")])])])]),e._v(" "),t("li",[t("p",[e._v("PVs of OpenShift Data Foundation operator on CLI as shown in\nbelow.")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" oc get "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("pv")]),e._v("\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                                       STORAGECLASS                  REASON   AGE\nlocal-pv-2febb788                          500Gi      RWO            Delete           Bound    openshift-storage/odf-deviceset-1-0-lhtvh   localblock-sc                          45h\nlocal-pv-5f19c0e5                          10Gi       RWO            Delete           Bound    openshift-storage/rook-ceph-mon-b           local-sc                               45h\nlocal-pv-b73b1cd5                          500Gi      RWO            Delete           Bound    openshift-storage/odf-deviceset-2-0-jmmck   localblock-sc                          45h\nlocal-pv-b8ba8c38                          10Gi       RWO            Delete           Bound    openshift-storage/rook-ceph-mon-a           local-sc                               45h\nlocal-pv-c3a372f6                          10Gi       RWO            Delete           Bound    openshift-storage/rook-ceph-mon-c           local-sc                               45h\nlocal-pv-e5e3d596                          500Gi      RWO            Delete           Bound    openshift-storage/odf-deviceset-0-0-5jxg7   localblock-sc                          45h\npvc-8f3e3d8b-6be7-4ba8-8968-69cbc866c89f   50Gi       RWO            Delete           Bound    openshift-storage/db-noobaa-db-0            ocs-storagecluster-ceph-rbd            45h\n $\n")])])])]),e._v(" "),t("li",[t("p",[e._v("PVCs of OpenShift Data Foundation operator on CLI as shown in below.")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" oc get pvc "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-n")]),e._v(" openshift-storage\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("NAME                      STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS                  AGE\ndb-noobaa-db-0            Bound    pvc-8f3e3d8b-6be7-4ba8-8968-69cbc866c89f   50Gi       RWO            odf-storagecluster-ceph-rbd   45h\nodf-deviceset-0-0-5jxg7   Bound    local-pv-e5e3d596                          500Gi      RWO            localblock-sc                 45h\nodf-deviceset-1-0-lhtvh   Bound    local-pv-2febb788                          500Gi      RWO            localblock-sc                 45h\nodf-deviceset-2-0-jmmck   Bound    local-pv-b73b1cd5                          500Gi      RWO            localblock-sc                 45h\nrook-ceph-mon-a           Bound    local-pv-b8ba8c38                          10Gi       RWO            local-sc                      45h\nrook-ceph-mon-b           Bound    local-pv-5f19c0e5                          10Gi       RWO            local-sc                      45h\nrook-ceph-mon-c           Bound    local-pv-c3a372f6                          10Gi       RWO            local-sc                      45h\n $\n")])])])]),e._v(" "),t("li",[t("p",[e._v("PODs of OpenShift Data Foundation operator on CLI as shown in below.")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" oc get pod "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-n")]),e._v(" openshift-storage\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("NAME READY STATUS RESTARTS AGE\n\ncsi-cephfsplugin-6xpsk "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v("/3 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\ncsi-cephfsplugin-7khm6 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v("/3 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 17m\n\ncsi-cephfsplugin-bb48n "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v("/3 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\ncsi-cephfsplugin-cfzx6 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v("/3 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 15m\n\ncsi-cephfsplugin-provisioner-79587c64f9-2dpm6 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5")]),e._v("/5 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\ncsi-cephfsplugin-provisioner-79587c64f9-hf46x "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5")]),e._v("/5 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\ncsi-cephfsplugin-w6p6v "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v("/3 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\ncsi-rbdplugin-2z686 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v("/3 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\ncsi-rbdplugin-6tv5m "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v("/3 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\ncsi-rbdplugin-jgf5z "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v("/3 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 17m\n\ncsi-rbdplugin-provisioner-5f495c4566-76rqm "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5")]),e._v("/5 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\ncsi-rbdplugin-provisioner-5f495c4566-pzvww "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5")]),e._v("/5 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\ncsi-rbdplugin-v7lfx "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v("/3 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\ncsi-rbdplugin-ztdjs "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v("/3 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 15m\n\nnoobaa-core-0 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nnoobaa-db-0 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nnoobaa-endpoint-6458fc874f-vpznd "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nnoobaa-operator-7f4495fc6-lmk9k "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nodf-operator-5d664769f-59v8j "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-crashcollector-sworker1.socp.twentynet.local-84dddddb "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-crashcollector-sworker2.socp.twentynet.local-8b5qzzsz "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-crashcollector-sworker3.socp.twentynet.local-699n9kzp "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-drain-canary-sworker1.socp.twentynet.local-85bffzm66m "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-drain-canary-sworker2.socp.twentynet.local-66bcfjjfkr "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-drain-canary-sworker3.socp.twentynet.local-5f6b57c9nt "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-mds-ocs-storagecluster-cephfilesystem-a-67fbb67dkb4kz "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-mds-ocs-storagecluster-cephfilesystem-b-db66df7dtqkmx "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-mgr-a-6f5f7b58dc-fjvjc "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-mon-a-76cc49c944-5pcgf "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-mon-b-b9449cdd7-s6mct "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-mon-c-59d854cd8-gn6sd "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-operator-775cd6cd66-sdfph "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-osd-0-7644557bfb-9l7ns "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-osd-1-7694c74948-lc9sf "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-osd-2-794547558-wjcpz "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-osd-prepare-ocs-deviceset-0-0-5jxg7-t89zh "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("/1 Completed "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-osd-prepare-ocs-deviceset-1-0-lhtvh-f2znl "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("/1 Completed "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-osd-prepare-ocs-deviceset-2-0-jmmck-wsrb2 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("/1 Completed "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\nrook-ceph-rgw-ocs-storagecluster-cephobjectstore-a-67b7865qx276 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 45h\n\n$\n")])])])]),e._v(" "),t("li",[t("p",[e._v("Storage capacity of ODF cluster with 3 worker nodes (3x500Gi) on OCP web cluster as shown below figure.")]),e._v(" "),t("p",[t("img",{attrs:{src:s(312),alt:""}})])])]),e._v(" "),t("h3",{attrs:{id:"validating-odf-with-deploying-wordpress-application"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#validating-odf-with-deploying-wordpress-application"}},[e._v("#")]),e._v(" Validating ODF with deploying WordPress application")]),e._v(" "),t("p",[e._v("This section covers the steps to validate the OpenShift Data Foundation deployment (ODF) by deploying 2-tier application along with MySQL database.")]),e._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[e._v("Prerequisites")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("OCP 4.14 cluster must be installed.")])]),e._v(" "),t("li",[t("p",[e._v("ODF to claim persistent volume (PV).")])])])]),e._v(" "),t("h3",{attrs:{id:"deploying-wordpress-application"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deploying-wordpress-application"}},[e._v("#")]),e._v(" Deploying WordPress application")]),e._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),t("p",[e._v("BASE_DIR - is a base directory path for all automated scripts directories are in place and path is /opt/hpe-solutions-openshift/DL-LTI-Openshift")])]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Login to the installer machine as a non-root user.")])]),e._v(" "),t("li",[t("p",[e._v("From within the repository, navigate to the WordPress script folder")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$BASE_DIR")]),e._v("/odf_installation/wordpress\n")])])])]),e._v(" "),t("li",[t("p",[e._v("Run below script to deploy Wordpress application along with MySQL")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" ./deploy_wordpress.sh\n")])])])])]),e._v(" "),t("p",[e._v("The deploy_wordpress.sh scripts does the following activities.")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Creates project")])]),e._v(" "),t("li",[t("p",[e._v("Sets default storage class")])]),e._v(" "),t("li",[t("p",[e._v("Deploys Wordpress and MySQL app")])]),e._v(" "),t("li",[t("p",[e._v("Create routes")])])]),e._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[t("p",[e._v("Below is the output of the scripts")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" ./deploy_wordpress.sh\n")])])]),t("p",[e._v("Output of the command follows:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("Already on project "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"wordpress"')]),e._v(" on server "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"https://api.socp.twentynet.local:6443"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(".")]),e._v("\n\nYou can "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" applications to this project with the "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'new-app'")]),e._v(" command.\nFor example, try:\n\noc new-app ruby~https://github.com/sclorg/ruby-ex.git\n\nto build a new example application "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("in")]),e._v(" Ruby. Or use kubectl to deploy a simple Kubernetes application:\n\nkubectl create deployment hello-node "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--image")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("gcr.io/hello-minikube-zero-install/hello-node\n\nAlready on project "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"wordpress"')]),e._v(" on server "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"https://api.socp.twentynet.local:6443"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(".")]),e._v("\n\nclusterrole.rbac.authorization.k8s.io/system:openshift:scc:anyuid\nadded: "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"default"')]),e._v("error: "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--overwrite")]),e._v(" is "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v(" but found the following declared annotation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(":\n"),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'storageclass.kubernetes.io/is-default-class'")]),e._v(" already has a value "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("true"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\nservice/wordpress-http created\n\nservice/wordpress-mysql created\n\npersistentvolumeclaim/mysql-pv-claim created\n\npersistentvolumeclaim/wp-pv-claim created\n\nsecret/mysql-pass created\n\ndeployment.apps/wordpress-mysql created\n\ndeployment.apps/wordpress created\n\nroute.route.openshift.io/wordpress-http created\n\nURL to access application\n\nwordpress-http-wordpress.apps.socp.twentynet.local\n\n$\n")])])])])]),e._v(" "),t("h3",{attrs:{id:"verifying-the-wordpress-deployment"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#verifying-the-wordpress-deployment"}},[e._v("#")]),e._v(" Verifying the WordPress deployment")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Execute the following command to verify the persistent volume associated with WordPress application and MySQL database.")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" oc get pods,pvc,route "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-n")]),e._v(" wordpress\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("NAME                                  READY   STATUS    RESTARTS   AGE\npod/wordpress-6f69797b8f-hqpss        "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("          5m52s\npod/wordpress-mysql-8f4b599b5-cd2s2   "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1     Running   "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("          5m52s\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("NAME                                   STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS                  AGE\npersistentvolumeclaim/mysql-pv-claim   Bound    pvc-ccf2a578-9ba3-4577-8115-7c80ac200a9c   5Gi        RWO            ocs-storagecluster-ceph-rbd   5m50s\npersistentvolumeclaim/wp-pv-claim      Bound    pvc-3acec0a0-943d-4138-bda9-5b57f8c35c5d   5Gi        RWO            ocs-storagecluster-ceph-rbd   5m50s\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("NAME                                      HOST/PORT                                              "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("PATH")]),e._v("   SERVICES         PORT     TERMINATION   WILDCARD\nroute.route.openshift.io/wordpress-http   wordpress-http-wordpress.apps.socp.twentynet.local          wordpress-http   "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("80")]),e._v("-tcp                 None\n$\n")])])])]),e._v(" "),t("li",[t("p",[e._v("Access the route url in browser to access the WordPress application as shown below.")]),e._v(" "),t("p",[t("img",{attrs:{src:s(313),alt:""}})])])])])}),[],!1,null,null,null);t.default=r.exports}}]);