(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{450:function(t,a,s){t.exports=s.p+"assets/img/figure126.9b316a3c.png"},451:function(t,a,s){t.exports=s.p+"assets/img/figure127.14216c6e.png"},452:function(t,a,s){t.exports=s.p+"assets/img/figure128.145f77d7.png"},453:function(t,a,s){t.exports=s.p+"assets/img/figure129.60fc6c80.png"},454:function(t,a,s){t.exports=s.p+"assets/img/figure130.5c93e99d.png"},533:function(t,a,s){"use strict";s.r(a);var e=s(54),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"openshift-operators"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#openshift-operators"}},[t._v("#")]),t._v(" OpenShift operators")]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("Prerequisites")]),t._v(" "),e("ul",[e("li",[t._v("Red Hat OpenShift Container Platform 4.9 console")]),t._v(" "),e("li",[t._v("Availability of any Storage Class (Nimble, 3PAR, Local Storage, and ODF) in OpenShift Container Platform.")]),t._v(" "),e("li",[t._v("Python 3.6.x should be available on installer VM.")]),t._v(" "),e("li",[t._v("'Ansible' and 'Requests' python modules.")])])]),t._v(" "),e("h2",{attrs:{id:"introduction"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[t._v("#")]),t._v(" Introduction")]),t._v(" "),e("p",[t._v("Operators are pieces of software that ease the operational complexity of running other pieces of software. They act like an extension of the software vendor's engineering team, watching over a Kubernetes environment (such as OpenShift Container Platform) and using the current state to make decisions in real-time. Any container implementation requires certain operators that need to be enabled for use by the end user. This requirement is satisfied by using a combination of Python and Shell scripts and their execution for automating the installation of these operators.")]),t._v(" "),e("p",[t._v("Hewlett Packard Enterprise has deployed the following operators in an automated fashion:")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("Kiali Operator")])]),t._v(" "),e("li",[e("p",[t._v("Jaeger Operator")])]),t._v(" "),e("li",[e("p",[t._v("Red Hat OpenShift Service Mesh")])]),t._v(" "),e("li",[e("p",[t._v("Prometheus Operator")])]),t._v(" "),e("li",[e("p",[t._v("Grafana Operator")])]),t._v(" "),e("li",[e("p",[t._v("Elasticsearch Operator")])]),t._v(" "),e("li",[e("p",[t._v("Fluentd Operator (Cluster Logging)")])]),t._v(" "),e("li",[e("p",[t._v("Kibana Operator (Cluster Logging)")])])]),t._v(" "),e("h3",{attrs:{id:"scripts-for-configuring-the-operators"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#scripts-for-configuring-the-operators"}},[t._v("#")]),t._v(" Scripts for configuring the operators")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("BASE_DIR is the directory path for all automated scripts and the path is /opt/hpe/solutions/ocp/hpe-solutions-openshift/DL/scalable\n")])])])]),t._v(" "),e("p",[t._v("This section provides details on the scripts developed to automate the installation of operators on the OpenShift Container Platform cluster. The scripts to install operators can be found in the installer VM at "),e("em",[t._v("BASE_DIR/platform/operator_install")]),t._v(".")]),t._v(" "),e("ul",[e("li",[e("p",[e("strong",[t._v("deploy_validate_operators.py")]),t._v(" - Main python script which installs and validates the required operators.")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("Install_odf_operator.py")]),t._v(" -- Main python script which installs Local Storage operator, OpenShift Data Foundation operators, creates file system & block storage and also creates SCs, PVs, PVCs.")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("config.py")]),t._v(" - Python script to convert user input values into program variables for usage by the deploy_validate_operators.py script.")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("userinput.json")]),t._v(" - Input json file filled by the installation user.")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("config_secrets.json")]),t._v(" -- Encrypted input json file filled by the installer user.")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("create_local_storage_operator.yaml")]),t._v(" - Creates Local Storage operator's Namespace, installs Local Storage operator.")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("local_storage_fs.yaml")]),t._v(" - Creates file system storage for monitoring ODF cluster.")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("local_storage_block.yaml")]),t._v(" - Creates block storage for claiming OSD persistent volumes.")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("ODF_operator.yaml")]),t._v(" - This playbook creates OpenShift Data Foundation Namespace, block storage for bounding PVC to Storage Class.")])]),t._v(" "),e("li",[e("p",[e("strong",[t._v("storage_ODF.yaml")]),t._v(" - This playbook creates storage classes, PVCs (Persistent Volume Claim), pods to bring up the ODF cluster.")])])]),t._v(" "),e("h3",{attrs:{id:"installing-the-operators-on-the-openshift-container-platform-cluster"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#installing-the-operators-on-the-openshift-container-platform-cluster"}},[t._v("#")]),t._v(" Installing the operators on the OpenShift Container Platform cluster")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("Login to the Ansible Installer virtual machine as a non-root user and browse to Python virtual environment.")])]),t._v(" "),e("li",[e("p",[t._v("Update the "),e("em",[t._v("config_secrets.json")]),t._v(" file found at "),e("em",[t._v("$BASE_DIR/platform/operator_install")]),t._v(" with the following setup configuration details:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" OPENSHIFT_USERNAME: "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("OpenShift Container Platform cluster username"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" OPENSHIFT_PASSWORD: "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("OpenShift Container Platform cluster password"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])])]),t._v(" "),e("li",[e("p",[t._v("Update the "),e("em",[t._v("userinput.json")]),t._v(" file found at "),e("em",[t._v("$BASE_DIR/platform/operator_install")]),t._v(" with the following setup\nconfiguration details:")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("OPENSHIFT_DOMAIN")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" <OpenShift Server sub domain fqdn (api.domain.base_domain)"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("OPENSHIFT_PORT")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" <OpenShift Server port number (OpenShift Container Platform runs on port 6443 by default)"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("OPENSHIFT_OPERATOR_LIST")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"jaeger-product"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kiali-ossm"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"servicemeshoperator"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"grafana-operator"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"prometheus"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("elasticsearch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v('operator"'),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cluster-logging"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("OPERATOR_CHANNEL_LIST")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stable"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stable"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"alpha"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"beta"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"4.9"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"4.9"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("OPERATOR_SOURCE_LIST")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"redhat-operators"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"redhat-operators"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"redhat-operators"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"community-operators"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"community-operators"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"redhat-operators"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"redhat-operators"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("OPERATOR_INSTALL_PLAN")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Automatic"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Automatic"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Automatic"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Automatic"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Automatic"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Automatic"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Automatic"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("OPENSHIFT_PROJECT_NAME")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" <OpenShift Project Name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("OPENSHIFT_CLIENT_PATH")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" < OpenShift OC client tool path (leave it empty if a path has been set)"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("OPENSHIFT_STORAGE_CLASS_NAME")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" < provide the storage class name to be used by the cluster logging operator "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),e("p",[t._v("The operator list, channel details, operator source, and install plans can be used if the user wants to install additional operators. For the default installation of the required operators, the user should not modify these fields.")])])]),t._v(" "),e("li",[e("p",[t._v("Execute the following command to install the operators discussed in the "),e("a",{attrs:{href:"#Introduction"}},[t._v("Introduction")]),t._v(" section of this document.")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$BASE_DIR")]),t._v("/platform/operator_install\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" python –W ignore deploy_validate_operators.py\n")])])]),e("p",[t._v("The output of the above command is as follows:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" python -W ignore deploy_validate_operators.py\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("Enter key "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" encrypted variables:\nLogging into your OpenShift Cluster\nSuccessfully logged into the OpenShift Cluster\nToken is generated\nCreating Operators"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nCreating Operator jaeger-product\nCreating Operator kiali-ossm\nCreating Operator servicemeshoperator\nCreating Operator grafana-operator\nCreating Operator prometheus\nCreating Operator elasticsearch-operator\nCreating Operator cluster-logging\nValidating Operators"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nThe Required Operators have been Created\n\nDeploying Service Mesh Control Plane"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("\nCreated Service Mesh Control Plane\nValidating Control Plane Creation"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nControl Plane is present and validated"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n\nDeploying Service Mesh Member Roll"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nCreated Service Mesh Member Roll\nValidating Member Roll Creation"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nMember roll is present and validated"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n\nDeploying Logging Cluster"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nCreated Logging instance\nValidating Cluster Logging Instance Creation"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nCluster Logging Instance is present and validated"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n\nAUTOMATION IS COMPLETE"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n$\n​```\n\n")])])])])]),t._v(" "),e("h2",{attrs:{id:"validation-of-the-operator-installation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#validation-of-the-operator-installation"}},[t._v("#")]),t._v(" Validation of the operator installation")]),t._v(" "),e("p",[t._v("The required operators will be created after the execution of the script and they will be reflected in the OpenShift console. This section outlines the steps to verify the operators created through script and are reflected in the GUI:")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("Login to the "),e("strong",[t._v("OpenShift Console")]),t._v(" as the user with administrative privileges.")])]),t._v(" "),e("li",[e("p",[t._v("Navigate to "),e("strong",[t._v("Operators")]),t._v(" -> "),e("strong",[t._v("Installed")]),t._v(" "),e("strong",[t._v("Operators")]),t._v(" -> select your project name.")])]),t._v(" "),e("li",[e("p",[t._v("The operators will be displayed in the OpenShift web console as shown in below figure.")]),t._v(" "),e("p",[e("img",{attrs:{src:s(450),alt:""}})])]),t._v(" "),e("li",[e("p",[t._v('To view the cluster-logging operator and its instance, navigate to "openshift-logging" project name. below figure shows the cluster-logging operator in the OpenShift web console.')]),t._v(" "),e("p",[e("img",{attrs:{src:s(451),alt:""}})])]),t._v(" "),e("li",[e("p",[t._v("Steps to verify the installation of cluster-logging and EFK pods:")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("Switch to the "),e("strong",[t._v("Workloads → Pods")]),t._v(" page ( inside the "),e("strong",[t._v("openshift-logging")]),t._v(" project).")])]),t._v(" "),e("li",[e("p",[t._v("You should see several pods for cluster logging: Elasticsearch, Fluentd, and Kibana as shown in below figure")]),t._v(" "),e("p",[e("img",{attrs:{src:s(452),alt:""}})])])])])]),t._v(" "),e("h3",{attrs:{id:"launch-kibana-dashboard-from-openshift-cluster"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#launch-kibana-dashboard-from-openshift-cluster"}},[t._v("#")]),t._v(" Launch Kibana dashboard from OpenShift cluster")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("Switch to "),e("strong",[t._v("Networking")]),t._v(". Select Routes option , navigate to Location. Click Kibana URL to open a new tab in the browser as shown in below figure.")]),t._v(" "),e("p",[e("img",{attrs:{src:s(453),alt:""}})])]),t._v(" "),e("li",[e("p",[t._v("Kibana dashboard appears as shown below figure.")]),t._v(" "),e("p",[e("img",{attrs:{src:s(454),alt:""}})])])])])}),[],!1,null,null,null);a.default=n.exports}}]);