<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Virtual node configuration | OpenShift Container Platform 4.4 on Synergy</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="Hewlett Packard Enterprise">
    
    <link rel="preload" href="/hpe-solutions-openshift/44-synergy/assets/css/0.styles.848b002a.css" as="style"><link rel="preload" href="/hpe-solutions-openshift/44-synergy/assets/js/app.25b016e2.js" as="script"><link rel="preload" href="/hpe-solutions-openshift/44-synergy/assets/js/2.4639eab6.js" as="script"><link rel="preload" href="/hpe-solutions-openshift/44-synergy/assets/js/4.9e5da2a7.js" as="script"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/10.f90a53b1.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/11.0d45f317.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/12.e8a20512.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/13.1fedfc0f.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/14.6429256e.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/15.1a190dba.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/16.cf38ac5c.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/17.87256181.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/18.e95f5833.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/19.93d66256.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/20.6daf5fdb.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/21.29f23ca8.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/22.a073cf57.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/23.523cb9c6.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/24.a24a3dc4.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/25.2ba844c2.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/26.6be710ed.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/27.be5b9d1a.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/28.75aa7f8e.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/29.beb1893f.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/3.f31d8e9a.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/30.06a297f9.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/31.c1790d7d.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/32.c53f7492.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/33.3d562199.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/5.39a73899.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/6.fb4d3fa6.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/7.203554ca.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/8.6465cc95.js"><link rel="prefetch" href="/hpe-solutions-openshift/44-synergy/assets/js/9.c38254a6.js">
    <link rel="stylesheet" href="/hpe-solutions-openshift/44-synergy/assets/css/0.styles.848b002a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hpe-solutions-openshift/44-synergy/" class="home-link router-link-active"><!----> <span class="site-name">OpenShift Container Platform 4.4 on Synergy</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hpe-solutions-openshift/44-synergy/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/hpe-solutions-openshift/44-synergy/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="http://www.hpe.com/info/ra" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RA Library
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Red Hat OpenShift Container Platform 4 on HPE Synergy</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Overview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Solution Components</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Solution Deployment</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/Solution-deployment-flow.html" class="sidebar-link">Solution Deployment Flow</a></li><li><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/Preparing-execution-environment.html" class="sidebar-link">Preparing the execution environment</a></li><li><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/Server-Profiles.html" class="sidebar-link">Server profiles</a></li><li><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/Operating-system-deployment.html" class="sidebar-link">Operating system deployment</a></li><li><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/User-provisioned-DNS-requirements.html" class="sidebar-link">User-provisioned DNS requirements</a></li><li><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/Load-Balancer.html" class="sidebar-link">Load Balancer</a></li><li><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/Bootstrap-node.html" class="sidebar-link">Bootstrap node</a></li><li><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/Physical-node-configuration.html" class="sidebar-link">Physical node configuration</a></li><li><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/Virtual-node-configuration.html" aria-current="page" class="active sidebar-link">Virtual node configuration</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/Virtual-node-configuration.html#deploying-vsphere-hosts" class="sidebar-link">Deploying vSphere hosts</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/Virtual-node-configuration.html#hpe-oneview-for-vmware-vcenter" class="sidebar-link">HPE OneView for VMware vCenter</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/Virtual-node-configuration.html#creating-the-data-center-cluster-and-adding-hosts-in-vmware-vcenter" class="sidebar-link">Creating the Data center, Cluster and adding hosts in VMware vCenter</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/Virtual-node-configuration.html#configuring-the-network" class="sidebar-link">Configuring the network</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/Virtual-node-configuration.html#creating-a-datastore-in-vcenter" class="sidebar-link">Creating a Datastore in vCenter</a></li><li class="sidebar-sub-header"><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/Virtual-node-configuration.html#red-hat-openshift-container-platform-sizing" class="sidebar-link">Red Hat OpenShift Container Platform sizing</a></li></ul></li><li><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/OCP-Cluster-deployment.html" class="sidebar-link">Red Hat OpenShift Container Platform Cluster deployment</a></li><li><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/OCP-worker-nodes.html" class="sidebar-link">Red Hat OCP worker nodes</a></li><li><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/Deploying-OCP-on-VMware-vSphere.html" class="sidebar-link">Deploying OpenShift Container Platform 4.4 on VMware vSphere</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Additional Features and Functionality</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Resosurces and Additional Links</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="virtual-node-configuration"><a href="#virtual-node-configuration" class="header-anchor">#</a> Virtual node configuration</h1> <p>This section describes the process to deploy virtualization hosts for OpenShift. This section outlines the steps required to configure virtual machine master and worker nodes. At a high level, the steps are as follows:</p> <ol><li><p>Deploying the vSphere hosts</p></li> <li><p>Creating the data center, cluster, and adding hosts into the cluster</p></li> <li><p>Creating a datastore in vCenter</p></li> <li><p>Create virtual master nodes</p></li> <li><p>Deploying virtual worker nodes</p></li></ol> <div class="custom-block tip"><p class="custom-block-title">Note</p> <p>Hewlett Packard Enterprise utilized a consistent method for deployment that would allow for mixed deployments of virtual and physical master and worker nodes and built this solution on bare metal using the Red Hat OpenShift Container Platform user-provisioned infrastructure.</p> <p>For more details on the bare metal provisioner, refer to <a href="https://cloud.redhat.com/openshift/install/metal/user-provisioned" target="_blank" rel="noopener noreferrer">https://cloud.redhat.com/openshift/install/metal/user-provisioned<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. If the intent is to have an overall virtual environment, it is recommended the installation user utilizes Red Hat’s virtual provisioning methods found at <a href="https://docs.openshift.com/container-platform/4.4/installing/installing_vsphere/installing-vsphere.html#installing-vsphere" target="_blank" rel="noopener noreferrer">https://docs.openshift.com/container-platform/4.4/installing/installing_vsphere/installing-vsphere.html#installing-vsphere<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <p>For more information on deploying ESXi, see the <a href="./Preparing-execution-environment#esxi-deployment">ESXi deployment</a> section.</p> <h3 id="migrating-from-standard-switch-to-distributed-switch-for-management-network"><a href="#migrating-from-standard-switch-to-distributed-switch-for-management-network" class="header-anchor">#</a> Migrating from standard switch to distributed switch for management network</h3> <ol><li><p>Login to vCenter. Navigate to <strong>Networking -&gt; -&gt; Distributed Switch -&gt; New Distributed Switch</strong> .</p></li> <li><p>From the <em>New Distributed Switch</em> page, provide a suitable Name for the switch and the datacenter name for the location. Click <strong>Next</strong>.</p></li> <li><p>Select the version for the distributed switch as 6.6.0 and click <strong>Next</strong>.</p></li> <li><p>On the Configure settings page, provide the following information and click <strong>Next</strong>.</p> <p>a. Set the number of uplinks to 2.</p> <p>b. Enable Network I/O control.</p> <p>c. Select the Create a default port group option and provide a unique name for the corresponding network.</p> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure112.8c8495f6.png" alt=""></p></li> <li><p>Review the configuration and click <strong>Finish</strong> to create the distributed switch.</p></li> <li><p>After creating the distributed switch, right click on the switch and select the <strong>Add and Manage Hosts</strong>.</p></li> <li><p>On the Select Task page, select the task as <strong>Add hosts</strong> and click <strong>Next</strong> .</p></li> <li><p>From the select hosts page, click <strong>+ new hosts</strong> and select all the vSphere hosts within the cluster to be configured with the distributed switch and click <strong>OK</strong>.</p></li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure113.4ae78867.png" alt=""></p> <ol start="9"><li>Verify the required hosts are added and click <strong>Next</strong>.</li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure114.7040b8e3.png" alt=""></p> <ol start="10"><li><p>In the <em>Manage Physical Adapters</em> page, select the <strong>Physical Network Adapter</strong> in each host for the corresponding network being configured and click <strong>Assign uplink</strong>. Click <strong>Next</strong>.</p></li> <li><p>Choose the <em>Uplink</em> and select <strong>Apply this uplink assignment to the rest of the hosts</strong>. Select <strong>OK</strong>.</p></li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure115.26a5d6d0.png" alt=""></p> <ol start="12"><li><p>After the uplinks are assigned to the physical network adapters, select <strong>Next</strong>.</p></li> <li><p>In the <em>Manage VMkernel adapters</em>, select the VMkernel to be migrated and click <strong>Assign port group</strong>.</p></li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure116.d8f4f389.png" alt=""></p> <ol start="14"><li>Select the network associated with the VMkernel adapter which was selected in step 13 and click <strong>OK</strong>.</li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure117.b09f0f21.png" alt=""></p> <ol start="15"><li>Review the VMkernel adapter configuration performed in step 13 and 14, and click <strong>Next</strong>.</li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure118.fb2715df.png" alt=""></p> <ol start="16"><li>Review the configuration in Migrate VM networking and click <strong>Next</strong>.</li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure119.fc2da3dd.png" alt=""></p> <ol start="17"><li>In the <em>Ready to complete</em> page, review the configuration and click <strong>Finish</strong>.</li></ol> <h3 id="configuring-the-iscsi-target-server"><a href="#configuring-the-iscsi-target-server" class="header-anchor">#</a> Configuring the iSCSI target server</h3> <ol><li><p>Select the vSphere host and navigate to <strong>Configure -&gt; Storage -&gt; Storage Adapters -&gt; iSCSI Adapter -&gt; Dynamic Discovery</strong> .</p></li> <li><p>Click the <strong>&quot;+ Add...&quot;</strong> icon to add the HPE Nimble Storage discovery IP address.</p></li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure120.c2dc0050.png" alt=""></p> <ol start="3"><li>Provide the <em>Discovery IP address</em> of HPE Nimble Storage system along with the port number and select the <strong>Inherit authentication settings from parent check box</strong>. Click <strong>OK</strong>.</li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure121.2efcf288.png" alt=""></p> <ol start="4"><li>Repeat steps 1-3 in all hosts to add all the iSCSI target servers from the HPE Nimble Storage.</li></ol> <h3 id="configuring-the-network-port-binding-for-iscsi-network"><a href="#configuring-the-network-port-binding-for-iscsi-network" class="header-anchor">#</a> Configuring the network port binding for iSCSI network</h3> <ol><li><p>To configure Network Port Binding, navigate to <strong>Configure -&gt; Storage -&gt; Storage Adapters -&gt; iSCSI Adapter -&gt; Network Port Binding</strong>.</p></li> <li><p>Click <strong>&quot;+ Add Storage Adapter &quot;</strong>.</p></li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure122.b2c86a87.png" alt=""></p> <ol start="3"><li>Select the Port Group of the iSCSI A network and click <strong>OK</strong>.</li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure123.e727f9eb.png" alt=""></p> <ol start="4"><li>Select Port Group of the iSCSI B network and click <strong>OK</strong>.</li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure124.43714f03.png" alt=""></p> <ol start="5"><li>Repeat the steps on all hosts for both iSCSI.</li></ol> <h3 id="adding-a-datastore-using-hpe-nimble-storage-volume-in-vcenter"><a href="#adding-a-datastore-using-hpe-nimble-storage-volume-in-vcenter" class="header-anchor">#</a> Adding a datastore using HPE Nimble Storage volume in vCenter</h3> <p>A datastore needs to be created in VMware vCenter from the volume carved out of HPE Nimble Storage to store the VMs. The following steps create a datastore on the HPE Nimble Storage.</p> <ol><li>From the vSphere Web Client navigator, right-click the cluster, select <strong>Storage</strong> from the drop-down menu, and then select <strong>New Datastore</strong>.</li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure125.3938871e.png" alt=""></p> <ol start="2"><li><p>On the Type page, select <strong>VMFS</strong> as the Datastore type and click <strong>Next</strong>.</p></li> <li><p>On the <em>Name and Device selection</em> page, provide the values requested and click <strong>Next</strong>.</p></li> <li><p>Select a host to view its accessible disk/LUNs. Any of the hosts that are associated with the HPE Nimble Storage volume may be selected and click <strong>Next</strong>.</p></li> <li><p>Select the <strong>Volume</strong> from HPE Nimble Storage and click <strong>Next</strong>.</p></li> <li><p>From the <em>VMFS version</em> page, select <em>VMFS 6</em> and click <strong>Next</strong>.</p></li> <li><p>Specify details for <em>Partition configuration</em> and click <strong>Next</strong>. By default, the entire free space on the storage device is allocated. You can customize the space if required.</p></li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure126.6a6b9daa.png" alt=""></p> <ol start="8"><li>On the Ready to complete page, review the datastore configuration and click <strong>Finish</strong>.</li></ol> <div class="custom-block tip"><p class="custom-block-title">Note</p> <p>If you are utilizing virtual worker nodes, repeat this section to create a datastore to store the worker node virtual machines.</p></div> <h2 id="deploying-vsphere-hosts"><a href="#deploying-vsphere-hosts" class="header-anchor">#</a> Deploying vSphere hosts</h2> <p>Refer to the <a href="./server-profiles">Server Profiles</a> section in this document to create the server profile for the vSphere hosts.</p> <p>After the successful creation of the server profile, install the hypervisor. The following steps describe the process to install the hypervisor:</p> <ol><li><p>From the HPE OneView interface, navigate to Server Profiles and select ESXi-empty-volume Server Profile, Select <strong>Actions &gt; Launch Console.</strong></p></li> <li><p>From the Remote Console window, choose <strong>Virtual Drives -&gt; Image File CD-ROM/DVD</strong> from the <strong>iLO options</strong> menu bar.</p></li> <li><p>Navigate to the VMware ESXi 6.7 ISO file located on the installation system.
Select the ISO file and click <strong>Open</strong>.</p></li> <li><p>If the server is in the powered off state, power switch on the server by selecting <strong>Power Switch -&gt; Momentary Press.</strong></p></li> <li><p>During boot, press <strong>F11</strong> Boot Menu and select iLO Virtual USB 3: iLO Virtual CD-ROM.</p></li> <li><p>When the VMware ESXi installation media has finished loading, proceed through the VMware user prompts. For storage device, select the 40GiB OS volume created on the HPE Image Streamer during server profile creation and <strong>set the root password.</strong></p></li> <li><p>Wait until the vSphere installation is complete.</p></li> <li><p>After the installation is complete, press <strong>F2</strong> to enter the vSphere host configuration page and update the IP address, gateway, DNS, hostname of the host and enable SSH.</p></li> <li><p>After the host is reachable, proceed with the next section.</p></li></ol> <h2 id="hpe-oneview-for-vmware-vcenter"><a href="#hpe-oneview-for-vmware-vcenter" class="header-anchor">#</a> HPE OneView for VMware vCenter</h2> <p>HPE OneView for VMware vCenter is a single, integrated plug-in application for VMware vCenter management. This enables the vSphere administrator to quickly obtain context-aware information about HPE Servers and HPE Storage in their VMware vSphere data center directly from within vCenter. This application enables the vSphere administrator to easily manage physical servers and storage, datastores, and virtual machines. By providing the ability to clearly view and directly manage the HPE Infrastructure from within the vCenter console, the productivity of VMware administrator increases. This also enhances the ability to ensure quality of service.</p> <p>For more details, refer to the HPE documentation at <a href="https://h20392.www2.hpe.com/portal/swdepot/displayProductInfo.do?productNumber=HPVPR" target="_blank" rel="noopener noreferrer">https://h20392.www2.hpe.com/portal/swdepot/displayProductInfo.do?productNumber=HPVPR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="creating-the-data-center-cluster-and-adding-hosts-in-vmware-vcenter"><a href="#creating-the-data-center-cluster-and-adding-hosts-in-vmware-vcenter" class="header-anchor">#</a> Creating the Data center, Cluster and adding hosts in VMware vCenter</h2> <p>This section assumes a VMware vCenter server is available within the installation environment. A data center is a structure in VMware vCenter which contains clusters, hosts, and datastore. To begin with, a data center needs to be created, followed by the clusters and adding hosts into the clusters.</p> <p>To create a data center, a cluster enabled with vSAN and DRS and adding hosts, the installation user will need to edit the vault file and the variables YAML file. Using an editor, open the file <em>/etc/ansible/hpe-solutions-openshift/synergy/scalable/vsphere/vcenter/roles/prepare_vcenter/vars/main.yml</em> to provide the names for data center, clusters and vSphere hostnames. A sample input file is listed and as follows. Installation user should modify this file to suit the environment.</p> <p>In the Ansible vault file (<em>secret.yml</em>) found at <em>/etc/ansible/hpe-solutions-openshift/synergy/scalable/vsphere/vcenter</em>, provide the vCenter and the vSphere host credentials.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># vsphere hosts credentials</span>

<span class="token key atrule">vsphere_username</span><span class="token punctuation">:</span> &lt;username<span class="token punctuation">&gt;</span>

<span class="token key atrule">vsphere_password</span><span class="token punctuation">:</span> &lt;password<span class="token punctuation">&gt;</span>

<span class="token comment"># vcenter hostname/ip address and credentials</span>

<span class="token key atrule">vcenter_hostname</span><span class="token punctuation">:</span> x.x.x.x

<span class="token key atrule">vcenter_username</span><span class="token punctuation">:</span> &lt;username<span class="token punctuation">&gt;</span>

<span class="token key atrule">vcenter_password</span><span class="token punctuation">:</span> &lt;password<span class="token punctuation">&gt;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Note</p> <p>This section assumes all the virtualization hosts have a common user name and password. If it does not have a common username and password, it is up to the installation user to add the virtualization hosts within the appropriate cluster.</p></div> <p>Variables for running the playbook can be found at <em>/etc/ansible/hpe-solutions-openshift/synergy/scalable/vsphere/vcenter/roles/prepare_vcenter/vars/main.yml</em>.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># custom name for data center to be created.</span>

<span class="token key atrule">datacenter_name</span><span class="token punctuation">:</span> datacenter

<span class="token comment"># custom name of the compute clusters with the ESXi hosts for Management VMs.</span>

<span class="token key atrule">management_cluster_name</span><span class="token punctuation">:</span> management<span class="token punctuation">-</span>cluster

<span class="token comment"># hostname or IP address of the vsphere hosts utilized for the management nodes.</span>

<span class="token key atrule">vsphere_host_01</span><span class="token punctuation">:</span> 10.0.x.x

<span class="token key atrule">vsphere_host_02</span><span class="token punctuation">:</span> 10.0.x.x

<span class="token key atrule">vsphere_host_03</span><span class="token punctuation">:</span> 10.0.x.x
</code></pre></div><p>After the variable files are updated with the appropriate values, execute the following command within the installer VM to create the data center, clusters, and add hosts into respective clusters.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token builtin class-name">cd</span> /etc/ansible/hpe-solutions-openshift/synergy/scalable/vsphere/vcenter/

<span class="token operator">&gt;</span> ansible-playbook playbooks/prepare_vcenter.yml –ask-vault-pass
</code></pre></div><h2 id="configuring-the-network"><a href="#configuring-the-network" class="header-anchor">#</a> Configuring the network</h2> <p>Distributed switches need to be configured to handle the vSphere and VM traffic over the management, data center, and iSCSI network present in the environment. This section consists of:</p> <ul><li><p>Configuring distributed switches for the data center and iSCSI networks.</p></li> <li><p>Migrating from a standard switch to a distributed switch for management network.</p></li> <li><p>Configuring the iSCSI target server.</p></li> <li><p>Configuring the network port binding for iSCSI networks.</p></li></ul> <h3 id="configuring-distributed-switches-for-data-center-and-iscsi-network"><a href="#configuring-distributed-switches-for-data-center-and-iscsi-network" class="header-anchor">#</a> Configuring distributed switches for data center and iSCSI network</h3> <ol><li>Login to vCenter. Navigate to Networking -&gt; -&gt; Distributed Switch -&gt; New Distributed Switch.</li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure98.c6403982.png" alt=""></p> <ol start="2"><li><p>From the <em>New Distributed Switch</em> page, provide a suitable Name for the switch and click <strong>Next</strong>.</p></li> <li><p>Select the <em>version</em> for the distributed switch as 6.6.0 and click <strong>Next</strong>.</p></li> <li><p>On the <em>Configure settings</em> page, provide the following information as shown and click <strong>Next</strong>:</p> <p>a. Number of uplinks (2 uplinks for management networks and 1 uplink each for the iSCSI network).</p> <p>b. Enable Network I/O control.</p> <p>c. Select the Create a default port group option and provide unique names for the corresponding network.</p></li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure100.048f0735.png" alt=""></p> <ol start="5"><li>Review the configuration as shown and click <strong>Finish</strong> to create the distributed switch.</li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure99.c3ebf81a.png" alt=""></p> <ol start="6"><li>After creating the distributed switch, right click on the switch and select <strong>Add and Manage Hosts</strong>.</li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure101.905779c1.png" alt=""></p> <ol start="7"><li><p>In the select task page, select the task as <strong>Add hosts</strong> and click <strong>Next</strong>.</p></li> <li><p>From the select host page, click <strong>+</strong> new hosts and select all the vSphere hosts within the cluster to be configured with the distributed switch and click <strong>OK</strong>.</p></li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure102.c7953adf.png" alt=""></p> <ol start="9"><li>Verify that the required hosts are added and click <strong>Next</strong>.</li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure103.3b110111.png" alt=""></p> <ol start="10"><li>In the Manage Physical Adapters page, select the Physical Network Adapters in each host for the corresponding network being configured and click Assign uplink as shown.</li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure104.f3b47eed.png" alt=""></p> <ol start="11"><li>Choose the uplink and select <strong>Apply this uplink assignment to the rest of the hosts</strong>. Select <strong>OK</strong>.</li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure105.91e2b9e3.png" alt=""></p> <ol start="12"><li><p>After the uplinks are assigned to the physical adapters, select <strong>Next</strong>.</p></li> <li><p>Review the configurations in the Manage VMkernel adapters and click <strong>Next</strong>.</p></li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure106.530c1b7e.png" alt=""></p> <ol start="14"><li>Review the configuration in Migrate VM networking and click <strong>Next</strong>.</li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure107.fd99b524.png" alt=""></p> <ol start="15"><li><p>On the Ready to complete page, review the configuration and click <strong>Finish</strong>.</p></li> <li><p>To add VMkernel adapter to the distributed switch, navigate to Networking -&gt; -&gt; -&gt; Add VMkernel Adapter.</p></li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure108.e39b357b.png" alt=""></p> <ol start="17"><li>Select the hosts to which the configuration needs to be applied and click <strong>Next</strong>.</li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure109.dc4941a8.png" alt=""></p> <ol start="18"><li>In the configure VM kernel adapter page, select the IP settings as IPv4 and apply the appropriate services  and then click <strong>Next</strong>. This should include vMotion and Fault Tolerance logging at a minimum.</li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure110.08a489b1.png" alt=""></p> <ol start="19"><li>In the IPv4 settings page, provide the network settings and gateway settings for the all the hosts and click <strong>Next</strong>.</li></ol> <p><img src="/hpe-solutions-openshift/44-synergy/assets/img/figure111.621c847e.png" alt=""></p> <ol start="20"><li>Review the settings in the Ready to complete page and click <strong>Finish</strong>.</li></ol> <div class="custom-block tip"><p class="custom-block-title">Note</p> <p>Repeat the Configuring Distributed Switches section for all the iSCSI network.</p></div> <h2 id="creating-a-datastore-in-vcenter"><a href="#creating-a-datastore-in-vcenter" class="header-anchor">#</a> Creating a Datastore in vCenter</h2> <p>A datastore needs to be created in VMware vCenter from the volume carved out of HPE Storage SANs to store the VMs. The following are the steps to create a datastore in vCenter.</p> <ol><li><p>From the vSphere Web Client navigator, right-click the cluster, select <strong>Storage</strong> from the menu, and then select the <strong>New Datastore</strong>.</p></li> <li><p>From the Type page, select <strong>VMFS</strong> as the Datastore type and click <strong>Next</strong>.</p></li> <li><p>Enter the datastore name and if necessary, select the placement location for the datastore and click <strong>Next</strong>.</p></li> <li><p>Select the device to use for the datastore and click <strong>Next</strong>.</p></li> <li><p>From VMFS version page, select <strong>VMFS 6</strong> and click <strong>Next</strong>.</p></li> <li><p>Define the following configuration requirements for the datastore as per the installation environment and click <strong>Next</strong>.</p> <p>a.  Specify partition configuration</p> <p>b.  Datastore Size</p> <p>c.  Block Size</p> <p>d.  Space Reclamation Granularity</p> <p>e.  Space Reclamation Priority</p></li> <li><p>On the Ready to complete page, review the Datastore configuration and click <strong>Finish</strong>.</p></li></ol> <div class="custom-block tip"><p class="custom-block-title">Note</p> <p>If you utilize virtual worker nodes, repeat this section to create a Datastore to store the worker virtual machines.</p></div> <h2 id="red-hat-openshift-container-platform-sizing"><a href="#red-hat-openshift-container-platform-sizing" class="header-anchor">#</a> Red Hat OpenShift Container Platform sizing</h2> <p>Red Hat OpenShift Container Platform sizing varies depending on the requirements of the organization and type of deployment. This section highlights the host sizing details recommended by Red Hat.</p> <table><thead><tr><th>Resource</th> <th>Bootstrap node</th> <th>Master node</th> <th>Worker node</th></tr></thead> <tbody><tr><td>CPU</td> <td>4</td> <td>4</td> <td>4</td></tr> <tr><td>Memory</td> <td>16GB</td> <td>16GB</td> <td>16GB</td></tr> <tr><td>Disk storage</td> <td>120GB</td> <td>120GB</td> <td>120GB</td></tr> <tr><td>Disk storage</td> <td>120GB</td> <td>120GB</td> <td>120GB</td></tr></tbody></table> <p>Disk partitions on each of the nodes are as follows.</p> <ul><li><p>/var – 40GB</p></li> <li><p>/usr/local/bin – 1GB</p></li> <li><p>Temporary directory – 1GB</p></li></ul> <div class="custom-block tip"><p class="custom-block-title">Note</p> <p>Sizing for worker nodes is ultimately dependent on the container workloads and their CPU, memory, and disk requirements.</p></div> <p>For more information about Red Hat OpenShift Container Platform sizing, refer to the Red Hat OpenShift Container Platform 4 product documentation at <a href="https://access.redhat.com/documentation/en-us/openshift_container_platform/4.4/html/scalability_and_performance/index" target="_blank" rel="noopener noreferrer">https://access.redhat.com/documentation/en-us/openshift_container_platform/4.4/html/scalability_and_performance/index<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/Physical-node-configuration.html" class="prev">
        Physical node configuration
      </a></span> <span class="next"><a href="/hpe-solutions-openshift/44-synergy/Solution-Deployment/OCP-Cluster-deployment.html">
        Red Hat OpenShift Container Platform Cluster deployment
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/hpe-solutions-openshift/44-synergy/assets/js/app.25b016e2.js" defer></script><script src="/hpe-solutions-openshift/44-synergy/assets/js/2.4639eab6.js" defer></script><script src="/hpe-solutions-openshift/44-synergy/assets/js/4.9e5da2a7.js" defer></script>
  </body>
</html>
