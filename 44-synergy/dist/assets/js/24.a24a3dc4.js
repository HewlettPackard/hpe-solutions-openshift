(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{487:function(t,s,a){"use strict";a.r(s);var e=a(42),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"red-hat-local-storage-operator"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#red-hat-local-storage-operator"}},[t._v("#")]),t._v(" Red Hat Local Storage operator")]),t._v(" "),a("p",[t._v("This section describes how to configure the Local Storage operator on Red Hat OpenShift Container Platform 4.")]),t._v(" "),a("h2",{attrs:{id:"physical-environment"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#physical-environment"}},[t._v("#")]),t._v(" Physical environment")]),t._v(" "),a("p",[t._v("Ensure a minimum of two unused disks (a minimum of 100 GB and 250 GB) are present on each worker node prior to implementing local persistent storage.")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[t._v("Use the following command to find partition details.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ lsblk\n")])])])]),t._v(" "),a("p",[t._v("The output appears similar to what is shown.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v(" NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT\n\n loop0 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v(":0 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" 250G "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" loop\n\n sda "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(":0 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" 150G "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" disk\n\n ├─sda1 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(":1 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" 1M "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" part\n\n ├─sda2 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(":2 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" 1G "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" part /boot\n\n └─sda3 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(":3 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" 149G "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" part /sysroot\n\n sdb "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(":16 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" 100G "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" disk\n\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[t._v("sda is for OS volume. sdb is raw disk that is used to create local storage.")])]),t._v(" "),a("h2",{attrs:{id:"deploying-local-storage-operator"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deploying-local-storage-operator"}},[t._v("#")]),t._v(" Deploying local storage operator")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("Login to the "),a("strong",[t._v("OpenShift Web Console")]),t._v(".")])]),t._v(" "),a("li",[a("p",[t._v("Navigate to "),a("strong",[t._v("Administration")]),t._v(" -> "),a("strong",[t._v("Namespaces")]),t._v(" and click "),a("strong",[t._v("Create Namespace")]),t._v(".")])]),t._v(" "),a("li",[a("p",[t._v("From the "),a("strong",[t._v("Create Namespace")]),t._v(" page, provide the following values and then click "),a("strong",[t._v("Create")]),t._v(".")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("Name")]),t._v(": local-storage")])]),t._v(" "),a("li",[a("p",[t._v("Select the "),a("strong",[t._v("No restrictions")]),t._v(" option for Default Network Policy.")])])])]),t._v(" "),a("li",[a("p",[t._v("Navigate to "),a("strong",[t._v("Operators")]),t._v(" -> "),a("strong",[t._v("OperatorHub")]),t._v(".")])]),t._v(" "),a("li",[a("p",[t._v("From the list of operators, select "),a("strong",[t._v("Local")]),t._v(" "),a("strong",[t._v("Storage")]),t._v(" "),a("strong",[t._v("Operator")]),t._v(".")])]),t._v(" "),a("li",[a("p",[t._v("On the Local Storage Operator page, click "),a("strong",[t._v("Install")]),t._v(".")])]),t._v(" "),a("li",[a("p",[t._v("In the "),a("strong",[t._v("Create Operator Subscription")]),t._v(" page, provide the following details and click "),a("strong",[t._v("Subscribe")]),t._v(".")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("Update Channel")]),t._v(": 4.4")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("Approval Strategy")]),t._v(": Select Manual or Automatic as per the installation environment requirement.")])])])]),t._v(" "),a("li",[a("p",[t._v("Wait for the operator to be installed. The status of the installation can be monitored from the "),a("em",[t._v("Installed Operators")]),t._v(" page.")])]),t._v(" "),a("li",[a("p",[t._v("A filesystem is essential to create local file storage. Login to the installer VM, copy and update the following "),a("em",[t._v("local-storage-filesystem.yaml")]),t._v(" file with values for the following parameters:")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("namespace")]),t._v(": local-storage")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("values")]),t._v(" :Fully qualified domain name of the worker nodes")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("devicePaths")]),t._v(": Partition of the worker nodes to be used to create the filesystem")])])]),t._v(" "),a("p",[t._v("A sample "),a("em",[t._v("local-storage-filesystem.yaml")]),t._v(" is as follows.")]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local.storage.openshift.io/v1"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"LocalVolume"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local-disks-fs1"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("namespace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local-storage"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("nodeSelector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("nodeSelectorTerms")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("matchExpressions")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kubernetes.io/hostname\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("operator")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" In\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("values")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" worker1.ocp.twentynet.local\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" worker2.ocp.twentynet.local\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" worker3.ocp.twentynet.local\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storageClassDevices")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storageClassName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local-sc"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumeMode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Filesystem\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("fsType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" xfs\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("devicePaths")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /dev/sdb\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Execute the following command to create the local storage filesystem.")])])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("```bash\n$ oc create –f local-storage-filesystem.yaml\n```\n\nThe output is as follows.\n    \n``` bash\nlocalvolume.local.storage.openshift.io/local-disks-fs created\n```\n")])])]),a("ol",{attrs:{start:"11"}},[a("li",[a("p",[t._v("A disk is essential to create local block storage. Within the installer VM, copy and update the "),a("em",[t._v("local-storage-block.yaml")]),t._v(" file with values for the following parameters.")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("namespace")]),t._v(": local-storage")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("values")]),t._v(": Fully qualified domain name of the worker nodes")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("devicePaths")]),t._v(": Partition of the worker nodes to be used to create the block")])])]),t._v(" "),a("p",[t._v("A sample "),a("em",[t._v("local-storage-block.yaml")]),t._v(" file is as follows.")]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local.storage.openshift.io/v1"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"LocalVolume"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local-disks-fs1"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("namespace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local-storage"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("nodeSelector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("nodeSelectorTerms")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("matchExpressions")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kubernetes.io/hostname\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("operator")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" In\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("values")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" worker1.ocp.twentynet.local\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" worker2.ocp.twentynet.local\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" worker3.ocp.twentynet.local\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storageClassDevices")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storageClassName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local-sc"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumeMode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Filesystem\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("fsType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" xfs\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("devicePaths")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /dev/sdb\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Execute the following command to create the resource.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ oc create –f local-storage-block.yaml\n")])])]),a("p",[t._v("The output is as follows.")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("localvolume.local.storage.openshift.io/local-disks created\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Execute the following command to verify that all of the pods are up and running and that the Storage Class and PVs exist.")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ oc get pod –n local-storage\n")])])]),a("p",[t._v("The output is as follows.")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("NAME READY STATUS RESTARTS AGE\n\nlocal-disks-fs-local-diskmaker-6258p 1/1 Running 0 6d19h\n\nlocal-disks-fs-local-diskmaker-8rzgc 1/1 Running 0 6d19h\n\nlocal-disks-fs-local-diskmaker-c6vch 1/1 Running 0 6d19h\n\nlocal-disks-fs-local-provisioner-598f5 1/1 Running 0 6d19h\n\nlocal-disks-fs-local-provisioner-5g4vp 1/1 Running 0 6d19h\n\nlocal-disks-fs-local-provisioner-sxh5x 1/1 Running 0 6d19h\n\nlocal-disks-fs1-local-diskmaker-5p4s7 1/1 Running 0 4d17h\n\nlocal-disks-fs1-local-diskmaker-9jh6r 1/1 Running 0 4d17h\n\nlocal-disks-fs1-local-diskmaker-z62vd 1/1 Running 0 4d17h\n\nlocal-disks-fs1-local-provisioner-gjkn4 1/1 Running 0 4d17h\n\nlocal-disks-fs1-local-provisioner-kmdzt 1/1 Running 0 4d17h\n\nlocal-disks-fs1-local-provisioner-r28th 1/1 Running 0 4d17h\n\nlocal-disks-local-diskmaker-5wpr9 1/1 Running 0 6d19h\n\nlocal-disks-local-diskmaker-cg952 1/1 Running 0 6d19h\n\nlocal-disks-local-diskmaker-s7wvr 1/1 Running 0 6d19h\n\nlocal-disks-local-provisioner-dvg58 1/1 Running 0 6d19h\n\nlocal-disks-local-provisioner-lkl6p 1/1 Running 0 6d19h\n\nlocal-disks-local-provisioner-z4nj6 1/1 Running 0 6d19h\n\nlocal-storage-operator-688c6cf7fb-k95kq 1/1 Running 0 5d19h\n\nmongodb-1-9rrv4 1/1 Running 0 3d21h\n\nmongodb-1-deploy 0/1 Completed 0 3d21h\n\nmysql-ocs-fs-0 1/2 CrashLoopBackOff 252 21h\n\nmysql-ocs-fs-1 1/2 CrashLoopBackOff 253 21h\n")])])])])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[t._v("For more information on the Red Hat Local Storage, refer to Red Hat documentation at "),a("a",{attrs:{href:"https://docs.openshift.com/container-platform/4.4/storage/persistent_storage/persistent-storage-local.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.openshift.com/container-platform/4.4/storage/persistent_storage/persistent-storage-local.html"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=n.exports}}]);