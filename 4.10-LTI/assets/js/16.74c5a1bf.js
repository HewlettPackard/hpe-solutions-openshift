(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{295:function(e,a,s){e.exports=s.p+"assets/img/f25.2db677f2.png"},322:function(e,a,s){"use strict";s.r(a);var t=s(13),n=Object(t.a)({},(function(){var e=this,a=e._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"generating-kubernetes-manifests-and-ignition-files"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#generating-kubernetes-manifests-and-ignition-files"}},[e._v("#")]),e._v(" Generating Kubernetes manifests and ignition files")]),e._v(" "),a("p",[e._v("The manifests and ignition files define the master node and worker node configuration and are key components of the RHOCP 4 installation.")]),e._v(" "),a("p",[e._v("Prerequisites:")]),e._v(" "),a("p",[e._v("Before creating the manifest files and ignition files, it is necessary to download the RHOCP 4 packages.")]),e._v(" "),a("ul",[a("li",[e._v("Download the required packages on the installer VM with the following playbook:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ ansible-playbook "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-i")]),e._v(" hosts playbooks/download_ocp_package.yml\n")])])]),a("p",[e._v("To generate Kubernetes manifests and ignition files:")]),e._v(" "),a("ol",[a("li",[e._v("Generate Kubernetes manifest file with the following playbook.")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ ansible-playbook "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-i")]),e._v(" hosts playbooks/generate_manifest.yml\n")])])]),a("ol",[a("li",[e._v("Find the ignition files in the following path:")])]),e._v(" "),a("p",[e._v("/opt/ hpe-solutions-openshift/DL-LTI-Openshift/playbooks/roles/generate_ignition_files/ignitions/")]),e._v(" "),a("ol",[a("li",[e._v("When the ignition files are generated, export the kubeconfig file with the following command:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("KUBECONFIG")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" /opt/ hpe-solutions-openshift/DL-LTI-Openshift/playbooks/roles/generate_ignition_files/ignitions/auth/kubeconfig\n")])])]),a("p",[a("strong",[e._v("Installing and configuring iPXE server")])]),e._v(" "),a("p",[e._v("To install and configure an iPXE server:")]),e._v(" "),a("ol",[a("li",[e._v("Browse to the following directory on the Ansible engine.")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" /opt/ hpe-solutions-openshift/DL-LTI-Openshift/\n")])])]),a("ol",[a("li",[a("p",[e._v("Enter the values as per your setup in input.yaml file.")])]),e._v(" "),a("li",[a("p",[e._v("Execute the following playbook:")])])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ ansible-playbook "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-i")]),e._v(" hosts playbooks/deploy_ipxe_ocp.yml\n")])])]),a("p",[a("strong",[e._v("Creating bootstrap and master VM on KVM nodes")])]),e._v(" "),a("p",[e._v("To create bootstrap and RHOCP master VMs on your RHEL 8 Kernel-based Virtual Machine (KVM) host:")]),e._v(" "),a("ul",[a("li",[e._v("Run the following virt-install command:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ virt-install "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-n")]),e._v(" boot "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--description")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"boot"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--ram")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("16384")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--vcpu")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("10")]),e._v(" --os-type"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("Linux --os-variant"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("rhel8.0 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--noreboot")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--disk")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("pool")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("home,bus"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("virtio,size"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("100")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--serial")]),e._v(" pty "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--console")]),e._v(" pty "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--pxe")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--network")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("bridge")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("bridge0,mac"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("mac address"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n\nWaiting "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" the bootstrap process to complete\n\nThe bootstrap process "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" RHOCP begins after the cluster nodes first boot into the persistent RHCOS environment that has been installed to disk. The configuration information provided through the ignition config files is used to initialize the bootstrap process and "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" RHOCP on the machines. You must "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("wait")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" the bootstrap process to complete.\n")])])]),a("ol",[a("li",[a("p",[e._v("Login to the installer VM as root user.")])]),e._v(" "),a("li",[a("p",[e._v("Execute the following command to bootstrap the nodes:")])])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ openshift-install wait-for bootstrap-complete --log-level"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("debug\n")])])]),a("p",[e._v("The following output is displayed:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("DEBUG OpenShift Installer v4.10\n\nDEBUG Built from commit 425e4ff0037487e32571258640b39f56d5ee5572\n\nINFO Waiting up to 30m0s "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" the Kubernetes API at https://api.ocp.pxelocal.local:6443"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n\nINFO API v1.23.3+e419edf up\n\nINFO Waiting up to 30m0s "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" bootstrapping to complete"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n\nDEBUG Bootstrap status: complete\n\nINFO It is now safe to remove the bootstrap resources\n")])])]),a("p",[a("strong",[e._v("NOTE")])]),e._v(" "),a("p",[e._v("Shut down or remove the bootstrap node after step 1 and step 2 are complete.")]),e._v(" "),a("ol",[a("li",[e._v("Provide the PV storage for the registry. Set the image registry storage to an empty directory with the following command:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ oc patch configs.imageregistry.operator.openshift.io cluster "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--type")]),e._v(" merge "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--patch")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('\'{"spec":{"storage":{"emptyDir":{}}}}\'')]),e._v(" \n")])])]),a("ol",[a("li",[e._v("Complete the RHOCP 4 cluster installation with the following command:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ openshift-install wait-for install-complete --log-level"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("debug\n")])])]),a("p",[e._v("The following output is displayed:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("DEBUG OpenShift Installer v4.10\n\nDEBUG Built from commit 6ed04f65b0f6a1e11f10afe658465ba8195ac459 \n\nINFO Waiting up to 30m0s "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" the cluster at https://api.rrocp.pxelocal.local:6443 to initialize"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(". \n\nDEBUG Still waiting "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" the cluster to initialize: Working towards "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("4.10")]),e._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("99")]),e._v("% complete \n\nDEBUG Still waiting "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" the cluster to initialize: Working towards "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("4.10")]),e._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("99")]),e._v("% complete, waiting on authentication, console,image-registry \n\nDEBUG Still waiting "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" the cluster to initialize: Working towards "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("4.10")]),e._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("99")]),e._v("% complete \n\nDEBUG Still waiting "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" the cluster to initialize: Working towards "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("4.10")]),e._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("100")]),e._v("% complete, waiting on image-registry \n\nDEBUG Still waiting "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" the cluster to initialize: Cluster operator image-registry is still updating \n\nDEBUG Still waiting "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" the cluster to initialize: Cluster operator image-registry is still updating \n\nDEBUG Cluster is initialized \n\nINFO Waiting up to 10m0s "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("for")]),e._v(" the openshift-console route to be created"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n\nDEBUG Route found "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("in")]),e._v(" openshift-console namespace: console \n\nDEBUG Route found "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("in")]),e._v(" openshift-console namespace: downloads \n\nDEBUG OpenShift console route is created \n\nINFO Install complete"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!")]),e._v(" \n\nINFO Access the OpenShift web-console here: https://console-openshift-console.apps.ocp.isv.local\n\nINFO Login to the console with user: kubeadmin, password: a6hKv-okLUA-Q9p3q-UXLc3\n\nThe RHOCP cluster is successfully installed.\n")])])]),a("p",[a("strong",[e._v("Running Red Hat OpenShift Container Platform Console")])]),e._v(" "),a("p",[e._v("Prerequisites:")]),e._v(" "),a("ul",[a("li",[e._v("The RHOCP cluster installation must be complete")])]),e._v(" "),a("p",[a("strong",[e._v("NOTE")])]),e._v(" "),a("p",[e._v("The installer machine provides the Red Hat OpenShift Container Platform Console link and login details when the RHOCP cluster installation is complete.")]),e._v(" "),a("p",[e._v("To access the Red Hat OpenShift Container Platform Console:")]),e._v(" "),a("ol",[a("li",[e._v("Open a web browser and enter the following link:")])]),e._v(" "),a("p",[e._v("https://console-openshift-console.apps.ocp.isv.local")]),e._v(" "),a("ol",[a("li",[e._v("Log in to the Red Hat OpenShift Container Platform Console with the following credentials:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("- Username "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" kubeadmin\n- Password "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("Password"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),a("p",[a("strong",[e._v("NOTE")])]),e._v(" "),a("p",[e._v("If the password is lost or forgotten, search for the kubeadmin-password file located in the /opt/ hpe-solutions-openshift/DL-LTI-Openshift/playbooks/roles/generate_ignition_files/ignitions/auth/kubeadmin-password directory on the installer machine.")]),e._v(" "),a("p",[e._v("The following figure shows the Red Hat OpenShift Container Platform Console after successful deployment:")]),e._v(" "),a("p",[a("img",{attrs:{src:s(295),alt:""}})]),e._v(" "),a("p",[a("strong",[e._v("FIGURE")]),e._v(" "),a("strong",[e._v("25")]),e._v(" Red Hat OpenShift Container Platform Console login screen")]),e._v(" "),a("p",[a("strong",[e._v("Adding RHEL 8.6 Worker nodes to RHOCP cluster")])]),e._v(" "),a("p",[a("strong",[e._v("Creating RHEL 7.9 installer machine on head nodes")])]),e._v(" "),a("p",[e._v("To create a RHEL7.9 VM for adding RHEL 8.6 workers to the RHOCP cluster:")]),e._v(" "),a("ul",[a("li",[e._v("Run the following command on your RHEL 8 KVM host using the virt-install utility:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ virt-install "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--name")]),e._v(" Installer "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--memory")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2048")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--vcpus")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--disk")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("80")]),e._v(" --os-variant rhel7.0 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--cdrom")]),e._v(" /home/username/Downloads/RHEL7.iso\n")])])]),a("p",[a("a",{attrs:{href:"https://docs.openshift.com/container-platform/4.10/machine_management/adding-rhel-compute.html#rhel-preparing-playbook-machine_adding-rhel-compute",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[e._v("Setting up RHEL 7.9 installer machine")]),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("To set up the installer machine running RHEL 7.9 and run the playbook:")]),e._v(" "),a("ol",[a("li",[e._v("Log in to the RHEL7.9 Installer Machine and then register and attach the host pool with Red Hat using the following command:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ subscription-manager register\n")])])]),a("ol",[a("li",[e._v("Generate a list of available subscriptions using the following command:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ subscription-manager list "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--available")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--matches")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'*OpenShift*'")]),e._v("\n")])])]),a("ol",[a("li",[e._v("Find the pool ID for RHOCP subscription from the output generated in step 2 and add it in the following command:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ subscription-manager attach "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--pool")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("pool_id"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),a("ol",[a("li",[e._v("Enable the repositories required by RHOCP 4.10 with the following commands:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ subscription-manager repos "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--enable")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"rhel-7-server-rpms"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--enable")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"rhel-7-server-extras-rpms"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--enable")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"rhel-7-server-ansible-2.9-rpms"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--enable")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"rhel-7-server-ose-4.10-rpms"')]),e._v("\n")])])]),a("ol",[a("li",[e._v("Install the required packages including openshift-ansible.")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ yum "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" openshift-ansible openshift-clients jq\n")])])]),a("p",[a("strong",[e._v("Setting up RHEL worker node")])]),e._v(" "),a("p",[e._v("Prerequisites:")]),e._v(" "),a("ul",[a("li",[e._v("The RHEL 8.6 OS must be deployed on the worker nodes")])]),e._v(" "),a("p",[e._v("To set up a RHEL worker node for each worker node perform the following:")]),e._v(" "),a("ol",[a("li",[e._v("Log in to the RHEL host and then register and attach the host pool with Red Hat using the following command:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ subscription-manager register\n")])])]),a("ol",[a("li",[e._v("Generate a list of available subscriptions using the following command:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ subscription-manager list "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--available")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--matches")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'*OpenShift*'")]),e._v("\n")])])]),a("ol",[a("li",[e._v("Find the pool ID for RHOCP subscription from the output generated in step 2 and add it in the following command:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ subscription-manager attach "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--pool")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("pool_id"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),a("ol",[a("li",[e._v("Enable the repositories required by RHOCP 4.10 with the following commands:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ subscription-manager repos "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--enable")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"rhel-8-for-x86_64-baseos-rpms"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--enable")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"rhel-8-for-x86_64-appstream-rpms"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--enable")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"rhocp-4.10-for-rhel-8-x86_64-rpms"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--enable")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"fast-datapath-for-rhel-8-x86_64-rpms"')]),e._v("\n")])])]),a("ol",[a("li",[e._v("Stop and disable firewalld on the host.")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ systemctl disable "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--now")]),e._v(" firewalld.service\n")])])]),a("p",[a("strong",[e._v("Adding RHEL worker node to RHOCP cluster using RHEL 7.9 installer machine")])]),e._v(" "),a("p",[e._v("This section covers the steps to add worker nodes that use Red Hat Enterprise Linux 8 as the operating system to an RHOCP 4.10 cluster.")]),e._v(" "),a("p",[e._v("Prerequisites:")]),e._v(" "),a("ul",[a("li",[e._v("The required packages must be installed, and the necessary configuration must be performed on the RHEL 7.9 installer machine")]),e._v(" "),a("li",[e._v("RHEL hosts must be prepared for installation")])]),e._v(" "),a("p",[e._v("To add RHEL 8 worker nodes manually to an existing cluster using RHEL 7.9 installer VM machine:")]),e._v(" "),a("ol",[a("li",[e._v("Create an Ansible inventory file in the /"),a("path"),e._v("inventory/hosts directory. This inventory file defines your worker nodes  and the required")])]),e._v(" "),a("p",[e._v("variables:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("all:vars"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Specify the username that runs the Ansible tasks on the remote compute machines.")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ansible_user=root")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# If you do not specify root for the ansible_user, you must set ansible_become to True and assign the user sudo permissions.")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("ansible_become")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("True\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Specify the path and file name of the kubeconfig file for your cluster.")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("openshift_kubeconfig_path")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"~/.kube/config"')]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# List each RHEL machine to add to your cluster. You must provide the fully-qualified domain name for each host. This name is the hostname that the cluster uses to access the machine, so set the correct public or private name to access the machine.")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("new_workers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n\nworker1.ocp.isv.local\n\nworker2.ocp.isv.local\n\nworker3.ocp.isv.local\n")])])]),a("ol",[a("li",[e._v("Navigate to the Ansible playbook directory:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" /usr/share/ansible/openshift-ansible\n")])])]),a("ol",[a("li",[e._v("Run the following playbook to add RHEL 8 worker nodes to the existing cluster:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ ansible-playbook "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-i")]),e._v(" /"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("path/"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("/inventory/hosts playbooks/scaleup.yml\n")])])]),a("p",[e._v("For /"),a("path"),e._v(", specify the path to the Ansible inventory file that you created.")]),e._v(" "),a("ol",[a("li",[e._v("Verify that the worker nodes are added to the cluster using the following command:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ oc get nodes\n")])])]),a("p",[e._v("The following output is displayed:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("NAMESTATUSROLESAGEVERSION\n\nmaster0.ocp.isv.localReadymaster,worker13dv1.23.3+e419edf\n\nmaster1.ocp.isv.localReadymaster,worker13dv1.23.3+e419edf\n\nmaster2.ocp.isv.localReadymaster,worker13dv1.23.3+e419edf\n\nworker1.ocp.isv.localReadyworker23hv1.23.5+3afdacb\n\nworker2.ocp.isv.localReadyworker23hv1.23.5+3afdacb\n\nworker3.ocp.isv.localReadyworker23hv1.23.5+3afdacb\n")])])]),a("ol",[a("li",[a("p",[e._v("Once the worker nodes are added to the cluster, set the mastersSchedulable parameter as false to ensure that the master nodes are not used to schedule pods.")])]),e._v(" "),a("li",[a("p",[e._v("Edit the schedulers.config.openshift.io resource.")])])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ oc edit schedulers.config.openshift.io cluster\n")])])]),a("ol",[a("li",[e._v("Configure the mastersSchedulable parameter.")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("apiVersion: config.openshift.io/v1\n\nkind: Scheduler\n\nmetadata:\n\ncreationTimestamp: "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"2019-09-10T03:04:05Z"')]),e._v("\n\ngeneration: "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("\n\nname: cluster\n\nresourceVersion: "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"433"')]),e._v("\n\nselfLink: /apis/config.openshift.io/v1/schedulers/cluster\n\nuid: a636d30a-d377-11e9-88d4-0a60097bee62\n\nspec:\n\nmastersSchedulable: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("\n\npolicy:\n\nname: "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('""')]),e._v("\n\nstatus: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),a("p",[a("strong",[e._v("NOTE")])]),e._v(" "),a("p",[e._v("Set the mastersSchedulable to true to allow Control Plane nodes to be schedulable or false to disallow Control Plane nodes to be schedulable.")]),e._v(" "),a("ol",[a("li",[e._v("Save the file to apply the changes.")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ oc get nodes\n")])])]),a("ul",[a("li",[e._v("The following output is displayed:")])]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("NAMESTATUSROLESAGEVERSION\n\nmaster0.ocp.isv.localReadymaster13dv1.23.3+e419edf\n\nmaster1.ocp.isv.localReadymaster13dv1.23.3+e419edf\n\nmaster2.ocp.isv.localReadymaster13dv1.23.3+e419edf\n\nworker1.ocp.isv.localReadyworker23hv1.23.5+3afdacb\n\nworker2.ocp.isv.localReadyworker23hv1.23.5+3afdacb\n\nworker3.ocp.isv.localReadyworker23hv1.23.5+3afdacb\n")])])]),a("p",[a("strong",[e._v("NOTE")])]),e._v(" "),a("p",[e._v("To add more worker nodes, update the worker details in HAProxy and BIND DNS on head nodes and then add RHEL 8.6 worker nodes to the RHOCP cluster.")])])}),[],!1,null,null,null);a.default=n.exports}}]);