(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{366:function(a,s,t){a.exports=t.p+"assets/img/figure92.2c30b651.png"},367:function(a,s,t){a.exports=t.p+"assets/img/figure93.69fa2670.png"},368:function(a,s,t){a.exports=t.p+"assets/img/figure94.25ca7bbf.png"},369:function(a,s,t){a.exports=t.p+"assets/img/figure95.1add2680.png"},370:function(a,s,t){a.exports=t.p+"assets/img/figure96.41df7b57.png"},371:function(a,s,t){a.exports=t.p+"assets/img/figure97.008588f1.png"},372:function(a,s,t){a.exports=t.p+"assets/img/figure98.99af703a.png"},373:function(a,s,t){a.exports=t.p+"assets/img/figure99.8db4d89f.png"},374:function(a,s,t){a.exports=t.p+"assets/img/figure100.8b0d730f.png"},375:function(a,s,t){a.exports=t.p+"assets/img/figure101.b1117c97.png"},376:function(a,s,t){a.exports=t.p+"assets/img/figure102.01092ffc.png"},377:function(a,s,t){a.exports=t.p+"assets/img/figure103.7f16d01c.png"},378:function(a,s,t){a.exports=t.p+"assets/img/figure104.0ccd11b0.png"},379:function(a,s,t){a.exports=t.p+"assets/img/figure105.f4f3f8df.png"},380:function(a,s,t){a.exports=t.p+"assets/img/figure106.0f6cf71b.png"},381:function(a,s,t){a.exports=t.p+"assets/img/figure107.64b03f3d.png"},382:function(a,s,t){a.exports=t.p+"assets/img/figure108.c39cd194.png"},383:function(a,s,t){a.exports=t.p+"assets/img/figure109.be3d618e.png"},384:function(a,s,t){a.exports=t.p+"assets/img/figure110.a7e423e6.png"},479:function(a,s,t){"use strict";t.r(s);var e=t(42),r=Object(e.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"red-hat-ceph-storage-4-setup-in-external-mode-with-ocs-integration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#red-hat-ceph-storage-4-setup-in-external-mode-with-ocs-integration"}},[a._v("#")]),a._v(" Red Hat Ceph Storage 4 Setup in External mode with OCS Integration")]),a._v(" "),e("h2",{attrs:{id:"introduction"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[a._v("#")]),a._v(" Introduction")]),a._v(" "),e("p",[a._v("Ceph is a Software Defined Storage (SDS) Solution. It is distributed storage Solution. It is a free and open source. It provides unified storage i.e. a single Ceph cluster can provide Object / Block / File storage options.")]),a._v(" "),e("p",[e("img",{attrs:{src:t(366),alt:""}})]),a._v(" "),e("p",[e("strong",[a._v("Figure 23")]),a._v(". Red Hat Ceph Storage Setup in External Mode High Level View")]),a._v(" "),e("h2",{attrs:{id:"logical-diagram"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#logical-diagram"}},[a._v("#")]),a._v(" Logical Diagram")]),a._v(" "),e("p",[e("img",{attrs:{src:t(367),alt:""}})]),a._v(" "),e("p",[e("strong",[a._v("Figure 24")]),a._v(". Red Hat Ceph Storage Setup in External Mode Solution Flow Diagram")]),a._v(" "),e("h2",{attrs:{id:"hardware-requirement"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hardware-requirement"}},[a._v("#")]),a._v(" Hardware Requirement")]),a._v(" "),e("table",[e("thead",[e("tr",[e("th",[a._v("NODE ROLE")]),a._v(" "),e("th",[a._v("QUANTITY")]),a._v(" "),e("th",[a._v("PLATFORM")]),a._v(" "),e("th",[a._v("OS")]),a._v(" "),e("th",[a._v("HARD DISK")]),a._v(" "),e("th",[a._v("CPU")]),a._v(" "),e("th",[a._v("MEM")])])]),a._v(" "),e("tbody",[e("tr",[e("td",[a._v("MON, OSD")]),a._v(" "),e("td",[a._v("3")]),a._v(" "),e("td",[a._v("DL")]),a._v(" "),e("td",[a._v("RHEL 7.7")]),a._v(" "),e("td",[a._v("/dev/sdb – mon  /dev/sdc – osd")]),a._v(" "),e("td",[a._v("4")]),a._v(" "),e("td",[a._v("16")])]),a._v(" "),e("tr",[e("td",[a._v("ADMIN")]),a._v(" "),e("td",[a._v("1")]),a._v(" "),e("td",[a._v("VM")]),a._v(" "),e("td",[a._v("RHEL 7.7")]),a._v(" "),e("td",[a._v("/dev/sda – os volume")]),a._v(" "),e("td",[a._v("4")]),a._v(" "),e("td",[a._v("16")])])])]),a._v(" "),e("p",[a._v("MON, OSD, MSD & MGR daemons are running on the MON/OSD node.")]),a._v(" "),e("h2",{attrs:{id:"installation-process"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#installation-process"}},[a._v("#")]),a._v(" Installation Process")]),a._v(" "),e("ol",[e("li",[e("p",[a._v("Enable subscriptions on the following nodes.")]),a._v(" "),e("p",[a._v("ADMIN node:")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" subscription-manager register\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" subscription-manager refresh\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" subscription-manager list --available --all --matches"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"*Ceph*"')]),a._v("\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" subscription-manager attach --pool"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("POOL_ID"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" subscription-manager repos --disable"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("*\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" subscription-manager repos --enable"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("rhel-7-server-rpms\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" subscription-manager repos --enable"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("rhel-7-server-extras-rpms\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" subscription-manager repos --enable"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("rhel-7-server-rhceph-4-tools-rpms --enable"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("rhel-7-server-ansible-2.8-rpms\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" yum --y update\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" yum-utils "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" -y\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" yum-config-manager --disable epel\n")])])]),e("p",[a._v("MON/OSD nodes:")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" subscription-manager register\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" subscription-manager refresh\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" subscription-manager list --available --all --matches"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"*Ceph*"')]),a._v("\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" subscription-manager attach --pool"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("POOL_ID"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" subscription-manager repos --disable"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("*\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" subscription-manager repos --enable"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("rhel-7-server-rpms\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" subscription-manager repos --enable"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("rhel-7-server-extras-rpms\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" subscription-manager repos --enable"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("rhel-7-server-rhceph-4-osd-rpms\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" subscription-manager repos --enable"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("rhel-7-server-rhceph-4-mon-rpms\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" subscription-manager repos --enable"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("rhel-7-server-rhceph-4-tools-rpms\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" yum --y update\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" yum-utils "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" -y\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" yum-config-manager --disable epel\n")])])])]),a._v(" "),e("li",[e("p",[a._v("Execute the following steps on "),e("strong",[a._v("Admin Node")])]),a._v(" "),e("ul",[e("li",[e("p",[a._v("Install ceph-ansible package")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" -y ceph-ansible\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /usr/share/ceph-ansible\n")])])])]),a._v(" "),e("li",[e("p",[a._v("Create ansible host inventory file for MON, OSD & GRAFANA as shown below")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("touch")]),a._v(" hosts\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("mons"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n \n"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("mon-1.fqdn"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("mon-2.fqdn"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("mon-3.fqdn"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("osds"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("osd-1.fqdn"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("osd-2.fqdn"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("osd-3.fqdn"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("grafana-server"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("grafana_server.fqdn"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /usr/share/ceph-ansible\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" group_vars/all.yml.sample group_vars/all.yml\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" group_vars/osds.yml.sample group_vars/osds.yml\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" site.yml.sample site.yml\n")])])])]),a._v(" "),e("li",[e("p",[a._v("Create Red Hat Ceph Docker Registry username and password using the below information.")]),a._v(" "),e("p",[a._v("If you do not have a Red Hat Registry Service Account, create one using the "),e("a",{attrs:{href:"https://access.redhat.com/login?redirectTo=https://access.redhat.com/terms-based-registry",target:"_blank",rel:"noopener noreferrer"}},[a._v("Registry Service Account webpage"),e("OutboundLink")],1),a._v(". See the "),e("a",{attrs:{href:"https://access.redhat.com/RegistryAuthentication",target:"_blank",rel:"noopener noreferrer"}},[a._v("Red Hat Container Registry Authentication"),e("OutboundLink")],1),a._v(" Knowledgebase article for details on how to create and manage tokens.")]),a._v(" "),e("p",[e("img",{attrs:{src:t(368),alt:""}})])])])]),a._v(" "),e("li",[e("p",[a._v("Edit group_vars/all.yml as shown below:")]),a._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("fetch_directory")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" ~/ceph"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("ansible"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("keys\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("ceph_origin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" repository\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("ceph_repository")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" rhcs\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("ceph_repository_type")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" cdn\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("ceph_rhcs_version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),a._v("\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("monitor_interface")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" eno3 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")]),a._v(" Port interface where IP is configured\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("public_network")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 10.0.18.0/16 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")]),a._v(" IP address range starting from 1st node\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("ceph_docker_registry")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" registry.redhat.io\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("ceph_docker_registry_auth")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("true")]),a._v("\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("ceph_docker_registry_username")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" SERVICE_ACCOUNT_USER_NAME\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("ceph_docker_registry_password")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" TOKEN\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("dashboard_admin_user")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" <customised username"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")]),a._v("\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("dashboard_admin_password")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" <customised password"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")]),a._v("\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("node_exporter_container_image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" registry.redhat.io/openshift4/ose"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("prometheus"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("node"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("exporter"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("v4.1\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("grafana_server_group_name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" grafana"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("server\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("grafana_admin_user")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("grafana_admin_password")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("mon_group_name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" mons\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("osd_group_name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" osds\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("grafana_container_image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" registry.redhat.io/rhceph/rhceph"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("4"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("dashboard"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("rhel8"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),a._v("\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("prometheus_container_image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" registry.redhat.io/openshift4/ose"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("prometheus"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("4.1")]),a._v("\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("alertmanager_container_image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" registry.redhat.io/openshift4/ose"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("prometheus"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("alertmanager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("4.1")]),a._v("\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("configure_firewall")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("True")]),a._v("\n")])])])]),a._v(" "),e("li",[e("p",[a._v("Edit group_vars/osds.yml as shown below:")]),a._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[a._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("osd_auto_discovery")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("False")]),a._v("\n\n "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("devices")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n\n "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" /dev/sdb\n\n "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" /dev/sdc\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[a._v("NOTE")]),a._v(" "),e("p",[a._v("If "),e("strong",[a._v("osd_auto_discovery")]),a._v(" is set to True, all the empty disks will be used by the system to create OSD.")])])]),a._v(" "),e("li",[e("p",[a._v("Create an ansible user with sudo access on all nodes.")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" adduser ansible-user\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("passwd")]),a._v(" ansible-user\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),a._v(" EOF "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("/etc/sudoers.d/ansible-user\n\n  "),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$ansible")]),a._v("-user ALL "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("root"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" NOPASSWD:ALL\n\n  EOF\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" 0440 /etc/sudoers.d/ansible-user\n")])])])]),a._v(" "),e("li",[e("p",[a._v("Generate SSH keys as the ansible user and copy the key to MON & OSD nodes.")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" ssh-keygen\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" ssh-copy-id ansible-user@"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("mon-osd-ip"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])])])]),a._v(" "),e("li",[e("p",[a._v("Create ~/.ssh/config file and set values for the Hostname and User options for each node in the storage cluster")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("touch")]),a._v(" ~/.ssh/config\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("Host node1\n\nHostname "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("mon-1.fqdn"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n\nUser ansible-user\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n\nHost node4\n\nHostname "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("osd-1.fqdn"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n\nUser ansible-user\n")])])])]),a._v(" "),e("li",[e("p",[a._v("Run the Ansible playbook for creating Ceph storage and Ceph cluster.")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" ansible-playbook site.yml -i hosts\n")])])]),e("p",[a._v("Created Ceph storage on any one of OSD nodes.")]),a._v(" "),e("p",[e("img",{attrs:{src:t(369),alt:""}})])]),a._v(" "),e("li",[e("p",[a._v("Run Ansible playbook for creating Ceph cluster dashboard.")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" ansible-playbook dashboard.yml -i hosts\n")])])]),e("p",[e("img",{attrs:{src:t(370),alt:""}})]),a._v(" "),e("p",[a._v("Open Ceph cluster web UI and enter credentials to login")]),a._v(" "),e("p",[e("img",{attrs:{src:t(371),alt:""}})])]),a._v(" "),e("li",[e("p",[e("strong",[a._v("Ceph Dash board:")]),a._v(" Cretae rdb pool in Ceph cluster.")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("Ceph pool on Ceph cluster dash board: Dash board -> Pools -> Create Pool")])]),a._v(" "),e("li",[e("p",[a._v("Created Ceph pool on Dash board.")])])]),a._v(" "),e("p",[e("img",{attrs:{src:t(372),alt:""}})]),a._v(" "),e("p",[e("img",{attrs:{src:t(373),alt:""}})])]),a._v(" "),e("li",[e("p",[a._v("Create openshift-storage namespace. (Dashboard -> Administration -> Namespace -> Create Namespace).")]),a._v(" "),e("p",[e("img",{attrs:{src:t(374),alt:""}})])]),a._v(" "),e("li",[e("p",[a._v("Create OpenShift Container Storage 4.5 operator. (Dashboard -> Operators -> OperatorHub -> openshift-stoage (namespace) -> search for (OpenShift Container Storage) -> Install).Select the below options to create OpenShift Container Storage operator")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("Update Channel as stable-4.5")])]),a._v(" "),e("li",[e("p",[a._v("Installation Mode as A specific namespace on the cluster")])]),a._v(" "),e("li",[e("p",[a._v("Installed Namespace as Operator recommended namespace PR openshift-storage. If Namespace openshift-storage does not exist, it will be created during the operator installation.")])]),a._v(" "),e("li",[e("p",[a._v("Enable operator recommended cluster monitoring on this namespace checkbox is selected. This is required for cluster monitoring.")])]),a._v(" "),e("li",[e("p",[a._v("Approval Strategy as Automatic")])])]),a._v(" "),e("p",[e("img",{attrs:{src:t(375),alt:""}})]),a._v(" "),e("p",[e("img",{attrs:{src:t(376),alt:""}})])]),a._v(" "),e("li",[e("p",[a._v('Create Overview -> openshift-storage (namespace) -> Operator Hub -> Installed Operators -> OpenShift Container Storage (operator) -> "Storage Cluster" -> "Create OCS Cluster Service"')]),a._v(" "),e("p",[e("img",{attrs:{src:t(377),alt:""}})])]),a._v(" "),e("li",[e("p",[a._v('Select "External" storage mode to integrate external ceph storage for creating OCS cluster by default it shows internal')]),a._v(" "),e("p",[e("img",{attrs:{src:t(378),alt:""}})])]),a._v(" "),e("li",[e("p",[a._v('Download "ceph-external-cluster-details-exporter.py" file and place on any one of OSD nodes.')])])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[a._v('::: tip NOTE\n\nPython version should be "python 3.x".\n\n:::\n')])])]),e("ol",{attrs:{start:"16"}},[e("li",[e("p",[a._v("Check the python script "),e("strong",[a._v("ceph-external-cluster-details-exporter.py")]),a._v(" arguments.")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" python3 ceph-external-cluster-details-exporter.py --help\n")])])])]),a._v(" "),e("li",[e("p",[a._v("Execute the below script for integrating Ceph cluster rbd pool into OCP cluster for creating OCS cluster.")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" python3 ceph-external-cluster-details-exporter.py --rbd-pool-name "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("rbd_pool_name_created_on_ceph_cluster"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])])]),e("p",[a._v("Script output as shown below in JSON format.")]),a._v(" "),e("p",[e("img",{attrs:{src:t(379),alt:""}})])]),a._v(" "),e("li",[e("p",[a._v("Save the above command output in a json file.")])]),a._v(" "),e("li",[e("p",[a._v("Click "),e("strong",[a._v("External cluster metadata -> Browse")]),a._v(" to select and upload the json file.")])]),a._v(" "),e("li",[e("p",[a._v("Click on "),e("strong",[a._v("Create")]),a._v(" for integrating external Ceph storage for creating OCS cluster.")]),a._v(" "),e("p",[e("img",{attrs:{src:t(380),alt:""}})])]),a._v(" "),e("li",[e("p",[a._v("Validating OCS cluster by deploying two-tier application WordPress.")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("Create wordpress namespace.")])]),a._v(" "),e("li",[e("p",[a._v("Deploy WordPress application under wordpress namespace.")]),a._v(" "),e("p",[e("img",{attrs:{src:t(381),alt:""}})])])])]),a._v(" "),e("li",[e("p",[a._v("Check all OCS cluster and WordPress application's pods, pv, pvc and sc.")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("Check sc,pv &pvc of openshift-storage namespace.")]),a._v(" "),e("p",[e("img",{attrs:{src:t(382),alt:""}})])]),a._v(" "),e("li",[e("p",[a._v("Check pods of openshift-storage namespace.")]),a._v(" "),e("p",[e("img",{attrs:{src:t(383),alt:""}})])]),a._v(" "),e("li",[e("p",[a._v("Check pvc and pods of wordpess namespace.")]),a._v(" "),e("p",[e("img",{attrs:{src:t(384),alt:""}})])])])])])])}),[],!1,null,null,null);s.default=r.exports}}]);