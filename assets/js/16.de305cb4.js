(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{266:function(t,a,s){"use strict";s.r(a);var e=s(28),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"red-hat-local-storage-operator"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#red-hat-local-storage-operator"}},[t._v("#")]),t._v(" Red Hat Local Storage Operator")]),t._v(" "),s("p",[t._v("This section describes how to configure the Local Storage Operator on Red Hat OpenShift Container Platform 4.")]),t._v(" "),s("h2",{attrs:{id:"physical-environment"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#physical-environment"}},[t._v("#")]),t._v(" Physical environment")]),t._v(" "),s("p",[t._v("Ensure a minimum of 2 unused disks (a minimum of 100GB and 250GB) are present on each worker node prior to implementing local persistent storage.")]),t._v(" "),s("p",[s("strong",[t._v("NOTE")])]),t._v(" "),s("p",[t._v("Use the following command to find partition details.")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" lsblk\n")])])]),s("p",[t._v("The output appears similar to what is shown below.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v(" NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT\n\n loop0 7:0 0 250G 0 loop\n\n sda 8:0 0 150G 0 disk\n\n ├─sda1 8:1 0 1M 0 part\n\n ├─sda2 8:2 0 1G 0 part /boot\n\n └─sda3 8:3 0 149G 0 part /sysroot\n\n sdb 8:16 0 100G 0 disk\n\n sdc 8:32 0 250G 0 disk\n")])])]),s("h2",{attrs:{id:"deploying-local-storage-operator"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deploying-local-storage-operator"}},[t._v("#")]),t._v(" Deploying local storage operator")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Login to the "),s("strong",[t._v("OpenShift Web Console")]),t._v(".")])]),t._v(" "),s("li",[s("p",[t._v("Navigate to "),s("strong",[t._v("Administration")]),t._v(" -> "),s("strong",[t._v("Namespaces")]),t._v(" and click "),s("strong",[t._v("Create Namespace")]),t._v(".")])]),t._v(" "),s("li",[s("p",[t._v("From the "),s("strong",[t._v("Create Namespace")]),t._v(" page, provide the following values and then click "),s("strong",[t._v("Create")]),t._v(".")]),t._v(" "),s("p",[t._v("a.  "),s("strong",[t._v("Name")]),t._v(": local-storage")]),t._v(" "),s("p",[t._v("b.  Select the "),s("strong",[t._v("No restrictions")]),t._v(" option for Default Network Policy.")])]),t._v(" "),s("li",[s("p",[t._v("Navigate to "),s("strong",[t._v("Operators")]),t._v(" -> "),s("strong",[t._v("OperatorHub")]),t._v(".")])]),t._v(" "),s("li",[s("p",[t._v("From the list of operators, select "),s("strong",[t._v("Local")]),t._v(" "),s("strong",[t._v("Storage")]),t._v(" "),s("strong",[t._v("Operator")]),t._v(".")])]),t._v(" "),s("li",[s("p",[t._v("On the Local Storage Operator page, click "),s("strong",[t._v("Install")]),t._v(".")])]),t._v(" "),s("li",[s("p",[t._v("In the "),s("strong",[t._v("Create Operator Subscription")]),t._v(" page, provide the following details and click **Subscribe. **")]),t._v(" "),s("p",[t._v("a.  "),s("strong",[t._v("Update Channel")]),t._v(": 4.3")]),t._v(" "),s("p",[t._v("b.  "),s("strong",[t._v("Approval Strategy")]),t._v(": Select Manual or Automatic as per the installation environment requirement.")])]),t._v(" "),s("li",[s("p",[t._v("Wait for the operator to be installed. The status of the installation can be monitored from the "),s("em",[t._v("Installed Operators")]),t._v(" page.")])]),t._v(" "),s("li",[s("p",[t._v("A filesystem is essential to create local file storage. Login to the installer VM, copy and update the following "),s("em",[t._v("local-storage-filesystem.yaml")]),t._v(" file with values for the following parameters:")]),t._v(" "),s("p",[t._v("a.  "),s("strong",[t._v("namespace:")]),t._v(" local-storage")]),t._v(" "),s("p",[t._v("b.  "),s("strong",[t._v("values:")]),t._v(" Fully qualified domain name of the worker nodes")]),t._v(" "),s("p",[t._v("c.  "),s("strong",[t._v("devicePaths:")]),t._v(" Partition of the worker nodes to be used to create the filesystem")]),t._v(" "),s("p",[t._v("A sample "),s("em",[t._v("local-storage-filesystem.yaml")]),t._v(" is shown below.")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local.storage.openshift.io/v1"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"LocalVolume"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local-disks-fs1"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("namespace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local-storage"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("nodeSelector")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("nodeSelectorTerms")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("matchExpressions")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kubernetes.io/hostname\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("operator")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" In\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("values")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" worker1.ocp.twentynet.local\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" worker2.ocp.twentynet.local\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" worker3.ocp.twentynet.local\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storageClassDevices")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storageClassName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local-sc"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumeMode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Filesystem\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("fsType")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" xfs\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("devicePaths")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /dev/sdb\n")])])])]),t._v(" "),s("li",[s("p",[t._v("Execute the following command to create the local storage filesystem.")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" oc create –f local-storage-filesystem.yaml\n")])])]),s("p",[t._v("The output is as follows.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("localvolume.local.storage.openshift.io/local-disks-fs created\n")])])])]),t._v(" "),s("li",[s("p",[t._v("A disk is essential to create local block storage. Within the installer VM, copy and update the "),s("em",[t._v("local-storage-block.yaml")]),t._v(" file with values for the following parameters.")]),t._v(" "),s("p",[t._v("a.  "),s("strong",[t._v("namespace:")]),t._v(" local-storage")]),t._v(" "),s("p",[t._v("b.  "),s("strong",[t._v("values:")]),t._v(" Fully qualified domain name of the worker nodes")]),t._v(" "),s("p",[t._v("c.  "),s("strong",[t._v("devicePaths:")]),t._v(" partition of the worker nodes to be used to create the block")]),t._v(" "),s("p",[t._v("A sample "),s("em",[t._v("local-storage-block.yaml")]),t._v(" file is as follows.")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local.storage.openshift.io/v1"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"LocalVolume"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local-disks-fs1"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("namespace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local-storage"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("nodeSelector")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("nodeSelectorTerms")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("matchExpressions")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kubernetes.io/hostname\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("operator")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" In\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("values")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" worker1.ocp.twentynet.local\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" worker2.ocp.twentynet.local\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" worker3.ocp.twentynet.local\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storageClassDevices")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storageClassName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local-sc"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumeMode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Filesystem\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("fsType")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" xfs\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("devicePaths")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /dev/sdb\n")])])])]),t._v(" "),s("li",[s("p",[t._v("Execute the following command to create the resource.")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" oc create –f local-storage-block.yaml\n")])])]),s("p",[t._v("The output is as follows.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("localvolume.local.storage.openshift.io/local-disks created\n")])])])]),t._v(" "),s("li",[s("p",[t._v("Execute the following command to verify that all of the pods are up and running and that the Storage Class and PVs exist.")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" oc get pod –n local-storage\n")])])]),s("p",[t._v("The output is similar to the following.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("NAME READY STATUS RESTARTS AGE\n\nlocal-disks-fs-local-diskmaker-6258p 1/1 Running 0 6d19h\n\nlocal-disks-fs-local-diskmaker-8rzgc 1/1 Running 0 6d19h\n\nlocal-disks-fs-local-diskmaker-c6vch 1/1 Running 0 6d19h\n\nlocal-disks-fs-local-provisioner-598f5 1/1 Running 0 6d19h\n\nlocal-disks-fs-local-provisioner-5g4vp 1/1 Running 0 6d19h\n\nlocal-disks-fs-local-provisioner-sxh5x 1/1 Running 0 6d19h\n\nlocal-disks-fs1-local-diskmaker-5p4s7 1/1 Running 0 4d17h\n\nlocal-disks-fs1-local-diskmaker-9jh6r 1/1 Running 0 4d17h\n\nlocal-disks-fs1-local-diskmaker-z62vd 1/1 Running 0 4d17h\n\nlocal-disks-fs1-local-provisioner-gjkn4 1/1 Running 0 4d17h\n\nlocal-disks-fs1-local-provisioner-kmdzt 1/1 Running 0 4d17h\n\nlocal-disks-fs1-local-provisioner-r28th 1/1 Running 0 4d17h\n\nlocal-disks-local-diskmaker-5wpr9 1/1 Running 0 6d19h\n\nlocal-disks-local-diskmaker-cg952 1/1 Running 0 6d19h\n\nlocal-disks-local-diskmaker-s7wvr 1/1 Running 0 6d19h\n\nlocal-disks-local-provisioner-dvg58 1/1 Running 0 6d19h\n\nlocal-disks-local-provisioner-lkl6p 1/1 Running 0 6d19h\n\nlocal-disks-local-provisioner-z4nj6 1/1 Running 0 6d19h\n\nlocal-storage-operator-688c6cf7fb-k95kq 1/1 Running 0 5d19h\n\nmongodb-1-9rrv4 1/1 Running 0 3d21h\n\nmongodb-1-deploy 0/1 Completed 0 3d21h\n\nmysql-ocs-fs-0 1/2 CrashLoopBackOff 252 21h\n\nmysql-ocs-fs-1 1/2 CrashLoopBackOff 253 21h\n")])])])])]),t._v(" "),s("p",[s("strong",[t._v("NOTE")])]),t._v(" "),s("p",[t._v("For more information on the Red Hat Local Storage, refer to Red Hat documentation at "),s("a",{attrs:{href:"https://docs.openshift.com/container-platform/4.2/storage/persistent_storage/persistent-storage-local.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.openshift.com/container-platform/4.2/storage/persistent_storage/persistent-storage-local.html"),s("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=n.exports}}]);