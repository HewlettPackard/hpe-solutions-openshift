(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{253:function(e,t,s){e.exports=s.p+"assets/img/figure10.64b2bd74.png"},254:function(e,t,s){e.exports=s.p+"assets/img/figure11.18ffcf4f.png"},255:function(e,t,s){e.exports=s.p+"assets/img/figure12.14af882f.png"},256:function(e,t,s){e.exports=s.p+"assets/img/figure13.1929af56.png"},257:function(e,t,s){e.exports=s.p+"assets/img/figure14.1c357c85.png"},278:function(e,t,s){"use strict";s.r(t);var i=s(28),n=Object(i.a)({},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[i("h1",{attrs:{id:"securing-redhat-openshift-container-platform-using-sysdig-secure-and-sysdig-monitor"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#securing-redhat-openshift-container-platform-using-sysdig-secure-and-sysdig-monitor"}},[e._v("#")]),e._v(" Securing RedHat OpenShift Container Platform using Sysdig Secure and Sysdig Monitor")]),e._v(" "),i("h2",{attrs:{id:"introduction"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[e._v("#")]),e._v(" Introduction")]),e._v(" "),i("p",[e._v("This section describes how to install the Sysdig agents in an automated way on Red Hat OpenShift Container Platform 4 running on HPE Synergy Composable Infrastructure. Sysdig agents can be installed on a wide array of Linux hosts. The assumption is that the installation user will run the Sysdig agent as a pod which then enables the Sysdig agent to automatically detect and monitor Red Hat OpenShift Container Platform 4.")]),e._v(" "),i("p"),e._v(" "),i("p",[e._v("To install Sysdig agents on the Red Hat OpenShift Container Platform 4 nodes, use the repository located on the HPE OpenShift Solutions GitHub at  "),i("a",{attrs:{href:"https://github.com/HewlettPackard/hpe-solutions-openshift/tree/master/synergy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/HewlettPackard/hpe-solutions-openshift/tree/master/synergy/"),i("OutboundLink")],1),e._v(". This repository contains Ansible plays and scripts to automate installation. Sysdig security components are stored at the location "),i("em",[e._v("/etc/ansible/hpe-solutions-openshift/synergy/scalable/platform/security-sysdig")]),e._v(".")]),e._v(" "),i("p"),e._v(" "),i("h2",{attrs:{id:"playbooks-for-configuring-sysdig-for-openshift-container-platform"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#playbooks-for-configuring-sysdig-for-openshift-container-platform"}},[e._v("#")]),e._v(" Playbooks for configuring Sysdig for OpenShift Container Platform")]),e._v(" "),i("p",[e._v("To install the Sysdig agents in an automated way on Red Hat OpenShift Container Platform 4, use the repository located at the HPE OpenShift Solutions GitHub at "),i("a",{attrs:{href:"https://github.com/HewlettPackard/hpe-solutions-openshift/tree/master/synergy/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/HewlettPackard/hpe-solutions-openshift/tree/master/synergy/"),i("OutboundLink")],1),e._v(". This repository contains the following:")]),e._v(" "),i("ul",[i("li",[i("p",[i("strong",[e._v("Playbooks:")]),e._v(" This folder contains the playbooks required for Sysdig agent installation.")])]),e._v(" "),i("li",[i("p",[i("strong",[e._v("Roles:")]),e._v(' This folder contains a role called "sysdig-agent-deploy-ocp" which is responsible for performing the actions required for Sysdig agent integration.')])]),e._v(" "),i("li",[i("p",[i("strong",[e._v("Hosts:")]),e._v(" This is the inventory file which will be used by the installer VM to reference hosts during sysdig agent deployment. Provide the installer VM IP or fully qualified domain name in this file.")])]),e._v(" "),i("li",[i("p",[i("strong",[e._v("site.yaml")]),e._v(": This file defines the entire workflow for Sysdig integration.")])])]),e._v(" "),i("p"),e._v(" "),i("h3",{attrs:{id:"prerequisites"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),i("p",[e._v("To successfully deploy Sysdig agents on the nodes, the following prerequisites must be met:")]),e._v(" "),i("ul",[i("li",[i("p",[e._v("Red Hat OpenShift Container Platform 4 is up and running.")])]),e._v(" "),i("li",[i("p",[e._v("Worker nodes in the Red Hat OpenShift Container Platform deployment could be virtual or physical and must be running RHCOS/RHEL operating system.")])]),e._v(" "),i("li",[i("p",[e._v("The installation user has SaaS-based access to Sysdig Secure and Sysdig Monitor for the purpose of container security.")])]),e._v(" "),i("li",[i("p",[e._v("The installation user has admin privileges for Sysdig Secure and Sysdig Monitor.")])]),e._v(" "),i("li",[i("p",[e._v("Sysdig agents with version 9.5.0 are deployed on OpenShift Container Platform.")])]),e._v(" "),i("li",[i("p",[e._v("The installation user has a valid access token that is given by Sysdig and is specific to their credentials on Sysdig Monitor and Sysdig Secure.")])])]),e._v(" "),i("h3",{attrs:{id:"custom-attributes-or-variable-files-and-plays"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#custom-attributes-or-variable-files-and-plays"}},[e._v("#")]),e._v(" Custom attributes or variable files and plays")]),e._v(" "),i("p",[e._v('Each playbook has a role associated with it. Each role has a set of tasks under the "'),i("em",[e._v("task")]),e._v('" folder and variables under the "'),i("em",[e._v("var")]),e._v('" folder. These variable values must be defined by the installation user according to the installation environment prior to running the plays:')]),e._v(" "),i("ul",[i("li",[i("p",[i("strong",[e._v("sysdig-agent-deploy-ocp/vars/main.yml")]),e._v(": Used during Sysdig agent deployment to OpenShift. This file contains Sysdig related variables.")])]),e._v(" "),i("li",[i("p",[i("strong",[e._v("sysdig-agent-deploy-ocp/tasks/main.yml")]),e._v(": This file contains the actual Sysdig agent installation steps.")])]),e._v(" "),i("li",[i("p",[i("strong",[e._v("sysdig-agent-deploy-ocp/files/sysdig-agent-configmap.yaml")]),e._v(": This file is provided by Sysdig and handles the Sysdig software related configuration.")])]),e._v(" "),i("li",[i("p",[i("strong",[e._v("sysdig-agent-deploy-ocp/files/sysdig-agent-daemonset-redhat-openshift.yaml")]),e._v(": This file is provided by Sysdig and handles the Sysdig daemon related configuration.")])])]),e._v(" "),i("p"),e._v(" "),i("h3",{attrs:{id:"executing-the-playbooks"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#executing-the-playbooks"}},[e._v("#")]),e._v(" Executing the playbooks")]),e._v(" "),i("p",[e._v("This section describes the steps that need to be performed to use the playbooks:")]),e._v(" "),i("ol",[i("li",[i("p",[e._v("Login to the installer VM.")])]),e._v(" "),i("li",[i("p",[e._v("Browse the cloned directory and navigate to the following sub-directory.")]),e._v(" "),i("div",{staticClass:"language-bash extra-class"},[i("pre",{pre:!0,attrs:{class:"language-bash"}},[i("code",[i("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),i("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" etc/ansible/hpe-solutions-openshift/synergy/scalable/platform/security-sysdig \n")])])])]),e._v(" "),i("li",[i("p",[e._v("Update the variables in the following files.")]),e._v(" "),i("p",[e._v("a.  Provide the OpenShift Installer VM fully qualified domain name or IP address under [master].")]),e._v(" "),i("p",[e._v("b.  Edit the file roles /sysdig-agent-deploy-ocp/vars/main.yml")]),e._v(" "),i("ul",[i("li",[i("p",[e._v("Provide a value for the project name for Sysdig integration with OpenShift container Platform under the “projectname” variable.")])]),e._v(" "),i("li",[i("p",[e._v("Provide the Sysdig access key/token value. This value is retrieved from the user setting by logging into Sysdig Secure or Sysdig Monitor GUI in “accesskeyval” variable.")])])]),e._v(" "),i("p",[e._v("c.  Edit the file /"),i("em",[e._v("roles/sysdig-agent-deploy-ocp/files/sysdig-agent-configmap.yaml")])]),e._v(" "),i("ul",[i("li",[i("p",[e._v("Enter “OpenShift” as the cluster type.")])]),e._v(" "),i("li",[i("p",[e._v("Enter the Sysdig Collector address and port. Check with Sysdig on which collector is accessible in the installation environment and over which port.")])]),e._v(" "),i("li",[i("p",[e._v("Hewlett Packard Enterprise recommends access of Sysdig collector over Secure Socket Layer (SSL) port. For both the “ssl” and “ssl certificate validate” keys, set the value as “true”.")])]),e._v(" "),i("li",[i("p",[e._v("Set the variable related to the underlying Kubernetes deployment (OpenShift in this solution), to true.")])]),e._v(" "),i("li",[i("p",[e._v("Enter the cluster name of the OpenShift cluster.")])])])]),e._v(" "),i("li",[i("p",[e._v("Run the play using following command.")])])]),e._v(" "),i("div",{staticClass:"language-bash extra-class"},[i("pre",{pre:!0,attrs:{class:"language-bash"}},[i("code",[i("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" ansible-playbook -i hosts site.yml  \n")])])]),i("ol",{attrs:{start:"5"}},[i("li",[i("p",[e._v("To verify the deployment, log in to the installer VM and execute the following command.")]),e._v(" "),i("div",{staticClass:"language-bash extra-class"},[i("pre",{pre:!0,attrs:{class:"language-bash"}},[i("code",[i("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" oc get pods \n")])])]),i("p",[e._v("The output of this command displays the Sysdig agent names running on each of the nodes within the OpenShift cluster as shown in Figure 10. If you see a pod with a pending status, then there might be a possibility that the underlying OpenShift node is not functional.")]),e._v(" "),i("p",[i("img",{attrs:{src:s(253),alt:"Sysdig agents running on OpenShift nodes"}})]),e._v(" "),i("p",[i("strong",[e._v("Figure 10")]),e._v(". Sysdig agents running on OpenShift nodes")])]),e._v(" "),i("li",[i("p",[e._v("Execute the following command to verify the number of pods that are currently up and running in the OpenShift Container Platform deployment.")]),e._v(" "),i("div",{staticClass:"language- extra-class"},[i("pre",{pre:!0,attrs:{class:"language-text"}},[i("code",[e._v("> oc get nodes\n")])])]),i("p",[e._v("The output is shown in Figure 11.")]),e._v(" "),i("p",[i("img",{attrs:{src:s(254),alt:"OpenShift nodes information"}})]),e._v(" "),i("p",[i("strong",[e._v("Figure 11")]),e._v(". OpenShift nodes information")])])]),e._v(" "),i("p"),e._v(" "),i("ol",{attrs:{start:"7"}},[i("li",[i("p",[e._v("Login to Sysdig Secure web interface at "),i("a",{attrs:{href:"https://sysdig.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://sysdig.com/"),i("OutboundLink")],1),e._v(" as a user with administrative privileges.")])]),e._v(" "),i("li",[i("p",[e._v("From the Sysdig Secure web interface, click the icon named "),i("strong",[e._v("POLICY EVENTS")]),e._v(" and you will see the web interface for "),i("strong",[e._v("Policy Events")]),e._v(" tab. On the "),i("strong",[e._v("Policy Events")]),e._v(" tab, click the "),i("strong",[e._v("Groupings")]),e._v(" drop-down list and select "),i("strong",[e._v("Entire Infrastructure")]),e._v(". The user with administrative privileges should be able to see all the OpenShift nodes as in "),i("strong",[e._v("Figure 12")]),e._v(".")])])]),e._v(" "),i("p",[i("img",{attrs:{src:s(255),alt:" OpenShift cluster in Sysdig Secure"}})]),e._v(" "),i("p",[i("strong",[e._v("Figure 12.")]),e._v(" OpenShift cluster in Sysdig Secure")]),e._v(" "),i("ol",{attrs:{start:"9"}},[i("li",[i("p",[e._v("From the Sysdig Monitor web interface, click "),i("strong",[e._v("Explore")]),e._v(" icon and you will see the web interface for the "),i("em",[e._v("Explore")]),e._v(" tab. On the "),i("em",[e._v("Explore")]),e._v(" tab, click the "),i("strong",[e._v("Data Source")]),e._v(" (two rectangles) drop-down menu and select the data source named "),i("em",[e._v("Sysdig Agents")]),e._v(" from the drop-down list.")])]),e._v(" "),i("li",[i("p",[e._v("Open the "),i("em",[e._v("Groupings")]),e._v(" drop-down list and select "),i("strong",[e._v("Clusters and Nodes")]),e._v(". The user with administrative privileges should be able to see all the OpenShift nodes as shown in "),i("strong",[e._v("Figure 13")]),e._v(".")])])]),e._v(" "),i("p",[i("img",{attrs:{src:s(256),alt:"OpenShift cluster in Sysdig Monitor"}})]),e._v(" "),i("p",[i("strong",[e._v("Figure 13")]),e._v(". OpenShift cluster in Sysdig Monitor")]),e._v(" "),i("p",[i("strong",[e._v("NOTE")])]),e._v(" "),i("p",[e._v("For an explanation of host requirements for agent installation, refer to, "),i("a",{attrs:{href:"https://docs.sysdig.com/en/host-requirements-for-agent-installation.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://docs.sysdig.com/en/host-requirements-for-agent-installation.html"),i("OutboundLink")],1),e._v(".")]),e._v(" "),i("p",[e._v("It is recommended to use port 6443 to transfer data over Secure Socket Layer/ Transport Layer Security (SSL/TLS) protocol. Sysdig agents transfer data to Sysdig Cloud over HTTPS that encrypts and decrypts the requests and the responses returned by the Sysdig Cloud.")]),e._v(" "),i("ol",{attrs:{start:"11"}},[i("li",[e._v("From the Sysdig Monitor web interface, click "),i("strong",[e._v("EXPLORE")]),e._v(" icon. On the "),i("em",[e._v("Explore")]),e._v(" tab, click the "),i("strong",[e._v("Data Source")]),e._v(" (two rectangles) drop-down menu and select the data source named "),i("em",[e._v("Sysdig Agents")]),e._v(" from the drop-down list. Open the "),i("strong",[e._v("Groupings")]),e._v(" drop-down list and select "),i("strong",[e._v("Deployment and Pods")]),e._v(". A user with administrative privileges should be able to see all the agents and their details as shown in "),i("strong",[e._v("Figure 14")]),e._v(".")])]),e._v(" "),i("p",[i("img",{attrs:{src:s(257),alt:"Sysdig agents running on the OpenShift cluster"}})]),e._v(" "),i("p",[i("strong",[e._v("Figure 14.")]),e._v(" Sysdig agents running on the OpenShift cluster")]),e._v(" "),i("p",[i("strong",[e._v("NOTE")])]),e._v(" "),i("p",[e._v("This section is based on Sysdig SaaS deployment approach. It is recommended that the installation user waits for some time until the OpenShift node statistics are visible in the Sysdig Secure and Sysdig Monitor user interface.")])])}),[],!1,null,null,null);t.default=n.exports}}]);